<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | This module contains the implementation of Mimer, the current</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- implementation of the auto interactive command (C-c C-a) and the successor of</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Agsy.</span><span>
</span><span id="line-4"></span><span class="hs-comment">--</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- The overall idea is that Mimer gathers a collection of &quot;components&quot; that it</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- could use for building a solution and tries to refine the goal iteratively</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- using these components. Components include global definitions, local variables,</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- let-bound variables, and recursive calls to the function being defined.</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Mimer manages multiple branches of the search at the same time and assigns a</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- cost to each branch, which is the sum of the costs of all its components. The</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- cost of a component in turn is determined by its type and the number of new</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- metas it introduces.</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- A branch can be refined by picking one of its unsolved metavariables and</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- refining it with all available components, resulting in a number of new</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- branches (each one with a higher cost than the original).</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Mimer iteratively refines the branch with the lowest cost until it finds a</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- solution or runs out of time.</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html"><span class="hs-identifier">Agda.Mimer.Mimer</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerResult"><span class="hs-identifier">MimerResult</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#mimer"><span class="hs-identifier">mimer</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">force</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NFData</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catchError</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Error.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadError</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runReaderT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&amp;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sortOn</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">intersect</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">transpose</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(\\)</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmptyList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">head</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">maybeToList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isNothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.PQueue.Min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MinQueue</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.PQueue.Min</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Q</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.PrettyPrint.Boxes</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Box</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Benchmarking.html"><span class="hs-identifier">Agda.Benchmarking</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bench</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.MakeCase.html"><span class="hs-identifier">Agda.Interaction.MakeCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.MakeCase.html#makeCase"><span class="hs-identifier">makeCase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.MakeCase.html#getClauseZipperForIP"><span class="hs-identifier">getClauseZipperForIP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.MakeCase.html#recheckAbstractClause"><span class="hs-identifier">recheckAbstractClause</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html"><span class="hs-identifier">Agda.Syntax.Abstract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier">Expr</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#AbsurdLam"><span class="hs-identifier">AbsurdLam</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html"><span class="hs-identifier">Agda.Syntax.Abstract</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Views.html"><span class="hs-identifier">Agda.Syntax.Abstract.Views</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html"><span class="hs-identifier">Agda.Syntax.Abstract.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier">QName</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier">Name</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#InteractionId"><span class="hs-identifier">InteractionId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier">MetaId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier">ArgInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#defaultArgInfo"><span class="hs-identifier">defaultArgInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Origin"><span class="hs-identifier">Origin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#ConOrigin"><span class="hs-identifier">ConOrigin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Hiding"><span class="hs-identifier">Hiding</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#setOrigin"><span class="hs-identifier">setOrigin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier">NameId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier">Nat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#namedThing"><span class="hs-identifier">namedThing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier">Arg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#setHiding"><span class="hs-identifier">setHiding</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#getHiding"><span class="hs-identifier">getHiding</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#ProjOrigin"><span class="hs-identifier">ProjOrigin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#rangedThing"><span class="hs-identifier">rangedThing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#woThing"><span class="hs-identifier">woThing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#nameOf"><span class="hs-identifier">nameOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#visible"><span class="hs-identifier">visible</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier">Pretty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html"><span class="hs-identifier">Agda.Syntax.Concrete.Name</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html"><span class="hs-identifier">Agda.Syntax.Info</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html#UnificationMeta"><span class="hs-identifier">UnificationMeta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html#exprNoRange"><span class="hs-identifier">exprNoRange</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.MetaVars.html"><span class="hs-identifier">Agda.Syntax.Internal.MetaVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.MetaVars.html#AllMetas"><span class="hs-identifier">AllMetas</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Pattern.html"><span class="hs-identifier">Agda.Syntax.Internal.Pattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Pattern.html#clausePerm"><span class="hs-identifier">clausePerm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html"><span class="hs-identifier">Agda.Syntax.Position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier">Range</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#rangeFile"><span class="hs-identifier">rangeFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#rangeFilePath"><span class="hs-identifier">rangeFilePath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier">noRange</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html"><span class="hs-identifier">Agda.Syntax.Scope.Base</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Scope</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.InternalToAbstract.html"><span class="hs-identifier">Agda.Syntax.Translation.InternalToAbstract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.InternalToAbstract.html#reify"><span class="hs-identifier">reify</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.InternalToAbstract.html#NamedClause"><span class="hs-identifier">NamedClause</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.InternalToAbstract.html#blankNotInScope"><span class="hs-identifier">blankNotInScope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html"><span class="hs-identifier">Agda.Syntax.Translation.AbstractToConcrete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcrete_"><span class="hs-identifier">abstractToConcrete_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.html"><span class="hs-identifier">Agda.TypeChecking.Primitive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier">getBuiltinName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Constraints.html"><span class="hs-identifier">Agda.TypeChecking.Constraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Constraints.html#noConstraints"><span class="hs-identifier">noConstraints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Datatypes.html"><span class="hs-identifier">Agda.TypeChecking.Datatypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Datatypes.html#isDataOrRecord"><span class="hs-identifier">isDataOrRecord</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Conversion.html"><span class="hs-identifier">Agda.TypeChecking.Conversion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Conversion.html#equalType"><span class="hs-identifier">equalType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Empty.html"><span class="hs-identifier">Agda.TypeChecking.Empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Empty.html#isEmptyType"><span class="hs-identifier">isEmptyType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html"><span class="hs-identifier">Agda.TypeChecking.Free</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Free.html#flexRigOccurrenceIn"><span class="hs-identifier">flexRigOccurrenceIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Free.html#freeVars"><span class="hs-identifier">freeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Level.html"><span class="hs-identifier">Agda.TypeChecking.Level</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Level.html#levelType"><span class="hs-identifier">levelType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.MetaVars.html"><span class="hs-identifier">Agda.TypeChecking.MetaVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.MetaVars.html#newValueMeta"><span class="hs-identifier">newValueMeta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.html"><span class="hs-identifier">Agda.TypeChecking.Monad</span></a></span><span> </span><span class="hs-comment">-- (MonadTCM, lookupInteractionId, getConstInfo, liftTCM, clScope, getMetaInfo, lookupMeta, MetaVariable(..), metaType, typeOfConst, getMetaType, MetaInfo(..), getMetaTypeInContext)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Records.html"><span class="hs-identifier">Agda.TypeChecking.Records</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Records.html#isRecord"><span class="hs-identifier">isRecord</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Records.html#isRecursiveRecord"><span class="hs-identifier">isRecursiveRecord</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html"><span class="hs-identifier">Agda.TypeChecking.Reduce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#reduce"><span class="hs-identifier">reduce</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#instantiateFull"><span class="hs-identifier">instantiateFull</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#instantiate"><span class="hs-identifier">instantiate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Problem.html"><span class="hs-identifier">Agda.TypeChecking.Rules.LHS.Problem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.LHS.Problem.html#AsBinding"><span class="hs-identifier">AsBinding</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Term.html"><span class="hs-identifier">Agda.TypeChecking.Rules.Term</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.Term.html#makeAbsurdLambda"><span class="hs-identifier">makeAbsurdLambda</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html"><span class="hs-identifier">Agda.TypeChecking.Substitute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#apply"><span class="hs-identifier">apply</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#applyE"><span class="hs-identifier">applyE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#piApply"><span class="hs-identifier">piApply</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#NoSubst"><span class="hs-identifier">NoSubst</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#TelV"><span class="hs-identifier">TelV</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#telView%27"><span class="hs-identifier">telView'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html"><span class="hs-identifier">Agda.TypeChecking.Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#piApplyM"><span class="hs-identifier">piApplyM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#flattenTel"><span class="hs-identifier">flattenTel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#teleArgs"><span class="hs-identifier">teleArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Benchmark.html"><span class="hs-identifier">Agda.Utils.Benchmark</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Benchmark.html#billTo"><span class="hs-identifier">billTo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html"><span class="hs-identifier">Agda.Utils.FileName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.FileName.html#filePath"><span class="hs-identifier">filePath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Functor.html"><span class="hs-identifier">Agda.Utils.Functor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Functor.html#%3C.%3E"><span class="hs-operator">(&lt;.&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier">__IMPOSSIBLE__</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.html"><span class="hs-identifier">Agda.Utils.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier">ifM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html#and2M"><span class="hs-identifier">and2M</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.Strict.html"><span class="hs-identifier">Agda.Utils.Maybe.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SMaybe</span></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- import Agda.Utils.Permutation (idP, permute, takeP)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html"><span class="hs-identifier">Agda.Utils.Null</span></a></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Time.html"><span class="hs-identifier">Agda.Utils.Time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Time.html#CPUTime"><span class="hs-identifier">CPUTime</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Time.html#getCPUTime"><span class="hs-identifier">getCPUTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Time.html#fromMilliseconds"><span class="hs-identifier">fromMilliseconds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Tuple.html"><span class="hs-identifier">Agda.Utils.Tuple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Tuple.html#mapFst"><span class="hs-identifier">mapFst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Tuple.html#mapSnd"><span class="hs-identifier">mapSnd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html"><span class="hs-identifier">Agda.Utils.FileName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier">AbsolutePath</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Mimer.Options.html"><span class="hs-identifier">Agda.Mimer.Options</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Unsafe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafePerformIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.IORef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IORef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">writeIORef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">readIORef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">newIORef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">modifyIORef'</span></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- Temporary (used for custom cost verbosity hack)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.Strict.html"><span class="hs-identifier">Agda.Utils.Maybe.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.Trie.html"><span class="hs-identifier">Agda.Utils.Trie</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Trie</span></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Base.html"><span class="hs-identifier">Agda.Interaction.Base</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Base.html#Rewrite"><span class="hs-identifier">Rewrite</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.BasicOps.html"><span class="hs-identifier">Agda.Interaction.BasicOps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.BasicOps.html#normalForm"><span class="hs-identifier">normalForm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html"><span class="hs-identifier">Agda.Interaction.Options.Base</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Options.Base.html#parseVerboseKey"><span class="hs-identifier">parseVerboseKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List.html"><span class="hs-identifier">Agda.Utils.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List.html#lastWithDefault"><span class="hs-identifier">lastWithDefault</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">data</span><span> </span><span id="MimerResult"><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerResult"><span class="hs-identifier hs-var">MimerResult</span></a></span></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MimerExpr"><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerExpr"><span class="hs-identifier hs-var">MimerExpr</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Returns 'String' rather than 'Expr' because the give action expects a string.</span></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MimerClauses"><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerClauses"><span class="hs-identifier hs-var">MimerClauses</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Clause"><span class="hs-identifier hs-type">A.Clause</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MimerList"><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerList"><span class="hs-identifier hs-var">MimerList</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MimerNoResult"><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerNoResult"><span class="hs-identifier hs-var">MimerNoResult</span></a></span></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681879460"><span id="local-6989586621681879462"><span class="annot"><span class="annottext">(forall x. MimerResult -&gt; Rep MimerResult x)
-&gt; (forall x. Rep MimerResult x -&gt; MimerResult)
-&gt; Generic MimerResult
forall x. Rep MimerResult x -&gt; MimerResult
forall x. MimerResult -&gt; Rep MimerResult x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. MimerResult -&gt; Rep MimerResult x
from :: forall x. MimerResult -&gt; Rep MimerResult x
$cto :: forall x. Rep MimerResult x -&gt; MimerResult
to :: forall x. Rep MimerResult x -&gt; MimerResult
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681879468"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerResult"><span class="hs-identifier hs-type">MimerResult</span></a></span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | Entry point.</span><span>
</span><span id="line-123"></span><span class="hs-comment">--   Run Mimer on the given interaction point, returning the desired solution(s).</span><span>
</span><span id="line-124"></span><span class="hs-comment">--   Also debug prints timing statistics.</span><span>
</span><span id="line-125"></span><span id="local-6989586621681877094"><span class="annot"><a href="Agda.Mimer.Mimer.html#mimer"><span class="hs-identifier hs-type">mimer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877094"><span class="hs-identifier hs-type">tcm</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Base.html#Rewrite"><span class="hs-identifier hs-type">Rewrite</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Degree of normalization of solution terms.</span></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#InteractionId"><span class="hs-identifier hs-type">InteractionId</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Hole to run on.</span></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ Range of hole (for parse errors).</span></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ Content of hole (to parametrize Mimer).</span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877094"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerResult"><span class="hs-identifier hs-type">MimerResult</span></a></span></span><span>
</span><span id="line-131"></span><span id="mimer"><span class="annot"><span class="annottext">mimer :: forall (tcm :: * -&gt; *).
MonadTCM tcm =&gt;
Rewrite -&gt; InteractionId -&gt; Range -&gt; ArgName -&gt; tcm MimerResult
</span><a href="Agda.Mimer.Mimer.html#mimer"><span class="hs-identifier hs-var hs-var">mimer</span></a></span></span><span> </span><span id="local-6989586621681879572"><span class="annot"><span class="annottext">Rewrite
</span><a href="#local-6989586621681879572"><span class="hs-identifier hs-var">norm</span></a></span></span><span> </span><span id="local-6989586621681879573"><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681879573"><span class="hs-identifier hs-var">ii</span></a></span></span><span> </span><span id="local-6989586621681879574"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681879574"><span class="hs-identifier hs-var">rng</span></a></span></span><span> </span><span id="local-6989586621681879575"><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681879575"><span class="hs-identifier hs-var">argStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCM MimerResult -&gt; tcm MimerResult
forall a. TCM a -&gt; tcm a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM MimerResult -&gt; tcm MimerResult)
-&gt; TCM MimerResult -&gt; tcm MimerResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.top&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-133"></span><span>      </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Running Mimer on interaction point&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionId -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681879573"><span class="hs-identifier hs-var">ii</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;with argument string&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; ArgName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName -&gt; ArgName
forall a. Show a =&gt; a -&gt; ArgName
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681879575"><span class="hs-identifier hs-var">argStr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621681879582"><span class="annot"><a href="#local-6989586621681879582"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO CPUTime -&gt; TCMT IO CPUTime
forall a. IO a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO CPUTime -&gt; TCMT IO CPUTime) -&gt; IO CPUTime -&gt; TCMT IO CPUTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO CPUTime
forall (m :: * -&gt; *). MonadIO m =&gt; m CPUTime
</span><a href="Agda.Utils.Time.html#getCPUTime"><span class="hs-identifier hs-var">getCPUTime</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621681879583"><span class="annot"><a href="#local-6989586621681879583"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Options.html#parseOptions"><span class="hs-identifier hs-type">parseOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681879573"><span class="hs-identifier hs-type">ii</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681879574"><span class="hs-identifier hs-type">rng</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681879575"><span class="hs-identifier hs-type">argStr</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportS"><span class="hs-identifier hs-type">reportS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.top&quot;</span></span><span> </span><span class="annot"><span class="hs-number">15</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Mimer options: &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621681879583"><span class="hs-identifier hs-type">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-comment">-- Andreas, 2025-04-16, changing the plain getTC/putTC bracket to localTCState.</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-comment">-- localTCState should be used by default,</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-comment">-- it keeps the Statistics about metas and constraints.</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-comment">-- Was there a reason to use plain getTC/putTC or is it &quot;don't care&quot; since</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-comment">-- mimer is an interactive command and no one looks at the statistics?</span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621681879586"><span class="annot"><a href="#local-6989586621681879586"><span class="hs-identifier hs-var">sols</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#localTCState"><span class="hs-identifier hs-type">localTCState</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#runSearch"><span class="hs-identifier hs-type">runSearch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681879572"><span class="hs-identifier hs-type">norm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681879583"><span class="hs-identifier hs-type">opts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681879573"><span class="hs-identifier hs-type">ii</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681879574"><span class="hs-identifier hs-type">rng</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-comment">-- Turn the solutions into the desired results (first solution or list of solutions).</span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621681879589"><span class="annot"><a href="#local-6989586621681879589"><span class="hs-identifier hs-var">sol</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Options.html#optSkip"><span class="hs-identifier hs-var">optSkip</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681879583"><span class="hs-identifier hs-type">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621681879586"><span class="hs-identifier hs-type">sols</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-149"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-150"></span><span>            </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.top&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;No solution found&quot;</span></span><span>
</span><span id="line-151"></span><span>            </span><span class="annot"><span class="annottext">MimerResult -&gt; TCM MimerResult
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MimerResult
</span><a href="Agda.Mimer.Mimer.html#MimerNoResult"><span class="hs-identifier hs-var">MimerNoResult</span></a></span><span>
</span><span id="line-152"></span><span>          </span><span id="local-6989586621681879593"><span class="annot"><span class="annottext">[(VerboseLevel, MimerResult)]
</span><a href="#local-6989586621681879593"><span class="hs-identifier hs-var">sols'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Bool
</span><a href="Agda.Mimer.Options.html#optList"><span class="hs-identifier hs-var">optList</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621681879583"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MimerResult -&gt; TCM MimerResult
forall a. a -&gt; TCMT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(MimerResult -&gt; TCM MimerResult) -&gt; MimerResult -&gt; TCM MimerResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(VerboseLevel, ArgName)] -&gt; MimerResult
</span><a href="Agda.Mimer.Mimer.html#MimerList"><span class="hs-identifier hs-var">MimerList</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681879595"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681879596"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681879595"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681879595"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerExpr"><span class="hs-identifier hs-type">MimerExpr</span></a></span><span> </span><span id="local-6989586621681879596"><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681879596"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(VerboseLevel, MimerResult)]
</span><a href="#local-6989586621681879593"><span class="hs-identifier hs-var">sols'</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-153"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681879597"><span class="annot"><span class="annottext">MimerResult
</span><a href="#local-6989586621681879597"><span class="hs-identifier hs-var">sol</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(VerboseLevel, MimerResult)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-154"></span><span>            </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.top&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO ()) -&gt; TCMT IO Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Solution:&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MimerResult -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; MimerResult -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">MimerResult
</span><a href="#local-6989586621681879597"><span class="hs-identifier hs-var">sol</span></a></span><span>
</span><span id="line-155"></span><span>            </span><span class="annot"><span class="annottext">MimerResult -&gt; TCM MimerResult
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MimerResult
</span><a href="#local-6989586621681879597"><span class="hs-identifier hs-var">sol</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-comment">-- Print timing statistic.</span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621681879599"><span class="annot"><a href="#local-6989586621681879599"><span class="hs-identifier hs-var">stop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Time.html#getCPUTime"><span class="hs-identifier hs-type">getCPUTime</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681879600"><span class="annot"><a href="#local-6989586621681879600"><span class="hs-identifier hs-var hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CPUTime
</span><a href="#local-6989586621681879599"><span class="hs-identifier hs-var">stop</span></a></span><span> </span><span class="annot"><span class="annottext">CPUTime -&gt; CPUTime -&gt; CPUTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">CPUTime
</span><a href="#local-6989586621681879582"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.top&quot;</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Total elapsed time:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681879600"><span class="hs-identifier hs-type">time</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#verboseS"><span class="hs-identifier hs-type">verboseS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.stats&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#writeTime"><span class="hs-identifier hs-type">writeTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681879573"><span class="hs-identifier hs-type">ii</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-type">null</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681879586"><span class="hs-identifier hs-type">sols</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621681879600"><span class="hs-identifier hs-type">time</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621681879589"><span class="hs-identifier hs-type">sol</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- Order to try things in:</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- 1. Local variables (including let-bound)</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- 2. Data constructors</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- 3. Where clauses</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- 4. Lambda abstract</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- Other: Equality, empty type, record projections</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- - If we only use constructors if the target type is a data type, we might</span><span>
</span><span id="line-173"></span><span class="hs-comment">--   generate &#951;-reducible expressions, e.g. &#955; xs &#8594; _&#8759;_ 0 xs</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-177"></span><span class="annot"><span class="hs-comment">-- * Data types</span></span><span>
</span><span id="line-178"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-keyword">type</span><span> </span><span id="SM"><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-var">SM</span></a></span></span><span> </span><span id="local-6989586621681879604"><span class="annot"><a href="#local-6989586621681879604"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchOptions"><span class="hs-identifier hs-type">SearchOptions</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681879604"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-keyword">data</span><span> </span><span id="SearchBranch"><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-var">SearchBranch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SearchBranch"><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-var">SearchBranch</span></a></span></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="sbTCState"><span class="annot"><span class="annottext">SearchBranch -&gt; TCState
</span><a href="Agda.Mimer.Mimer.html#sbTCState"><span class="hs-identifier hs-var hs-var">sbTCState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCState"><span class="hs-identifier hs-type">TCState</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="sbGoals"><span class="annot"><span class="annottext">SearchBranch -&gt; [Goal]
</span><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var hs-var">sbGoals</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="sbCost"><span class="annot"><span class="annottext">SearchBranch -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#sbCost"><span class="hs-identifier hs-var hs-var">sbCost</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="sbCache"><span class="annot"><span class="annottext">SearchBranch -&gt; Map CheckpointId ComponentCache
</span><a href="Agda.Mimer.Mimer.html#sbCache"><span class="hs-identifier hs-var hs-var">sbCache</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#CheckpointId"><span class="hs-identifier hs-type">CheckpointId</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#ComponentCache"><span class="hs-identifier hs-type">ComponentCache</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="sbComponentsUsed"><span class="annot"><span class="annottext">SearchBranch -&gt; Map Name VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#sbComponentsUsed"><span class="hs-identifier hs-var hs-var">sbComponentsUsed</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Number of times each component has been used</span></span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681879612"><span id="local-6989586621681879614"><span class="annot"><span class="annottext">(forall x. SearchBranch -&gt; Rep SearchBranch x)
-&gt; (forall x. Rep SearchBranch x -&gt; SearchBranch)
-&gt; Generic SearchBranch
forall x. Rep SearchBranch x -&gt; SearchBranch
forall x. SearchBranch -&gt; Rep SearchBranch x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. SearchBranch -&gt; Rep SearchBranch x
from :: forall x. SearchBranch -&gt; Rep SearchBranch x
$cto :: forall x. Rep SearchBranch x -&gt; SearchBranch
to :: forall x. Rep SearchBranch x -&gt; SearchBranch
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681879617"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="annot"><span class="hs-comment">-- | NOTE: Equality is only on the fields `sbCost` and `sbGoals`</span></span><span>
</span><span id="line-193"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681879658"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621681879666"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681879666"><span class="hs-identifier hs-var">sb1</span></a></span></span><span> </span><span id="local-6989586621681879667"><span class="annot"><span class="annottext">== :: SearchBranch -&gt; SearchBranch -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621681879668"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681879668"><span class="hs-identifier hs-var">sb2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#sbCost"><span class="hs-identifier hs-var">sbCost</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681879666"><span class="hs-identifier hs-var">sb1</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#sbCost"><span class="hs-identifier hs-var">sbCost</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681879668"><span class="hs-identifier hs-var">sb2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; [Goal]
</span><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681879666"><span class="hs-identifier hs-var">sb1</span></a></span><span> </span><span class="annot"><span class="annottext">[Goal] -&gt; [Goal] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; [Goal]
</span><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681879668"><span class="hs-identifier hs-var">sb2</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- TODO: Explain</span><span>
</span><span id="line-197"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681879674"><span id="local-6989586621681879677"><span id="local-6989586621681879680"><span id="local-6989586621681879683"><span id="local-6989586621681879686"><span id="local-6989586621681879689"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621681879693"><span class="annot"><span class="annottext">compare :: SearchBranch -&gt; SearchBranch -&gt; Ordering
</span><a href="#local-6989586621681879693"><span class="hs-identifier hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; VerboseLevel -&gt; Ordering)
-&gt; (SearchBranch -&gt; VerboseLevel)
-&gt; SearchBranch
-&gt; SearchBranch
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#sbCost"><span class="hs-identifier hs-var">sbCost</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- Map source component to generated components</span><span>
</span><span id="line-201"></span><span class="hs-keyword">type</span><span> </span><span id="ComponentCache"><span class="annot"><a href="Agda.Mimer.Mimer.html#ComponentCache"><span class="hs-identifier hs-var">ComponentCache</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-keyword">data</span><span> </span><span id="Goal"><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-var">Goal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Goal"><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-var">Goal</span></a></span></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="goalMeta"><span class="annot"><span class="annottext">Goal -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var hs-var">goalMeta</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681879698"><span id="local-6989586621681879700"><span class="annot"><span class="annottext">(forall x. Goal -&gt; Rep Goal x)
-&gt; (forall x. Rep Goal x -&gt; Goal) -&gt; Generic Goal
forall x. Rep Goal x -&gt; Goal
forall x. Goal -&gt; Rep Goal x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Goal -&gt; Rep Goal x
from :: forall x. Goal -&gt; Rep Goal x
$cto :: forall x. Rep Goal x -&gt; Goal
to :: forall x. Rep Goal x -&gt; Goal
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681879703"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- TODO: Is this a reasonable Eq instance?</span><span>
</span><span id="line-210"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681879713"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621681879716"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681879716"><span class="hs-identifier hs-var">g1</span></a></span></span><span> </span><span id="local-6989586621681879717"><span class="annot"><span class="annottext">== :: Goal -&gt; Goal -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621681879718"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681879718"><span class="hs-identifier hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Goal -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681879716"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; MetaId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Goal -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681879718"><span class="hs-identifier hs-var">g2</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- | Components that are not changed during search. Components that do change</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- (local variables and let bindings) are stored in each 'SearchBranch'.</span><span>
</span><span id="line-215"></span><span class="hs-keyword">data</span><span> </span><span id="BaseComponents"><span class="annot"><a href="Agda.Mimer.Mimer.html#BaseComponents"><span class="hs-identifier hs-var">BaseComponents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BaseComponents"><span class="annot"><a href="Agda.Mimer.Mimer.html#BaseComponents"><span class="hs-identifier hs-var">BaseComponents</span></a></span></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="hintFns"><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintFns"><span class="hs-identifier hs-var hs-var">hintFns</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="hintDataTypes"><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintDataTypes"><span class="hs-identifier hs-var hs-var">hintDataTypes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="hintRecordTypes"><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintRecordTypes"><span class="hs-identifier hs-var hs-var">hintRecordTypes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="hintAxioms"><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintAxioms"><span class="hs-identifier hs-var hs-var">hintAxioms</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Excluding those producing Level</span></span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="hintLevel"><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintLevel"><span class="hs-identifier hs-var hs-var">hintLevel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ A definition in a where clause</span></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="hintProjections"><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintProjections"><span class="hs-identifier hs-var hs-var">hintProjections</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Variables that are candidates for arguments to recursive calls</span></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="hintThisFn"><span class="annot"><span class="annottext">BaseComponents -&gt; Maybe Component
</span><a href="Agda.Mimer.Mimer.html#hintThisFn"><span class="hs-identifier hs-var hs-var">hintThisFn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="hintLetVars"><span class="annot"><span class="annottext">BaseComponents -&gt; [Open Component]
</span><a href="Agda.Mimer.Mimer.html#hintLetVars"><span class="hs-identifier hs-var hs-var">hintLetVars</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="hintRecVars"><span class="annot"><span class="annottext">BaseComponents -&gt; Open [(Term, NoSubst Term VerboseLevel)]
</span><a href="Agda.Mimer.Mimer.html#hintRecVars"><span class="hs-identifier hs-var hs-var">hintRecVars</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#NoSubst"><span class="hs-identifier hs-type">NoSubst</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Variable terms and which argument they come from</span></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="hintSplitVars"><span class="annot"><span class="annottext">BaseComponents -&gt; Open [Term]
</span><a href="Agda.Mimer.Mimer.html#hintSplitVars"><span class="hs-identifier hs-var hs-var">hintSplitVars</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681879731"><span id="local-6989586621681879733"><span class="annot"><span class="annottext">(forall x. BaseComponents -&gt; Rep BaseComponents x)
-&gt; (forall x. Rep BaseComponents x -&gt; BaseComponents)
-&gt; Generic BaseComponents
forall x. Rep BaseComponents x -&gt; BaseComponents
forall x. BaseComponents -&gt; Rep BaseComponents x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. BaseComponents -&gt; Rep BaseComponents x
from :: forall x. BaseComponents -&gt; Rep BaseComponents x
$cto :: forall x. Rep BaseComponents x -&gt; BaseComponents
to :: forall x. Rep BaseComponents x -&gt; BaseComponents
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681879736"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#BaseComponents"><span class="hs-identifier hs-type">BaseComponents</span></a></span></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-keyword">type</span><span> </span><span id="CompId"><span class="annot"><a href="Agda.Mimer.Mimer.html#CompId"><span class="hs-identifier hs-var">CompId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-235"></span><span class="hs-keyword">data</span><span> </span><span id="Component"><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-var">Component</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Component"><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-var">Component</span></a></span></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="compId"><span class="annot"><span class="annottext">Component -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compId"><span class="hs-identifier hs-var hs-var">compId</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#CompId"><span class="hs-identifier hs-type">CompId</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Unique id for the component. Used for the cache.</span></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="compName"><span class="annot"><span class="annottext">Component -&gt; Maybe Name
</span><a href="Agda.Mimer.Mimer.html#compName"><span class="hs-identifier hs-var hs-var">compName</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Used for keeping track of how many times a component has been used</span></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="compPars"><span class="annot"><span class="annottext">Component -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compPars"><span class="hs-identifier hs-var hs-var">compPars</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ How many arguments should be dropped (e.g. constructor parameters)</span></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="compTerm"><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var hs-var">compTerm</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="compType"><span class="annot"><span class="annottext">Component -&gt; Type
</span><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var hs-var">compType</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="compRec"><span class="annot"><span class="annottext">Component -&gt; Bool
</span><a href="Agda.Mimer.Mimer.html#compRec"><span class="hs-identifier hs-var hs-var">compRec</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Is this a recursive call</span></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="compMetas"><span class="annot"><span class="annottext">Component -&gt; [MetaId]
</span><a href="Agda.Mimer.Mimer.html#compMetas"><span class="hs-identifier hs-var hs-var">compMetas</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="compCost"><span class="annot"><span class="annottext">Component -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var hs-var">compCost</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681879793"><span id="local-6989586621681879805"><span class="annot"><span class="annottext">Component -&gt; Component -&gt; Bool
(Component -&gt; Component -&gt; Bool)
-&gt; (Component -&gt; Component -&gt; Bool) -&gt; Eq Component
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Component -&gt; Component -&gt; Bool
== :: Component -&gt; Component -&gt; Bool
$c/= :: Component -&gt; Component -&gt; Bool
/= :: Component -&gt; Component -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681879810"><span id="local-6989586621681879812"><span class="annot"><span class="annottext">(forall x. Component -&gt; Rep Component x)
-&gt; (forall x. Rep Component x -&gt; Component) -&gt; Generic Component
forall x. Rep Component x -&gt; Component
forall x. Component -&gt; Rep Component x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Component -&gt; Rep Component x
from :: forall x. Component -&gt; Rep Component x
$cto :: forall x. Rep Component x -&gt; Component
to :: forall x. Rep Component x -&gt; Component
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681879815"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- TODO: Is this reasonable?</span><span>
</span><span id="line-250"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681879851"><span id="local-6989586621681879854"><span id="local-6989586621681879857"><span id="local-6989586621681879860"><span id="local-6989586621681879863"><span id="local-6989586621681879866"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>  </span><span id="local-6989586621681879869"><span class="annot"><span class="annottext">compare :: Component -&gt; Component -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var">compare</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; VerboseLevel -&gt; Ordering)
-&gt; (Component -&gt; VerboseLevel)
-&gt; Component
-&gt; Component
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">Component -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compId"><span class="hs-identifier hs-var">compId</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-keyword">data</span><span> </span><span id="SearchStepResult"><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-var">SearchStepResult</span></a></span></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ResultExpr"><span class="annot"><a href="Agda.Mimer.Mimer.html#ResultExpr"><span class="hs-identifier hs-var">ResultExpr</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ResultClauses"><span class="annot"><a href="Agda.Mimer.Mimer.html#ResultClauses"><span class="hs-identifier hs-var">ResultClauses</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Clause"><span class="hs-identifier hs-type">A.Clause</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OpenBranch"><span class="annot"><a href="Agda.Mimer.Mimer.html#OpenBranch"><span class="hs-identifier hs-var">OpenBranch</span></a></span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NoSolution"><span class="annot"><a href="Agda.Mimer.Mimer.html#NoSolution"><span class="hs-identifier hs-var">NoSolution</span></a></span></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681879875"><span id="local-6989586621681879877"><span class="annot"><span class="annottext">(forall x. SearchStepResult -&gt; Rep SearchStepResult x)
-&gt; (forall x. Rep SearchStepResult x -&gt; SearchStepResult)
-&gt; Generic SearchStepResult
forall x. Rep SearchStepResult x -&gt; SearchStepResult
forall x. SearchStepResult -&gt; Rep SearchStepResult x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. SearchStepResult -&gt; Rep SearchStepResult x
from :: forall x. SearchStepResult -&gt; Rep SearchStepResult x
$cto :: forall x. Rep SearchStepResult x -&gt; SearchStepResult
to :: forall x. Rep SearchStepResult x -&gt; SearchStepResult
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681879880"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-keyword">data</span><span> </span><span id="SearchOptions"><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchOptions"><span class="hs-identifier hs-var">SearchOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SearchOptions"><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchOptions"><span class="hs-identifier hs-var">SearchOptions</span></a></span></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="searchBaseComponents"><span class="annot"><span class="annottext">SearchOptions -&gt; BaseComponents
</span><a href="Agda.Mimer.Mimer.html#searchBaseComponents"><span class="hs-identifier hs-var hs-var">searchBaseComponents</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#BaseComponents"><span class="hs-identifier hs-type">BaseComponents</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchHintMode"><span class="annot"><span class="annottext">SearchOptions -&gt; HintMode
</span><a href="Agda.Mimer.Mimer.html#searchHintMode"><span class="hs-identifier hs-var hs-var">searchHintMode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Options.html#HintMode"><span class="hs-identifier hs-type">HintMode</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchTimeout"><span class="annot"><span class="annottext">SearchOptions -&gt; Integer
</span><a href="Agda.Mimer.Mimer.html#searchTimeout"><span class="hs-identifier hs-var hs-var">searchTimeout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Options.html#MilliSeconds"><span class="hs-identifier hs-type">MilliSeconds</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchGenProjectionsLocal"><span class="annot"><span class="annottext">SearchOptions -&gt; Bool
</span><a href="Agda.Mimer.Mimer.html#searchGenProjectionsLocal"><span class="hs-identifier hs-var hs-var">searchGenProjectionsLocal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchGenProjectionsLet"><span class="annot"><span class="annottext">SearchOptions -&gt; Bool
</span><a href="Agda.Mimer.Mimer.html#searchGenProjectionsLet"><span class="hs-identifier hs-var hs-var">searchGenProjectionsLet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchGenProjectionsExternal"><span class="annot"><span class="annottext">SearchOptions -&gt; Bool
</span><a href="Agda.Mimer.Mimer.html#searchGenProjectionsExternal"><span class="hs-identifier hs-var hs-var">searchGenProjectionsExternal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchGenProjectionsRec"><span class="annot"><span class="annottext">SearchOptions -&gt; Bool
</span><a href="Agda.Mimer.Mimer.html#searchGenProjectionsRec"><span class="hs-identifier hs-var hs-var">searchGenProjectionsRec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchSpeculateProjections"><span class="annot"><span class="annottext">SearchOptions -&gt; Bool
</span><a href="Agda.Mimer.Mimer.html#searchSpeculateProjections"><span class="hs-identifier hs-var hs-var">searchSpeculateProjections</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchTopMeta"><span class="annot"><span class="annottext">SearchOptions -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#searchTopMeta"><span class="hs-identifier hs-var hs-var">searchTopMeta</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchTopEnv"><span class="annot"><span class="annottext">SearchOptions -&gt; TCEnv
</span><a href="Agda.Mimer.Mimer.html#searchTopEnv"><span class="hs-identifier hs-var hs-var">searchTopEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCEnv"><span class="hs-identifier hs-type">TCEnv</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchTopCheckpoint"><span class="annot"><span class="annottext">SearchOptions -&gt; CheckpointId
</span><a href="Agda.Mimer.Mimer.html#searchTopCheckpoint"><span class="hs-identifier hs-var hs-var">searchTopCheckpoint</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#CheckpointId"><span class="hs-identifier hs-type">CheckpointId</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchInteractionId"><span class="annot"><span class="annottext">SearchOptions -&gt; InteractionId
</span><a href="Agda.Mimer.Mimer.html#searchInteractionId"><span class="hs-identifier hs-var hs-var">searchInteractionId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#InteractionId"><span class="hs-identifier hs-type">InteractionId</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchFnName"><span class="annot"><span class="annottext">SearchOptions -&gt; Maybe QName
</span><a href="Agda.Mimer.Mimer.html#searchFnName"><span class="hs-identifier hs-var hs-var">searchFnName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchCosts"><span class="annot"><span class="annottext">SearchOptions -&gt; Costs
</span><a href="Agda.Mimer.Mimer.html#searchCosts"><span class="hs-identifier hs-var hs-var">searchCosts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Costs"><span class="hs-identifier hs-type">Costs</span></a></span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchStats"><span class="annot"><span class="annottext">SearchOptions -&gt; IORef MimerStats
</span><a href="Agda.Mimer.Mimer.html#searchStats"><span class="hs-identifier hs-var hs-var">searchStats</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerStats"><span class="hs-identifier hs-type">MimerStats</span></a></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchRewrite"><span class="annot"><span class="annottext">SearchOptions -&gt; Rewrite
</span><a href="Agda.Mimer.Mimer.html#searchRewrite"><span class="hs-identifier hs-var hs-var">searchRewrite</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Interaction.Base.html#Rewrite"><span class="hs-identifier hs-type">Rewrite</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="searchBuiltinFlat"><span class="annot"><span class="annottext">SearchOptions -&gt; Maybe QName
</span><a href="Agda.Mimer.Mimer.html#searchBuiltinFlat"><span class="hs-identifier hs-var hs-var">searchBuiltinFlat</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-280"></span><span>      </span><span class="hs-comment">-- Cache BUILTIN_FLAT for issue #7662 workaround</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-keyword">type</span><span> </span><span id="Cost"><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-var">Cost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-284"></span><span class="hs-keyword">data</span><span> </span><span id="Costs"><span class="annot"><a href="Agda.Mimer.Mimer.html#Costs"><span class="hs-identifier hs-var">Costs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Costs"><span class="annot"><a href="Agda.Mimer.Mimer.html#Costs"><span class="hs-identifier hs-var">Costs</span></a></span></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="costLocal"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costLocal"><span class="hs-identifier hs-var hs-var">costLocal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="costFn"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costFn"><span class="hs-identifier hs-var hs-var">costFn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="costDataCon"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costDataCon"><span class="hs-identifier hs-var hs-var">costDataCon</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="costRecordCon"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costRecordCon"><span class="hs-identifier hs-var hs-var">costRecordCon</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="costSpeculateProj"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costSpeculateProj"><span class="hs-identifier hs-var hs-var">costSpeculateProj</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="costProj"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costProj"><span class="hs-identifier hs-var hs-var">costProj</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="costAxiom"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costAxiom"><span class="hs-identifier hs-var hs-var">costAxiom</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="costLet"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costLet"><span class="hs-identifier hs-var hs-var">costLet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="costLevel"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costLevel"><span class="hs-identifier hs-var hs-var">costLevel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="costSet"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costSet"><span class="hs-identifier hs-var hs-var">costSet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span> </span><span class="hs-comment">-- Should probably be replaced with multiple different costs</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="costRecCall"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costRecCall"><span class="hs-identifier hs-var hs-var">costRecCall</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="costNewMeta"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costNewMeta"><span class="hs-identifier hs-var hs-var">costNewMeta</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Cost of a new meta-variable appearing in a non-implicit position</span></span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="costNewHiddenMeta"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costNewHiddenMeta"><span class="hs-identifier hs-var hs-var">costNewHiddenMeta</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Cost of a new meta-variable appearing in an implicit position</span></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="costCompReuse"><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costCompReuse"><span class="hs-identifier hs-var hs-var">costCompReuse</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Cost of reusing a component @n@ times. Only counted when @n&gt;1@.</span></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#noCost"><span class="hs-identifier hs-type">noCost</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span>
</span><span id="line-302"></span><span id="noCost"><span class="annot"><span class="annottext">noCost :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#noCost"><span class="hs-identifier hs-var hs-var">noCost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#defaultCosts"><span class="hs-identifier hs-type">defaultCosts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Costs"><span class="hs-identifier hs-type">Costs</span></a></span><span>
</span><span id="line-305"></span><span id="defaultCosts"><span class="annot"><span class="annottext">defaultCosts :: Costs
</span><a href="Agda.Mimer.Mimer.html#defaultCosts"><span class="hs-identifier hs-var hs-var">defaultCosts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Costs"><span class="hs-identifier hs-type">Costs</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">costLocal :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costLocal"><span class="hs-identifier hs-var">costLocal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">3</span></span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">costFn :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costFn"><span class="hs-identifier hs-var">costFn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">costDataCon :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costDataCon"><span class="hs-identifier hs-var">costDataCon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">3</span></span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">costRecordCon :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costRecordCon"><span class="hs-identifier hs-var">costRecordCon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">3</span></span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">costSpeculateProj :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costSpeculateProj"><span class="hs-identifier hs-var">costSpeculateProj</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">20</span></span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">costProj :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costProj"><span class="hs-identifier hs-var">costProj</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">3</span></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">costAxiom :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costAxiom"><span class="hs-identifier hs-var">costAxiom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">costLet :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costLet"><span class="hs-identifier hs-var">costLet</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">5</span></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">costLevel :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costLevel"><span class="hs-identifier hs-var">costLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">3</span></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">costSet :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costSet"><span class="hs-identifier hs-var">costSet</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">costRecCall :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costRecCall"><span class="hs-identifier hs-var">costRecCall</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">8</span></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">costNewMeta :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costNewMeta"><span class="hs-identifier hs-var">costNewMeta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">costNewHiddenMeta :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costNewHiddenMeta"><span class="hs-identifier hs-var">costNewHiddenMeta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">costCompReuse :: VerboseLevel -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costCompReuse"><span class="hs-identifier hs-var">costCompReuse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681879942"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681879942"><span class="hs-identifier hs-var">uses</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681879942"><span class="hs-identifier hs-var">uses</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Integer -&gt; VerboseLevel
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-323"></span><span class="annot"><span class="hs-comment">-- * Helper functions</span></span><span>
</span><span id="line-324"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#predNat"><span class="hs-identifier hs-type">predNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span>
</span><span id="line-327"></span><span id="predNat"><span class="annot"><span class="annottext">predNat :: VerboseLevel -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#predNat"><span class="hs-identifier hs-var hs-var">predNat</span></a></span></span><span> </span><span id="local-6989586621681879946"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681879946"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681879946"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681879946"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span>
</span><span id="line-328"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681879946"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-329"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel
forall a. HasCallStack =&gt; ArgName -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;predNat of negative value&quot;</span></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span id="local-6989586621681877162"><span class="annot"><a href="Agda.Mimer.Mimer.html#getRecordFields"><span class="hs-identifier hs-type">getRecordFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-type">HasConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877162"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877162"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877162"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-332"></span><span id="getRecordFields"><span class="annot"><span class="annottext">getRecordFields :: forall (tcm :: * -&gt; *).
(HasConstInfo tcm, MonadTCM tcm) =&gt;
QName -&gt; tcm [QName]
</span><a href="Agda.Mimer.Mimer.html#getRecordFields"><span class="hs-identifier hs-var hs-var">getRecordFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; [QName]) -&gt; tcm Definition -&gt; tcm [QName]
forall a b. (a -&gt; b) -&gt; tcm a -&gt; tcm b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dom' Term QName -&gt; QName) -&gt; [Dom' Term QName] -&gt; [QName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Dom' Term QName -&gt; QName
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">([Dom' Term QName] -&gt; [QName])
-&gt; (Definition -&gt; [Dom' Term QName]) -&gt; Definition -&gt; [QName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Defn -&gt; [Dom' Term QName]
</span><a href="Agda.TypeChecking.Monad.Base.html#recFields"><span class="hs-identifier hs-var">recFields</span></a></span><span> </span><span class="annot"><span class="annottext">(Defn -&gt; [Dom' Term QName])
-&gt; (Definition -&gt; Defn) -&gt; Definition -&gt; [Dom' Term QName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(tcm Definition -&gt; tcm [QName])
-&gt; (QName -&gt; tcm Definition) -&gt; QName -&gt; tcm [QName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; tcm Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span id="local-6989586621681877177"><span id="local-6989586621681877178"><span class="annot"><a href="Agda.Mimer.Mimer.html#allOpenMetas"><span class="hs-identifier hs-type">allOpenMetas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.MetaVars.html#AllMetas"><span class="hs-identifier hs-type">AllMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877177"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877178"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877177"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877178"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-335"></span><span id="allOpenMetas"><span class="annot"><span class="annottext">allOpenMetas :: forall t (tcm :: * -&gt; *).
(AllMetas t, ReadTCState tcm) =&gt;
t -&gt; tcm [MetaId]
</span><a href="Agda.Mimer.Mimer.html#allOpenMetas"><span class="hs-identifier hs-var hs-var">allOpenMetas</span></a></span></span><span> </span><span id="local-6989586621681879973"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681879973"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-336"></span><span>  </span><span id="local-6989586621681879974"><span class="annot"><a href="#local-6989586621681879974"><span class="hs-identifier hs-var">openMetas</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">tcm [MetaId]
forall (m :: * -&gt; *). ReadTCState m =&gt; m [MetaId]
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#getOpenMetas"><span class="hs-identifier hs-var">getOpenMetas</span></a></span><span>
</span><span id="line-337"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.MetaVars.html#allMetas"><span class="hs-identifier hs-type">allMetas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-glyph">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681879973"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`intersect`</span></span><span> </span><span class="annot"><a href="#local-6989586621681879974"><span class="hs-identifier hs-type">openMetas</span></a></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span id="local-6989586621681877187"><span class="annot"><a href="Agda.Mimer.Mimer.html#getOpenComponent"><span class="hs-identifier hs-type">getOpenComponent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877187"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#MonadDebug"><span class="hs-identifier hs-type">MonadDebug</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877187"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877187"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span></span><span>
</span><span id="line-340"></span><span id="getOpenComponent"><span class="annot"><span class="annottext">getOpenComponent :: forall (tcm :: * -&gt; *).
(MonadTCM tcm, MonadDebug tcm) =&gt;
Open Component -&gt; tcm Component
</span><a href="Agda.Mimer.Mimer.html#getOpenComponent"><span class="hs-identifier hs-var hs-var">getOpenComponent</span></a></span></span><span> </span><span id="local-6989586621681880023"><span class="annot"><span class="annottext">Open Component
</span><a href="#local-6989586621681880023"><span class="hs-identifier hs-var">openComp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880024"><span class="annot"><span class="annottext">comp :: Component
</span><a href="#local-6989586621681880024"><span class="hs-identifier hs-var hs-var hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Open Component -&gt; Component
forall a. Open a -&gt; a
</span><a href="Agda.TypeChecking.Monad.Base.html#openThing"><span class="hs-identifier hs-var">openThing</span></a></span><span> </span><span class="annot"><span class="annottext">Open Component
</span><a href="#local-6989586621681880023"><span class="hs-identifier hs-var">openComp</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; tcm ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.components.open&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; tcm ()) -&gt; TCMT IO Doc -&gt; tcm ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Opening component&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; VerboseLevel -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compId"><span class="hs-identifier hs-var">compId</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880024"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Maybe Name -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Maybe Name
</span><a href="Agda.Mimer.Mimer.html#compName"><span class="hs-identifier hs-var">compName</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880024"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>  </span><span id="local-6989586621681880026"><span class="annot"><a href="#local-6989586621681880026"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Open Term -&gt; tcm Term
forall a (m :: * -&gt; *).
(TermSubst a, MonadTCEnv m) =&gt;
Open a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Open.html#getOpen"><span class="hs-identifier hs-var">getOpen</span></a></span><span> </span><span class="annot"><span class="annottext">(Open Term -&gt; tcm Term) -&gt; Open Term -&gt; tcm Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">(Component -&gt; Term) -&gt; Open Component -&gt; Open Term
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Open Component
</span><a href="#local-6989586621681880023"><span class="hs-identifier hs-var">openComp</span></a></span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.components.open&quot;</span></span><span> </span><span class="annot"><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;  term = &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880026"><span class="hs-identifier hs-type">term</span></a></span><span>
</span><span id="line-345"></span><span>  </span><span id="local-6989586621681880029"><span class="annot"><a href="#local-6989586621681880029"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Open.html#getOpen"><span class="hs-identifier hs-type">getOpen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621681880023"><span class="hs-identifier hs-type">openComp</span></a></span><span>
</span><span id="line-346"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.components.open&quot;</span></span><span> </span><span class="annot"><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;  typ  =&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880029"><span class="hs-identifier hs-type">typ</span></a></span><span>
</span><span id="line-347"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-type">null</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compMetas"><span class="hs-identifier hs-var">compMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880024"><span class="hs-identifier hs-type">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-type">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compId"><span class="hs-identifier hs-var">compId</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compId"><span class="hs-identifier hs-var">compId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880024"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compName"><span class="hs-identifier hs-var">compName</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compName"><span class="hs-identifier hs-var">compName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880024"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compPars"><span class="hs-identifier hs-var">compPars</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compPars"><span class="hs-identifier hs-var">compPars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880024"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880026"><span class="hs-identifier hs-type">term</span></a></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880029"><span class="hs-identifier hs-type">typ</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compRec"><span class="hs-identifier hs-var">compRec</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compRec"><span class="hs-identifier hs-var">compRec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880024"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compMetas"><span class="hs-identifier hs-var">compMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compMetas"><span class="hs-identifier hs-var">compMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880024"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var">compCost</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var">compCost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880024"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#mkComponent"><span class="hs-identifier hs-type">mkComponent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#CompId"><span class="hs-identifier hs-type">CompId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span>
</span><span id="line-360"></span><span id="mkComponent"><span class="annot"><span class="annottext">mkComponent :: VerboseLevel
-&gt; [MetaId]
-&gt; VerboseLevel
-&gt; Maybe Name
-&gt; VerboseLevel
-&gt; Term
-&gt; Type
-&gt; Component
</span><a href="Agda.Mimer.Mimer.html#mkComponent"><span class="hs-identifier hs-var hs-var">mkComponent</span></a></span></span><span> </span><span id="local-6989586621681880033"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880033"><span class="hs-identifier hs-var">cId</span></a></span></span><span> </span><span id="local-6989586621681880034"><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621681880034"><span class="hs-identifier hs-var">metaIds</span></a></span></span><span> </span><span id="local-6989586621681880035"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880035"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span id="local-6989586621681880036"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681880036"><span class="hs-identifier hs-var">mName</span></a></span></span><span> </span><span id="local-6989586621681880037"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880037"><span class="hs-identifier hs-var">pars</span></a></span></span><span> </span><span id="local-6989586621681880038"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880038"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621681880039"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880039"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">compId :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compId"><span class="hs-identifier hs-var">compId</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880033"><span class="hs-identifier hs-var">cId</span></a></span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compName :: Maybe Name
</span><a href="Agda.Mimer.Mimer.html#compName"><span class="hs-identifier hs-var">compName</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681880036"><span class="hs-identifier hs-var">mName</span></a></span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compPars :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compPars"><span class="hs-identifier hs-var">compPars</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880037"><span class="hs-identifier hs-var">pars</span></a></span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compTerm :: Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880038"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compType :: Type
</span><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880039"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compRec :: Bool
</span><a href="Agda.Mimer.Mimer.html#compRec"><span class="hs-identifier hs-var">compRec</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compMetas :: [MetaId]
</span><a href="Agda.Mimer.Mimer.html#compMetas"><span class="hs-identifier hs-var">compMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621681880034"><span class="hs-identifier hs-var">metaIds</span></a></span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compCost :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var">compCost</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880035"><span class="hs-identifier hs-var">cost</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#mkComponentQ"><span class="hs-identifier hs-type">mkComponentQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#CompId"><span class="hs-identifier hs-type">CompId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span>
</span><span id="line-371"></span><span id="mkComponentQ"><span class="annot"><span class="annottext">mkComponentQ :: VerboseLevel
-&gt; VerboseLevel
-&gt; QName
-&gt; VerboseLevel
-&gt; Term
-&gt; Type
-&gt; Component
</span><a href="Agda.Mimer.Mimer.html#mkComponentQ"><span class="hs-identifier hs-var hs-var">mkComponentQ</span></a></span></span><span> </span><span id="local-6989586621681880041"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880041"><span class="hs-identifier hs-var">cId</span></a></span></span><span> </span><span id="local-6989586621681880042"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880042"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span id="local-6989586621681880043"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880043"><span class="hs-identifier hs-var">qname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
-&gt; [MetaId]
-&gt; VerboseLevel
-&gt; Maybe Name
-&gt; VerboseLevel
-&gt; Term
-&gt; Type
-&gt; Component
</span><a href="Agda.Mimer.Mimer.html#mkComponent"><span class="hs-identifier hs-var">mkComponent</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880041"><span class="hs-identifier hs-var">cId</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880042"><span class="hs-identifier hs-var">cost</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Maybe Name) -&gt; Name -&gt; Maybe Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880043"><span class="hs-identifier hs-var">qname</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#noName"><span class="hs-identifier hs-type">noName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-374"></span><span id="noName"><span class="annot"><span class="annottext">noName :: Maybe Name
</span><a href="Agda.Mimer.Mimer.html#noName"><span class="hs-identifier hs-var hs-var">noName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span id="local-6989586621681877198"><span class="annot"><a href="Agda.Mimer.Mimer.html#newComponent"><span class="hs-identifier hs-type">newComponent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadFresh"><span class="hs-identifier hs-type">MonadFresh</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#CompId"><span class="hs-identifier hs-type">CompId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877198"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877198"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span></span><span>
</span><span id="line-377"></span><span id="newComponent"><span class="annot"><span class="annottext">newComponent :: forall (m :: * -&gt; *).
MonadFresh VerboseLevel m =&gt;
[MetaId]
-&gt; VerboseLevel
-&gt; Maybe Name
-&gt; VerboseLevel
-&gt; Term
-&gt; Type
-&gt; m Component
</span><a href="Agda.Mimer.Mimer.html#newComponent"><span class="hs-identifier hs-var hs-var">newComponent</span></a></span></span><span> </span><span id="local-6989586621681880056"><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621681880056"><span class="hs-identifier hs-var">metaIds</span></a></span></span><span> </span><span id="local-6989586621681880057"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880057"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span id="local-6989586621681880058"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681880058"><span class="hs-identifier hs-var">mName</span></a></span></span><span> </span><span id="local-6989586621681880059"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880059"><span class="hs-identifier hs-var">pars</span></a></span></span><span> </span><span id="local-6989586621681880060"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880060"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621681880061"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880061"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m VerboseLevel
forall i (m :: * -&gt; *). MonadFresh i m =&gt; m i
</span><a href="Agda.TypeChecking.Monad.Base.html#fresh"><span class="hs-identifier hs-var">fresh</span></a></span><span> </span><span class="annot"><span class="annottext">m VerboseLevel -&gt; (VerboseLevel -&gt; Component) -&gt; m Component
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681880063"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880063"><span class="hs-identifier hs-var">cId</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
-&gt; [MetaId]
-&gt; VerboseLevel
-&gt; Maybe Name
-&gt; VerboseLevel
-&gt; Term
-&gt; Type
-&gt; Component
</span><a href="Agda.Mimer.Mimer.html#mkComponent"><span class="hs-identifier hs-var">mkComponent</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880063"><span class="hs-identifier hs-var">cId</span></a></span><span> </span><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621681880056"><span class="hs-identifier hs-var">metaIds</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880057"><span class="hs-identifier hs-var">cost</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681880058"><span class="hs-identifier hs-var">mName</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880059"><span class="hs-identifier hs-var">pars</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880060"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880061"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span id="local-6989586621681877205"><span class="annot"><a href="Agda.Mimer.Mimer.html#newComponentQ"><span class="hs-identifier hs-type">newComponentQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadFresh"><span class="hs-identifier hs-type">MonadFresh</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#CompId"><span class="hs-identifier hs-type">CompId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877205"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877205"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span></span><span>
</span><span id="line-380"></span><span id="newComponentQ"><span class="annot"><span class="annottext">newComponentQ :: forall (m :: * -&gt; *).
MonadFresh VerboseLevel m =&gt;
[MetaId]
-&gt; VerboseLevel
-&gt; QName
-&gt; VerboseLevel
-&gt; Term
-&gt; Type
-&gt; m Component
</span><a href="Agda.Mimer.Mimer.html#newComponentQ"><span class="hs-identifier hs-var hs-var">newComponentQ</span></a></span></span><span> </span><span id="local-6989586621681880071"><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621681880071"><span class="hs-identifier hs-var">metaIds</span></a></span></span><span> </span><span id="local-6989586621681880072"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880072"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span id="local-6989586621681880073"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880073"><span class="hs-identifier hs-var">qname</span></a></span></span><span> </span><span id="local-6989586621681880074"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880074"><span class="hs-identifier hs-var">pars</span></a></span></span><span> </span><span id="local-6989586621681880075"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880075"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621681880076"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880076"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m VerboseLevel
forall i (m :: * -&gt; *). MonadFresh i m =&gt; m i
</span><a href="Agda.TypeChecking.Monad.Base.html#fresh"><span class="hs-identifier hs-var">fresh</span></a></span><span> </span><span class="annot"><span class="annottext">m VerboseLevel -&gt; (VerboseLevel -&gt; Component) -&gt; m Component
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681880077"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880077"><span class="hs-identifier hs-var">cId</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
-&gt; [MetaId]
-&gt; VerboseLevel
-&gt; Maybe Name
-&gt; VerboseLevel
-&gt; Term
-&gt; Type
-&gt; Component
</span><a href="Agda.Mimer.Mimer.html#mkComponent"><span class="hs-identifier hs-var">mkComponent</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880077"><span class="hs-identifier hs-var">cId</span></a></span><span> </span><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621681880071"><span class="hs-identifier hs-var">metaIds</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880072"><span class="hs-identifier hs-var">cost</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Maybe Name) -&gt; Name -&gt; Maybe Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880073"><span class="hs-identifier hs-var">qname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880074"><span class="hs-identifier hs-var">pars</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880075"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880076"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#addCost"><span class="hs-identifier hs-type">addCost</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span>
</span><span id="line-383"></span><span id="addCost"><span class="annot"><span class="annottext">addCost :: VerboseLevel -&gt; Component -&gt; Component
</span><a href="Agda.Mimer.Mimer.html#addCost"><span class="hs-identifier hs-var hs-var">addCost</span></a></span></span><span> </span><span id="local-6989586621681880079"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880079"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span id="local-6989586621681880080"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880080"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880080"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var">compCost</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880079"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var">compCost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880080"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#addBranchGoals"><span class="hs-identifier hs-type">addBranchGoals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span>
</span><span id="line-386"></span><span id="addBranchGoals"><span class="annot"><span class="annottext">addBranchGoals :: [Goal] -&gt; SearchBranch -&gt; SearchBranch
</span><a href="Agda.Mimer.Mimer.html#addBranchGoals"><span class="hs-identifier hs-var hs-var">addBranchGoals</span></a></span></span><span> </span><span id="local-6989586621681880083"><span class="annot"><span class="annottext">[Goal]
</span><a href="#local-6989586621681880083"><span class="hs-identifier hs-var">goals</span></a></span></span><span> </span><span id="local-6989586621681880084"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880084"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880084"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880083"><span class="hs-identifier hs-type">goals</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880084"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span id="local-6989586621681877207"><span class="annot"><a href="Agda.Mimer.Mimer.html#withBranchState"><span class="hs-identifier hs-type">withBranchState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877207"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877207"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-389"></span><span id="withBranchState"><span class="annot"><span class="annottext">withBranchState :: forall a. SearchBranch -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchState"><span class="hs-identifier hs-var hs-var">withBranchState</span></a></span></span><span> </span><span id="local-6989586621681880088"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880088"><span class="hs-identifier hs-var">br</span></a></span></span><span> </span><span id="local-6989586621681880089"><span class="annot"><span class="annottext">SM a
</span><a href="#local-6989586621681880089"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-390"></span><span>  </span><span class="annot"><span class="annottext">TCState -&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *). MonadTCState m =&gt; TCState -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#putTC"><span class="hs-identifier hs-var">putTC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SearchBranch -&gt; TCState
</span><a href="Agda.Mimer.Mimer.html#sbTCState"><span class="hs-identifier hs-var">sbTCState</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880088"><span class="hs-identifier hs-var">br</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>  </span><span class="annot"><span class="annottext">SM a
</span><a href="#local-6989586621681880089"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span id="local-6989586621681877211"><span class="annot"><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-type">withBranchAndGoal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877211"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877211"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-394"></span><span id="withBranchAndGoal"><span class="annot"><span class="annottext">withBranchAndGoal :: forall a. SearchBranch -&gt; Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-var hs-var">withBranchAndGoal</span></a></span></span><span> </span><span id="local-6989586621681880092"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880092"><span class="hs-identifier hs-var">br</span></a></span></span><span> </span><span id="local-6989586621681880093"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880093"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span id="local-6989586621681880094"><span class="annot"><span class="annottext">SM a
</span><a href="#local-6989586621681880094"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Goal -&gt; SM a -&gt; SM a
forall a. Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#inGoalEnv"><span class="hs-identifier hs-var">inGoalEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880093"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">(SM a -&gt; SM a) -&gt; SM a -&gt; SM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; SM a -&gt; SM a
forall a. SearchBranch -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchState"><span class="hs-identifier hs-var">withBranchState</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880092"><span class="hs-identifier hs-var">br</span></a></span><span> </span><span class="annot"><span class="annottext">SM a
</span><a href="#local-6989586621681880094"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span id="local-6989586621681877213"><span class="annot"><a href="Agda.Mimer.Mimer.html#inGoalEnv"><span class="hs-identifier hs-type">inGoalEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877213"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877213"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-397"></span><span id="inGoalEnv"><span class="annot"><span class="annottext">inGoalEnv :: forall a. Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#inGoalEnv"><span class="hs-identifier hs-var hs-var">inGoalEnv</span></a></span></span><span> </span><span id="local-6989586621681880108"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880108"><span class="hs-identifier hs-var">goal</span></a></span></span><span>  </span><span id="local-6989586621681880109"><span class="annot"><span class="annottext">SM a
</span><a href="#local-6989586621681880109"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.env&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">70</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;going into environment of goal&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; MetaId -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Goal -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880108"><span class="hs-identifier hs-var">goal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><span class="annottext">MetaId -&gt; SM a -&gt; SM a
forall (m :: * -&gt; *) a.
(HasCallStack, MonadDebug m, MonadTCEnv m, MonadTrace m,
 ReadTCState m) =&gt;
MetaId -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#withMetaId"><span class="hs-identifier hs-var">withMetaId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Goal -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880108"><span class="hs-identifier hs-var">goal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SM a
</span><a href="#local-6989586621681880109"><span class="hs-identifier hs-var">ret</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- | Take the first goal off a search branch.</span><span>
</span><span id="line-402"></span><span class="hs-comment">--   Precondition: the set of goals is non-empty.</span><span>
</span><span id="line-403"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#nextGoal"><span class="hs-identifier hs-type">nextGoal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span id="nextGoal"><span class="annot"><span class="annottext">nextGoal :: SearchBranch -&gt; (Goal, SearchBranch)
</span><a href="Agda.Mimer.Mimer.html#nextGoal"><span class="hs-identifier hs-var hs-var">nextGoal</span></a></span></span><span> </span><span id="local-6989586621681880112"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880112"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; [Goal]
</span><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880112"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Goal, SearchBranch)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621681880113"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880113"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681880114"><span class="annot"><span class="annottext">[Goal]
</span><a href="#local-6989586621681880114"><span class="hs-identifier hs-var">goals</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880113"><span class="hs-identifier hs-var">goal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880112"><span class="hs-identifier hs-var">branch</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880114"><span class="hs-identifier hs-type">goals</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-comment">-- TODO: Rename (see metaInstantiation)</span><span>
</span><span id="line-410"></span><span id="local-6989586621681877217"><span class="annot"><a href="Agda.Mimer.Mimer.html#getMetaInstantiation"><span class="hs-identifier hs-type">getMetaInstantiation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877217"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877217"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#MonadDebug"><span class="hs-identifier hs-type">MonadDebug</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877217"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html#MonadInteractionPoints"><span class="hs-identifier hs-type">MonadInteractionPoints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877217"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadFresh"><span class="hs-identifier hs-type">MonadFresh</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-type">NameId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877217"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877217"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-412"></span><span id="getMetaInstantiation"><span class="annot"><span class="annottext">getMetaInstantiation :: forall (tcm :: * -&gt; *).
(MonadTCM tcm, PureTCM tcm, MonadDebug tcm,
 MonadInteractionPoints tcm, MonadFresh NameId tcm) =&gt;
MetaId -&gt; tcm (Maybe Expr)
</span><a href="Agda.Mimer.Mimer.html#getMetaInstantiation"><span class="hs-identifier hs-var hs-var">getMetaInstantiation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; tcm (Maybe Term)
forall (tcm :: * -&gt; *).
(MonadTCM tcm, MonadDebug tcm, ReadTCState tcm) =&gt;
MetaId -&gt; tcm (Maybe Term)
</span><a href="Agda.Mimer.Mimer.html#metaInstantiation"><span class="hs-identifier hs-var">metaInstantiation</span></a></span><span> </span><span class="annot"><span class="annottext">(MetaId -&gt; tcm (Maybe Term))
-&gt; (Maybe Term -&gt; tcm (Maybe Expr)) -&gt; MetaId -&gt; tcm (Maybe Expr)
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; tcm Expr) -&gt; Maybe Term -&gt; tcm (Maybe Expr)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term -&gt; tcm Term
forall a (m :: * -&gt; *).
(InstantiateFull a, MonadReduce m) =&gt;
a -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#instantiateFull"><span class="hs-identifier hs-var">instantiateFull</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; tcm Term) -&gt; (Term -&gt; tcm Expr) -&gt; Term -&gt; tcm Expr
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; tcm Expr
Term -&gt; tcm (ReifiesTo Term)
forall i (m :: * -&gt; *).
(Reify i, MonadReify m) =&gt;
i -&gt; m (ReifiesTo i)
forall (m :: * -&gt; *). MonadReify m =&gt; Term -&gt; m (ReifiesTo Term)
</span><a href="Agda.Syntax.Translation.InternalToAbstract.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span id="local-6989586621681877220"><span class="annot"><a href="Agda.Mimer.Mimer.html#metaInstantiation"><span class="hs-identifier hs-type">metaInstantiation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877220"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#MonadDebug"><span class="hs-identifier hs-type">MonadDebug</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877220"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877220"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877220"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-415"></span><span id="metaInstantiation"><span class="annot"><span class="annottext">metaInstantiation :: forall (tcm :: * -&gt; *).
(MonadTCM tcm, MonadDebug tcm, ReadTCState tcm) =&gt;
MetaId -&gt; tcm (Maybe Term)
</span><a href="Agda.Mimer.Mimer.html#metaInstantiation"><span class="hs-identifier hs-var hs-var">metaInstantiation</span></a></span></span><span> </span><span id="local-6989586621681880156"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681880156"><span class="hs-identifier hs-var">metaId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; tcm MetaVariable
forall (m :: * -&gt; *).
(HasCallStack, MonadDebug m, ReadTCState m) =&gt;
MetaId -&gt; m MetaVariable
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#lookupLocalMeta"><span class="hs-identifier hs-var">lookupLocalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681880156"><span class="hs-identifier hs-var">metaId</span></a></span><span> </span><span class="annot"><span class="annottext">tcm MetaVariable
-&gt; (MetaVariable -&gt; MetaInstantiation) -&gt; tcm MetaInstantiation
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MetaVariable -&gt; MetaInstantiation
</span><a href="Agda.TypeChecking.Monad.Base.html#mvInstantiation"><span class="hs-identifier hs-var">mvInstantiation</span></a></span><span> </span><span class="annot"><span class="annottext">tcm MetaInstantiation
-&gt; (MetaInstantiation -&gt; tcm (Maybe Term)) -&gt; tcm (Maybe Term)
forall a b. tcm a -&gt; (a -&gt; tcm b) -&gt; tcm b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-416"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#InstV"><span class="hs-identifier hs-type">InstV</span></a></span><span> </span><span id="local-6989586621681880160"><span class="annot"><span class="annottext">Instantiation
</span><a href="#local-6989586621681880160"><span class="hs-identifier hs-var">inst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Term -&gt; tcm (Maybe Term)
forall a. a -&gt; tcm a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Term -&gt; tcm (Maybe Term)) -&gt; Maybe Term -&gt; tcm (Maybe Term)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Maybe Term
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Maybe Term) -&gt; Term -&gt; Maybe Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Instantiation -&gt; Term
</span><a href="Agda.TypeChecking.Monad.Base.html#instBody"><span class="hs-identifier hs-var">instBody</span></a></span><span> </span><span class="annot"><span class="annottext">Instantiation
</span><a href="#local-6989586621681880160"><span class="hs-identifier hs-var">inst</span></a></span><span>
</span><span id="line-417"></span><span>  </span><span class="annot"><span class="annottext">MetaInstantiation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Term -&gt; tcm (Maybe Term)
forall a. a -&gt; tcm a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Term
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="hs-comment">-- TODO: why not also accept pattern record types here?</span><span>
</span><span id="line-420"></span><span id="local-6989586621681877241"><span class="annot"><a href="Agda.Mimer.Mimer.html#isTypeDatatype"><span class="hs-identifier hs-type">isTypeDatatype</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877241"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadReduce"><span class="hs-identifier hs-type">MonadReduce</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877241"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-type">HasConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877241"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877241"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-421"></span><span id="isTypeDatatype"><span class="annot"><span class="annottext">isTypeDatatype :: forall (tcm :: * -&gt; *).
(MonadTCM tcm, MonadReduce tcm, HasConstInfo tcm) =&gt;
Type -&gt; tcm Bool
</span><a href="Agda.Mimer.Mimer.html#isTypeDatatype"><span class="hs-identifier hs-var hs-var">isTypeDatatype</span></a></span></span><span> </span><span id="local-6989586621681880172"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880172"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCM Bool -&gt; tcm Bool
forall a. TCM a -&gt; tcm a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Type
forall a (m :: * -&gt; *). (Reduce a, MonadReduce m) =&gt; a -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#reduce"><span class="hs-identifier hs-var">reduce</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880172"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Type -&gt; (Type -&gt; Term) -&gt; TCMT IO Term
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Term
forall t a. Type'' t a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Term
-&gt; (Term -&gt; TCMT IO (Maybe (QName, DataOrRecord)))
-&gt; TCMT IO (Maybe (QName, DataOrRecord))
forall a b. TCMT IO a -&gt; (a -&gt; TCMT IO b) -&gt; TCMT IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO (Maybe (QName, DataOrRecord))
</span><a href="Agda.TypeChecking.Datatypes.html#isDataOrRecord"><span class="hs-identifier hs-var">isDataOrRecord</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO (Maybe (QName, DataOrRecord))
-&gt; (Maybe (QName, DataOrRecord) -&gt; Bool) -&gt; TCM Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataOrRecord
</span><a href="Agda.Syntax.Internal.html#IsData"><span class="hs-identifier hs-var">IsData</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><span class="annottext">Maybe (QName, DataOrRecord)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-427"></span><span class="annot"><span class="hs-comment">-- * Components</span></span><span>
</span><span id="line-428"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span class="hs-comment">-- | NOTE: Collects components from the *current* context, not the context of</span><span>
</span><span id="line-431"></span><span class="hs-comment">-- the 'InteractionId'.</span><span>
</span><span id="line-432"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#collectComponents"><span class="hs-identifier hs-type">collectComponents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Options.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Costs"><span class="hs-identifier hs-type">Costs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#InteractionId"><span class="hs-identifier hs-type">InteractionId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#BaseComponents"><span class="hs-identifier hs-type">BaseComponents</span></a></span><span>
</span><span id="line-433"></span><span id="collectComponents"><span class="annot"><span class="annottext">collectComponents :: Options
-&gt; Costs
-&gt; InteractionId
-&gt; Maybe QName
-&gt; [QName]
-&gt; MetaId
-&gt; TCM BaseComponents
</span><a href="Agda.Mimer.Mimer.html#collectComponents"><span class="hs-identifier hs-var hs-var">collectComponents</span></a></span></span><span> </span><span id="local-6989586621681880177"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621681880177"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621681880178"><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681880178"><span class="hs-identifier hs-var">costs</span></a></span></span><span> </span><span id="local-6989586621681880179"><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681880179"><span class="hs-identifier hs-var">ii</span></a></span></span><span> </span><span id="local-6989586621681880180"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681880180"><span class="hs-identifier hs-var">mDefName</span></a></span></span><span> </span><span id="local-6989586621681880181"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681880181"><span class="hs-identifier hs-var">whereNames</span></a></span></span><span> </span><span id="local-6989586621681880182"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681880182"><span class="hs-identifier hs-var">metaId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span>  </span><span id="local-6989586621681880183"><span class="annot"><a href="#local-6989586621681880183"><span class="hs-identifier hs-var">lhsVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InteractionId -&gt; TCMT IO (Open [(Term, Maybe VerboseLevel)])
forall (tcm :: * -&gt; *).
(ReadTCState tcm, MonadError TCErr tcm, MonadTCM tcm,
 HasConstInfo tcm) =&gt;
InteractionId -&gt; tcm (Open [(Term, Maybe VerboseLevel)])
</span><a href="Agda.Mimer.Mimer.html#collectLHSVars"><span class="hs-identifier hs-var">collectLHSVars</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681880179"><span class="hs-identifier hs-var">ii</span></a></span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880185"><span class="annot"><a href="#local-6989586621681880185"><span class="hs-identifier hs-var hs-var">recVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Open [(Term, Maybe VerboseLevel)]
</span><a href="#local-6989586621681880183"><span class="hs-identifier hs-var">lhsVars</span></a></span><span> </span><span class="annot"><span class="annottext">Open [(Term, Maybe VerboseLevel)]
-&gt; ([(Term, Maybe VerboseLevel)]
    -&gt; [(Term, NoSubst Term VerboseLevel)])
-&gt; Open [(Term, NoSubst Term VerboseLevel)]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681880186"><span class="annot"><span class="annottext">[(Term, Maybe VerboseLevel)]
</span><a href="#local-6989586621681880186"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880187"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; NoSubst Term VerboseLevel
forall t a. a -&gt; NoSubst t a
</span><a href="Agda.TypeChecking.Substitute.Class.html#NoSubst"><span class="hs-identifier hs-var">NoSubst</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880189"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880187"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880187"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681880189"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880189"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Term, Maybe VerboseLevel)]
</span><a href="#local-6989586621681880186"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-comment">-- TODO: implement case splitting</span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-comment">-- splitVars &lt;- getSplitVars lhsVars</span><span>
</span><span id="line-440"></span><span>  </span><span id="local-6989586621681880190"><span class="annot"><a href="#local-6989586621681880190"><span class="hs-identifier hs-var">splitVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Open.html#makeOpen"><span class="hs-identifier hs-type">makeOpen</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-comment">-- Prepare the initial component record</span><span>
</span><span id="line-443"></span><span>  </span><span id="local-6989586621681880192"><span class="annot"><a href="#local-6989586621681880192"><span class="hs-identifier hs-var">letVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#getLetVars"><span class="hs-identifier hs-type">getLetVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#costLet"><span class="hs-identifier hs-var">costLet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880178"><span class="hs-identifier hs-type">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880194"><span class="annot"><a href="#local-6989586621681880194"><span class="hs-identifier hs-var hs-var">components</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#BaseComponents"><span class="hs-identifier hs-type">BaseComponents</span></a></span><span>
</span><span id="line-445"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hintFns :: [Component]
</span><a href="Agda.Mimer.Mimer.html#hintFns"><span class="hs-identifier hs-var">hintFns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-446"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hintDataTypes :: [Component]
</span><a href="Agda.Mimer.Mimer.html#hintDataTypes"><span class="hs-identifier hs-var">hintDataTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-447"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hintRecordTypes :: [Component]
</span><a href="Agda.Mimer.Mimer.html#hintRecordTypes"><span class="hs-identifier hs-var">hintRecordTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-448"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hintProjections :: [Component]
</span><a href="Agda.Mimer.Mimer.html#hintProjections"><span class="hs-identifier hs-var">hintProjections</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-449"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hintAxioms :: [Component]
</span><a href="Agda.Mimer.Mimer.html#hintAxioms"><span class="hs-identifier hs-var">hintAxioms</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-450"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hintLevel :: [Component]
</span><a href="Agda.Mimer.Mimer.html#hintLevel"><span class="hs-identifier hs-var">hintLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-451"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hintThisFn :: Maybe Component
</span><a href="Agda.Mimer.Mimer.html#hintThisFn"><span class="hs-identifier hs-var">hintThisFn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Component
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-452"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hintRecVars :: Open [(Term, NoSubst Term VerboseLevel)]
</span><a href="Agda.Mimer.Mimer.html#hintRecVars"><span class="hs-identifier hs-var">hintRecVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Open [(Term, NoSubst Term VerboseLevel)]
</span><a href="#local-6989586621681880185"><span class="hs-identifier hs-var">recVars</span></a></span><span>
</span><span id="line-453"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hintLetVars :: [Open Component]
</span><a href="Agda.Mimer.Mimer.html#hintLetVars"><span class="hs-identifier hs-var">hintLetVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Open Component]
</span><a href="#local-6989586621681880192"><span class="hs-identifier hs-var">letVars</span></a></span><span>
</span><span id="line-454"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hintSplitVars :: Open [Term]
</span><a href="Agda.Mimer.Mimer.html#hintSplitVars"><span class="hs-identifier hs-var">hintSplitVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Open [Term]
</span><a href="#local-6989586621681880190"><span class="hs-identifier hs-var">splitVars</span></a></span><span>
</span><span id="line-455"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-comment">-- Extract additional components from the names given as hints.</span><span>
</span><span id="line-458"></span><span>  </span><span id="local-6989586621681880195"><span class="annot"><a href="#local-6989586621681880195"><span class="hs-identifier hs-var">hintNames</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#getEverythingInScope"><span class="hs-identifier hs-type">getEverythingInScope</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html#lookupLocalMeta"><span class="hs-identifier hs-type">lookupLocalMeta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880182"><span class="hs-identifier hs-type">metaId</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span id="local-6989586621681880197"><span class="annot"><a href="#local-6989586621681880197"><span class="hs-identifier hs-var">isToLevel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#endsInLevelTester"><span class="hs-identifier hs-type">endsInLevelTester</span></a></span><span>
</span><span id="line-460"></span><span>  </span><span id="local-6989586621681880199"><span class="annot"><a href="#local-6989586621681880199"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getScope"><span class="hs-identifier hs-type">getScope</span></a></span><span>
</span><span id="line-461"></span><span>  </span><span id="local-6989586621681880201"><span class="annot"><a href="#local-6989586621681880201"><span class="hs-identifier hs-var">components'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">foldM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880203"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880197"><span class="hs-identifier hs-type">isToLevel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880199"><span class="hs-identifier hs-type">scope</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880194"><span class="hs-identifier hs-type">components</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-462"></span><span>    </span><span class="annot"><a href="#local-6989586621681880204"><span class="hs-identifier hs-type">explicitHints</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880195"><span class="hs-identifier hs-type">hintNames</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">\\</span></span><span> </span><span class="annot"><a href="#local-6989586621681880204"><span class="hs-identifier hs-type">explicitHints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#BaseComponents"><span class="hs-identifier hs-type">BaseComponents</span></a></span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintFns"><span class="hs-identifier hs-var">hintFns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880205"><span class="hs-identifier hs-type">doSort</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintFns"><span class="hs-identifier hs-var">hintFns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880201"><span class="hs-identifier hs-type">components'</span></a></span><span>
</span><span id="line-466"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintDataTypes"><span class="hs-identifier hs-var">hintDataTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880205"><span class="hs-identifier hs-type">doSort</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintDataTypes"><span class="hs-identifier hs-var">hintDataTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880201"><span class="hs-identifier hs-type">components'</span></a></span><span>
</span><span id="line-467"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintRecordTypes"><span class="hs-identifier hs-var">hintRecordTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880205"><span class="hs-identifier hs-type">doSort</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintRecordTypes"><span class="hs-identifier hs-var">hintRecordTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880201"><span class="hs-identifier hs-type">components'</span></a></span><span>
</span><span id="line-468"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintProjections"><span class="hs-identifier hs-var">hintProjections</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880205"><span class="hs-identifier hs-type">doSort</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintProjections"><span class="hs-identifier hs-var">hintProjections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880201"><span class="hs-identifier hs-type">components'</span></a></span><span>
</span><span id="line-469"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintAxioms"><span class="hs-identifier hs-var">hintAxioms</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880205"><span class="hs-identifier hs-type">doSort</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintAxioms"><span class="hs-identifier hs-var">hintAxioms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880201"><span class="hs-identifier hs-type">components'</span></a></span><span>
</span><span id="line-470"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintLevel"><span class="hs-identifier hs-var">hintLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880205"><span class="hs-identifier hs-type">doSort</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintLevel"><span class="hs-identifier hs-var">hintLevel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880201"><span class="hs-identifier hs-type">components'</span></a></span><span>
</span><span id="line-471"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintThisFn"><span class="hs-identifier hs-var">hintThisFn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintThisFn"><span class="hs-identifier hs-var">hintThisFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880201"><span class="hs-identifier hs-type">components'</span></a></span><span>
</span><span id="line-472"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintRecVars"><span class="hs-identifier hs-var">hintRecVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880185"><span class="hs-identifier hs-type">recVars</span></a></span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintLetVars"><span class="hs-identifier hs-var">hintLetVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880192"><span class="hs-identifier hs-type">letVars</span></a></span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintSplitVars"><span class="hs-identifier hs-var">hintSplitVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880190"><span class="hs-identifier hs-type">splitVars</span></a></span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621681880206"><span class="annot"><span class="annottext">hintMode :: HintMode
</span><a href="#local-6989586621681880206"><span class="hs-identifier hs-var hs-var">hintMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; HintMode
</span><a href="Agda.Mimer.Options.html#optHintMode"><span class="hs-identifier hs-var">optHintMode</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621681880177"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-478"></span><span>    </span><span id="local-6989586621681880204"><span class="annot"><span class="annottext">explicitHints :: [QName]
</span><a href="#local-6989586621681880204"><span class="hs-identifier hs-var hs-var">explicitHints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; [QName]
</span><a href="Agda.Mimer.Options.html#optExplicitHints"><span class="hs-identifier hs-var">optExplicitHints</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621681880177"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-479"></span><span>    </span><span class="hs-comment">-- Sort by the arity of the type</span><span>
</span><span id="line-480"></span><span>    </span><span id="local-6989586621681880205"><span class="annot"><span class="annottext">doSort :: [Component] -&gt; [Component]
</span><a href="#local-6989586621681880205"><span class="hs-identifier hs-var hs-var">doSort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Component -&gt; VerboseLevel) -&gt; [Component] -&gt; [Component]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; VerboseLevel
</span><a href="Agda.Syntax.Internal.html#arity"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; VerboseLevel)
-&gt; (Component -&gt; Type) -&gt; Component -&gt; VerboseLevel
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Component -&gt; Type
</span><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span>    </span><span id="local-6989586621681880211"><span class="annot"><span class="annottext">isNotMutual :: QName -&gt; Defn -&gt; Bool
</span><a href="#local-6989586621681880211"><span class="hs-identifier hs-var hs-var">isNotMutual</span></a></span></span><span> </span><span id="local-6989586621681880212"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880212"><span class="hs-identifier hs-var">qname</span></a></span></span><span> </span><span id="local-6989586621681880213"><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681880213"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681880180"><span class="hs-identifier hs-var">mDefName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-483"></span><span>      </span><span class="annot"><span class="annottext">Maybe QName
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-484"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681880214"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880214"><span class="hs-identifier hs-var">defName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880214"><span class="hs-identifier hs-var">defName</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880212"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">([QName] -&gt; Bool) -&gt; Maybe [QName] -&gt; Maybe Bool
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880214"><span class="hs-identifier hs-var">defName</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [QName] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Defn -&gt; Maybe [QName]
</span><a href="Agda.TypeChecking.Monad.Base.html#funMutual"><span class="hs-identifier hs-var">funMutual</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681880213"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Maybe Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span>    </span><span id="local-6989586621681880203"><span class="annot"><span class="annottext">go :: (Type -&gt; Bool)
-&gt; ScopeInfo -&gt; BaseComponents -&gt; QName -&gt; TCM BaseComponents
</span><a href="#local-6989586621681880203"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681880218"><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621681880218"><span class="hs-identifier hs-var">isToLevel</span></a></span></span><span> </span><span id="local-6989586621681880219"><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681880219"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span id="local-6989586621681880220"><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681880220"><span class="hs-identifier hs-var">comps</span></a></span></span><span> </span><span id="local-6989586621681880221"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-487"></span><span>        </span><span id="local-6989586621681880222"><span class="annot"><a href="#local-6989586621681880222"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span><span>
</span><span id="line-488"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880223"><span class="annot"><a href="#local-6989586621681880223"><span class="hs-identifier hs-var hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681880222"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-489"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880222"><span class="hs-identifier hs-type">def</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-490"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-491"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621681880218"><span class="hs-identifier hs-var">isToLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880223"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880226"><span class="hs-identifier hs-var">addLevel</span></a></span><span>
</span><span id="line-492"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681880227"><span class="hs-identifier hs-var">shouldKeep</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880228"><span class="hs-identifier hs-var">addAxiom</span></a></span><span>
</span><span id="line-493"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880229"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-494"></span><span>          </span><span class="hs-comment">-- We can't use pattern lambdas as components nor with-functions.</span><span>
</span><span id="line-495"></span><span>          </span><span class="hs-comment">-- If the function is in the same mutual block, do not include it.</span><span>
</span><span id="line-496"></span><span>          </span><span id="local-6989586621681880230"><span class="annot"><span class="annottext">f :: Defn
</span><a href="#local-6989586621681880230"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funWith :: Defn -&gt; Maybe QName
</span><a href="Agda.TypeChecking.Monad.Base.html#funWith"><span class="hs-identifier hs-var">funWith</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funExtLam :: Defn -&gt; Maybe ExtLamInfo
</span><a href="Agda.TypeChecking.Monad.Base.html#funExtLam"><span class="hs-identifier hs-var">funExtLam</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ExtLamInfo
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-497"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681880180"><span class="hs-identifier hs-var">mDefName</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880234"><span class="hs-identifier hs-var">addThisFn</span></a></span><span>
</span><span id="line-498"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681880235"><span class="hs-identifier hs-var">notMutual</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621681880218"><span class="hs-identifier hs-var">isToLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880223"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880226"><span class="hs-identifier hs-var">addLevel</span></a></span><span>
</span><span id="line-499"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681880235"><span class="hs-identifier hs-var">notMutual</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681880227"><span class="hs-identifier hs-var">shouldKeep</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880236"><span class="hs-identifier hs-var">addFn</span></a></span><span>
</span><span id="line-500"></span><span>            </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681880235"><span class="annot"><span class="annottext">notMutual :: Bool
</span><a href="#local-6989586621681880235"><span class="hs-identifier hs-var hs-var">notMutual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Defn -&gt; Bool
</span><a href="#local-6989586621681880211"><span class="hs-identifier hs-var">isNotMutual</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681880230"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-501"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880229"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-502"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880238"><span class="hs-identifier hs-var">addData</span></a></span><span>
</span><span id="line-503"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-504"></span><span>            </span><span id="local-6989586621681880240"><span class="annot"><a href="#local-6989586621681880240"><span class="hs-identifier hs-var">projections</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; TCMT IO Component) -&gt; [QName] -&gt; TCMT IO [Component]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; QName -&gt; TCMT IO Component
forall (tcm :: * -&gt; *).
(HasConstInfo tcm, ReadTCState tcm, MonadFresh VerboseLevel tcm,
 MonadTCM tcm) =&gt;
VerboseLevel -&gt; QName -&gt; tcm Component
</span><a href="Agda.Mimer.Mimer.html#qnameToComponent"><span class="hs-identifier hs-var">qnameToComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costSpeculateProj"><span class="hs-identifier hs-var">costSpeculateProj</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681880178"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([QName] -&gt; TCMT IO [Component])
-&gt; TCMT IO [QName] -&gt; TCMT IO [Component]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO [QName]
forall (tcm :: * -&gt; *).
(HasConstInfo tcm, MonadTCM tcm) =&gt;
QName -&gt; tcm [QName]
</span><a href="Agda.Mimer.Mimer.html#getRecordFields"><span class="hs-identifier hs-var">getRecordFields</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span><span>
</span><span id="line-505"></span><span>            </span><span id="local-6989586621681880244"><span class="annot"><a href="#local-6989586621681880244"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#qnameToComponent"><span class="hs-identifier hs-type">qnameToComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#costSet"><span class="hs-identifier hs-var">costSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880178"><span class="hs-identifier hs-type">costs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880221"><span class="hs-identifier hs-type">qname</span></a></span><span>
</span><span id="line-506"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621681880220"><span class="hs-identifier hs-type">comps</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintRecordTypes"><span class="hs-identifier hs-var">hintRecordTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880244"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintRecordTypes"><span class="hs-identifier hs-var">hintRecordTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880220"><span class="hs-identifier hs-type">comps</span></a></span><span>
</span><span id="line-507"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintProjections"><span class="hs-identifier hs-var">hintProjections</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880240"><span class="hs-identifier hs-type">projections</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintProjections"><span class="hs-identifier hs-var">hintProjections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880220"><span class="hs-identifier hs-type">comps</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-508"></span><span>          </span><span class="hs-comment">-- We look up constructors when we need them</span><span>
</span><span id="line-509"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880229"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-510"></span><span>          </span><span class="hs-comment">-- TODO: special treatment for primitives?</span><span>
</span><span id="line-511"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-512"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621681880218"><span class="hs-identifier hs-var">isToLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880223"><span class="hs-identifier hs-var">typ</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880226"><span class="hs-identifier hs-var">addLevel</span></a></span><span>
</span><span id="line-513"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681880227"><span class="hs-identifier hs-var">shouldKeep</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880236"><span class="hs-identifier hs-var">addFn</span></a></span><span>
</span><span id="line-514"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880229"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-515"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PrimitiveSort"><span class="hs-identifier hs-type">PrimitiveSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880229"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-516"></span><span>          </span><span class="hs-comment">-- TODO: Check if we want to use these</span><span>
</span><span id="line-517"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DataOrRecSig"><span class="hs-identifier hs-type">DataOrRecSig</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880229"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-518"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#GeneralizableVar"><span class="hs-identifier hs-type">GeneralizableVar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880229"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-519"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#AbstractDefn"><span class="hs-identifier hs-type">AbstractDefn</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM BaseComponents
</span><a href="#local-6989586621681880229"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-520"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-521"></span><span>          </span><span id="local-6989586621681880229"><span class="annot"><span class="annottext">done :: TCM BaseComponents
</span><a href="#local-6989586621681880229"><span class="hs-identifier hs-var hs-var">done</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseComponents -&gt; TCM BaseComponents
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681880220"><span class="hs-identifier hs-var">comps</span></a></span><span>
</span><span id="line-522"></span><span>          </span><span class="hs-comment">-- TODO: There is probably a better way of finding the module name</span><span>
</span><span id="line-523"></span><span>          </span><span id="local-6989586621681880251"><span class="annot"><span class="annottext">mThisModule :: Maybe ModuleName
</span><a href="#local-6989586621681880251"><span class="hs-identifier hs-var hs-var">mThisModule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; ModuleName
</span><a href="Agda.Syntax.Abstract.Name.html#qnameModule"><span class="hs-identifier hs-var">qnameModule</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ModuleName) -&gt; Maybe QName -&gt; Maybe ModuleName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681880180"><span class="hs-identifier hs-var">mDefName</span></a></span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span>          </span><span id="local-6989586621681880227"><span class="annot"><span class="annottext">shouldKeep :: Bool
</span><a href="#local-6989586621681880227"><span class="hs-identifier hs-var hs-var">shouldKeep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span>
</span><span id="line-526"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [QName] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681880204"><span class="hs-identifier hs-var">explicitHints</span></a></span><span>
</span><span id="line-527"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [QName] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681880181"><span class="hs-identifier hs-var">whereNames</span></a></span><span>
</span><span id="line-528"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HintMode
</span><a href="#local-6989586621681880206"><span class="hs-identifier hs-var">hintMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-529"></span><span>                </span><span class="annot"><span class="annottext">HintMode
</span><a href="Agda.Mimer.Options.html#Unqualified"><span class="hs-identifier hs-var">Unqualified</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; ScopeInfo -&gt; Bool
</span><a href="Agda.Syntax.Scope.Base.html#isNameInScopeUnqualified"><span class="hs-identifier hs-var">Scope.isNameInScopeUnqualified</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681880219"><span class="hs-identifier hs-var">scope</span></a></span><span>
</span><span id="line-530"></span><span>                </span><span class="annot"><span class="annottext">HintMode
</span><a href="Agda.Mimer.Options.html#AllModules"><span class="hs-identifier hs-var">AllModules</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-531"></span><span>                </span><span class="annot"><span class="annottext">HintMode
</span><a href="Agda.Mimer.Options.html#Module"><span class="hs-identifier hs-var">Module</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Maybe ModuleName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; ModuleName
</span><a href="Agda.Syntax.Abstract.Name.html#qnameModule"><span class="hs-identifier hs-var">qnameModule</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName -&gt; Maybe ModuleName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
</span><a href="#local-6989586621681880251"><span class="hs-identifier hs-var">mThisModule</span></a></span><span>
</span><span id="line-532"></span><span>                </span><span class="annot"><span class="annottext">HintMode
</span><a href="Agda.Mimer.Options.html#NoHints"><span class="hs-identifier hs-var">NoHints</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-533"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-534"></span><span>          </span><span id="local-6989586621681880226"><span class="annot"><span class="annottext">addLevel :: TCM BaseComponents
</span><a href="#local-6989586621681880226"><span class="hs-identifier hs-var hs-var">addLevel</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; QName -&gt; TCMT IO Component
forall (tcm :: * -&gt; *).
(HasConstInfo tcm, ReadTCState tcm, MonadFresh VerboseLevel tcm,
 MonadTCM tcm) =&gt;
VerboseLevel -&gt; QName -&gt; tcm Component
</span><a href="Agda.Mimer.Mimer.html#qnameToComponent"><span class="hs-identifier hs-var">qnameToComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costLevel"><span class="hs-identifier hs-var">costLevel</span></a></span><span>   </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681880178"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Component
-&gt; (Component -&gt; BaseComponents) -&gt; TCM BaseComponents
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681880259"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880259"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681880220"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintLevel"><span class="hs-identifier hs-var">hintLevel</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880259"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintLevel"><span class="hs-identifier hs-var">hintLevel</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621681880220"><span class="hs-identifier hs-type">comps</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-535"></span><span>          </span><span id="local-6989586621681880228"><span class="annot"><span class="annottext">addAxiom :: TCM BaseComponents
</span><a href="#local-6989586621681880228"><span class="hs-identifier hs-var hs-var">addAxiom</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; QName -&gt; TCMT IO Component
forall (tcm :: * -&gt; *).
(HasConstInfo tcm, ReadTCState tcm, MonadFresh VerboseLevel tcm,
 MonadTCM tcm) =&gt;
VerboseLevel -&gt; QName -&gt; tcm Component
</span><a href="Agda.Mimer.Mimer.html#qnameToComponent"><span class="hs-identifier hs-var">qnameToComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costAxiom"><span class="hs-identifier hs-var">costAxiom</span></a></span><span>   </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681880178"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Component
-&gt; (Component -&gt; BaseComponents) -&gt; TCM BaseComponents
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681880260"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880260"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681880220"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintAxioms"><span class="hs-identifier hs-var">hintAxioms</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880260"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintAxioms"><span class="hs-identifier hs-var">hintAxioms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880220"><span class="hs-identifier hs-type">comps</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-536"></span><span>          </span><span id="local-6989586621681880234"><span class="annot"><span class="annottext">addThisFn :: TCM BaseComponents
</span><a href="#local-6989586621681880234"><span class="hs-identifier hs-var hs-var">addThisFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; QName -&gt; TCMT IO Component
forall (tcm :: * -&gt; *).
(HasConstInfo tcm, ReadTCState tcm, MonadFresh VerboseLevel tcm,
 MonadTCM tcm) =&gt;
VerboseLevel -&gt; QName -&gt; tcm Component
</span><a href="Agda.Mimer.Mimer.html#qnameToComponent"><span class="hs-identifier hs-var">qnameToComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costRecCall"><span class="hs-identifier hs-var">costRecCall</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681880178"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Component
-&gt; (Component -&gt; BaseComponents) -&gt; TCM BaseComponents
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681880261"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880261"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681880220"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintThisFn"><span class="hs-identifier hs-var">hintThisFn</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621681880261"><span class="hs-identifier hs-type">comp</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compRec"><span class="hs-identifier hs-var">compRec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-537"></span><span>          </span><span id="local-6989586621681880236"><span class="annot"><span class="annottext">addFn :: TCM BaseComponents
</span><a href="#local-6989586621681880236"><span class="hs-identifier hs-var hs-var">addFn</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; QName -&gt; TCMT IO Component
forall (tcm :: * -&gt; *).
(HasConstInfo tcm, ReadTCState tcm, MonadFresh VerboseLevel tcm,
 MonadTCM tcm) =&gt;
VerboseLevel -&gt; QName -&gt; tcm Component
</span><a href="Agda.Mimer.Mimer.html#qnameToComponent"><span class="hs-identifier hs-var">qnameToComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costFn"><span class="hs-identifier hs-var">costFn</span></a></span><span>      </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681880178"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Component
-&gt; (Component -&gt; BaseComponents) -&gt; TCM BaseComponents
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681880262"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880262"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681880220"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintFns"><span class="hs-identifier hs-var">hintFns</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880262"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintFns"><span class="hs-identifier hs-var">hintFns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880220"><span class="hs-identifier hs-type">comps</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-538"></span><span>          </span><span id="local-6989586621681880238"><span class="annot"><span class="annottext">addData :: TCM BaseComponents
</span><a href="#local-6989586621681880238"><span class="hs-identifier hs-var hs-var">addData</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; QName -&gt; TCMT IO Component
forall (tcm :: * -&gt; *).
(HasConstInfo tcm, ReadTCState tcm, MonadFresh VerboseLevel tcm,
 MonadTCM tcm) =&gt;
VerboseLevel -&gt; QName -&gt; tcm Component
</span><a href="Agda.Mimer.Mimer.html#qnameToComponent"><span class="hs-identifier hs-var">qnameToComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costSet"><span class="hs-identifier hs-var">costSet</span></a></span><span>     </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681880178"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880221"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Component
-&gt; (Component -&gt; BaseComponents) -&gt; TCM BaseComponents
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681880263"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880263"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681880220"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintDataTypes"><span class="hs-identifier hs-var">hintDataTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880263"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintDataTypes"><span class="hs-identifier hs-var">hintDataTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880220"><span class="hs-identifier hs-type">comps</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-comment">-- | Is an element of the given type computing a level?</span><span>
</span><span id="line-541"></span><span class="hs-comment">--</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- The returned checker is only sound but not complete because the type is taken as-is</span><span>
</span><span id="line-543"></span><span class="hs-comment">-- rather than being reduced.</span><span>
</span><span id="line-544"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#endsInLevelTester"><span class="hs-identifier hs-type">endsInLevelTester</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span id="endsInLevelTester"><span class="annot"><span class="annottext">endsInLevelTester :: TCM (Type -&gt; Bool)
</span><a href="Agda.Mimer.Mimer.html#endsInLevelTester"><span class="hs-identifier hs-var hs-var">endsInLevelTester</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-546"></span><span>  </span><span class="annot"><span class="annottext">BuiltinId -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
BuiltinId -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinLevel"><span class="hs-identifier hs-var">builtinLevel</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO (Maybe QName)
-&gt; (Maybe QName -&gt; TCM (Type -&gt; Bool)) -&gt; TCM (Type -&gt; Bool)
forall a b. TCMT IO a -&gt; (a -&gt; TCMT IO b) -&gt; TCMT IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-547"></span><span>    </span><span class="annot"><span class="annottext">Maybe QName
</span><span class="hs-identifier hs-var">Nothing</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; TCM (Type -&gt; Bool)
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Type -&gt; Bool) -&gt; TCM (Type -&gt; Bool))
-&gt; (Type -&gt; Bool) -&gt; TCM (Type -&gt; Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-548"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681880266"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880266"><span class="hs-identifier hs-var">level</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; TCM (Type -&gt; Bool)
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681880267"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880267"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-549"></span><span>      </span><span class="hs-comment">-- NOTE: We do not reduce the type before checking, so some user definitions</span><span>
</span><span id="line-550"></span><span>      </span><span class="hs-comment">-- will not be included here.</span><span>
</span><span id="line-551"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TelView
</span><a href="Agda.TypeChecking.Substitute.html#telView%27"><span class="hs-identifier hs-var">telView'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880267"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-552"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#TelV"><span class="hs-identifier hs-type">TelV</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#El"><span class="hs-identifier hs-type">El</span></a></span><span> </span><span class="annot"><span class="annottext">Sort' Term
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621681880270"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880270"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Elims
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880270"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880266"><span class="hs-identifier hs-var">level</span></a></span><span>
</span><span id="line-553"></span><span>        </span><span class="annot"><span class="annottext">TelView
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span id="local-6989586621681877268"><span class="annot"><a href="Agda.Mimer.Mimer.html#qnameToComponent"><span class="hs-identifier hs-type">qnameToComponent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-type">HasConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877268"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877268"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadFresh"><span class="hs-identifier hs-type">MonadFresh</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#CompId"><span class="hs-identifier hs-type">CompId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877268"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877268"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877268"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span></span><span>
</span><span id="line-558"></span><span id="qnameToComponent"><span class="annot"><span class="annottext">qnameToComponent :: forall (tcm :: * -&gt; *).
(HasConstInfo tcm, ReadTCState tcm, MonadFresh VerboseLevel tcm,
 MonadTCM tcm) =&gt;
VerboseLevel -&gt; QName -&gt; tcm Component
</span><a href="Agda.Mimer.Mimer.html#qnameToComponent"><span class="hs-identifier hs-var hs-var">qnameToComponent</span></a></span></span><span> </span><span id="local-6989586621681880301"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880301"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span id="local-6989586621681880302"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880302"><span class="hs-identifier hs-var">qname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-559"></span><span>  </span><span id="local-6989586621681880303"><span class="annot"><a href="#local-6989586621681880303"><span class="hs-identifier hs-var">defn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; tcm Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880302"><span class="hs-identifier hs-var">qname</span></a></span><span>
</span><span id="line-560"></span><span>  </span><span class="hs-comment">-- #7120: we need to apply the module params to everything</span><span>
</span><span id="line-561"></span><span>  </span><span id="local-6989586621681880304"><span class="annot"><a href="#local-6989586621681880304"><span class="hs-identifier hs-var">mParams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#freeVarsToApply"><span class="hs-identifier hs-type">freeVarsToApply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880302"><span class="hs-identifier hs-type">qname</span></a></span><span>
</span><span id="line-562"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880306"><span class="annot"><a href="#local-6989586621681880306"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-var">Def</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880302"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Args -&gt; Term
forall t. Apply t =&gt; t -&gt; Args -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#apply"><span class="hs-operator hs-var">`apply`</span></a></span><span> </span><span class="annot"><span class="annottext">Args
</span><a href="#local-6989586621681880304"><span class="hs-identifier hs-var">mParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880307"><span class="annot"><a href="#local-6989586621681880307"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880308"><span class="annot"><a href="#local-6989586621681880308"><span class="hs-identifier hs-var">pars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880303"><span class="hs-identifier hs-type">defn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-564"></span><span>        </span><span id="local-6989586621681880309"><span class="annot"><span class="annottext">c :: Defn
</span><a href="#local-6989586621681880309"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConHead -&gt; ConInfo -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-var">Con</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Defn -&gt; ConHead
</span><a href="Agda.TypeChecking.Monad.Base.html#conSrcCon"><span class="hs-identifier hs-var">conSrcCon</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681880309"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConInfo
</span><a href="Agda.Syntax.Common.html#ConOCon"><span class="hs-identifier hs-var">ConOCon</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Defn -&gt; VerboseLevel
</span><a href="Agda.TypeChecking.Monad.Base.html#conPars"><span class="hs-identifier hs-var">conPars</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681880309"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Args -&gt; VerboseLevel
forall a. [a] -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Args
</span><a href="#local-6989586621681880304"><span class="hs-identifier hs-var">mParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term, VerboseLevel)
</span><a href="#local-6989586621681880306"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-566"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#GeneralizableVar"><span class="hs-identifier hs-type">GeneralizableVar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term, VerboseLevel)
</span><a href="#local-6989586621681880306"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-567"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term, VerboseLevel)
</span><a href="#local-6989586621681880306"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-568"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term, VerboseLevel)
</span><a href="#local-6989586621681880306"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-569"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term, VerboseLevel)
</span><a href="#local-6989586621681880306"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-570"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term, VerboseLevel)
</span><a href="#local-6989586621681880306"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-571"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PrimitiveSort"><span class="hs-identifier hs-type">PrimitiveSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term, VerboseLevel)
</span><a href="#local-6989586621681880306"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-572"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DataOrRecSig"><span class="hs-identifier hs-type">DataOrRecSig</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term, VerboseLevel)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-573"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#AbstractDefn"><span class="hs-identifier hs-type">AbstractDefn</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term, VerboseLevel)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span class="annot"><a href="Agda.Mimer.Mimer.html#newComponentQ"><span class="hs-identifier hs-type">newComponentQ</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621681880301"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880302"><span class="hs-identifier hs-type">qname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880308"><span class="hs-identifier hs-type">pars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880307"><span class="hs-identifier hs-type">term</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880303"><span class="hs-identifier hs-type">defn</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#piApply"><span class="hs-operator hs-type">`piApply`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880304"><span class="hs-identifier hs-type">mParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>
</span><span id="line-576"></span><span class="hs-comment">-- | From the scope of the given meta variable,</span><span>
</span><span id="line-577"></span><span class="hs-comment">--   extract all names in scope that we could use during synthesis.</span><span>
</span><span id="line-578"></span><span class="hs-comment">--   (This excludes macros, generalizable variables, pattern synonyms.)</span><span>
</span><span id="line-579"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#getEverythingInScope"><span class="hs-identifier hs-type">getEverythingInScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MetaVariable"><span class="hs-identifier hs-type">MetaVariable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-580"></span><span id="getEverythingInScope"><span class="annot"><span class="annottext">getEverythingInScope :: MetaVariable -&gt; [QName]
</span><a href="Agda.Mimer.Mimer.html#getEverythingInScope"><span class="hs-identifier hs-var hs-var">getEverythingInScope</span></a></span></span><span> </span><span id="local-6989586621681880315"><span class="annot"><span class="annottext">MetaVariable
</span><a href="#local-6989586621681880315"><span class="hs-identifier hs-var">metaVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-581"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880316"><span class="annot"><span class="annottext">scope :: ScopeInfo
</span><a href="#local-6989586621681880316"><span class="hs-identifier hs-var hs-var hs-var">scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Closure Range -&gt; ScopeInfo
forall a. Closure a -&gt; ScopeInfo
</span><a href="Agda.TypeChecking.Monad.Base.html#clScope"><span class="hs-identifier hs-var">clScope</span></a></span><span> </span><span class="annot"><span class="annottext">(Closure Range -&gt; ScopeInfo) -&gt; Closure Range -&gt; ScopeInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MetaVariable -&gt; Closure Range
</span><a href="Agda.TypeChecking.Monad.Base.html#getMetaInfo"><span class="hs-identifier hs-var">getMetaInfo</span></a></span><span> </span><span class="annot"><span class="annottext">MetaVariable
</span><a href="#local-6989586621681880315"><span class="hs-identifier hs-var">metaVar</span></a></span><span>
</span><span id="line-582"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880319"><span class="annot"><span class="annottext">nameSpace :: NameSpace
</span><a href="#local-6989586621681880319"><span class="hs-identifier hs-var hs-var">nameSpace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeInfo -&gt; NameSpace
</span><a href="Agda.Syntax.Scope.Base.html#everythingInScope"><span class="hs-identifier hs-var">Scope.everythingInScope</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681880316"><span class="hs-identifier hs-var">scope</span></a></span><span>
</span><span id="line-583"></span><span>      </span><span id="local-6989586621681880321"><span class="annot"><span class="annottext">names :: NamesInScope
</span><a href="#local-6989586621681880321"><span class="hs-identifier hs-var hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameSpace -&gt; NamesInScope
</span><a href="Agda.Syntax.Scope.Base.html#nsNames"><span class="hs-identifier hs-var">Scope.nsNames</span></a></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><a href="#local-6989586621681880319"><span class="hs-identifier hs-var">nameSpace</span></a></span><span>
</span><span id="line-584"></span><span>      </span><span id="local-6989586621681880323"><span class="annot"><span class="annottext">validKind :: KindOfName -&gt; Bool
</span><a href="#local-6989586621681880323"><span class="hs-identifier hs-var hs-var">validKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span>
</span><span id="line-585"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#PatternSynName"><span class="hs-identifier hs-var">Scope.PatternSynName</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>   </span><span class="hs-comment">-- could consider allowing pattern synonyms, but the problem is they can't be getConstInfo'd</span><span>
</span><span id="line-586"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#GeneralizeName"><span class="hs-identifier hs-var">Scope.GeneralizeName</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>   </span><span class="hs-comment">-- and any way finding the underlying constructors should be easy</span><span>
</span><span id="line-587"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#DisallowedGeneralizeName"><span class="hs-identifier hs-var">Scope.DisallowedGeneralizeName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-588"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#MacroName"><span class="hs-identifier hs-var">Scope.MacroName</span></a></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-589"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#QuotableName"><span class="hs-identifier hs-var">Scope.QuotableName</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-590"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#ConName"><span class="hs-identifier hs-var">Scope.ConName</span></a></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-591"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#CoConName"><span class="hs-identifier hs-var">Scope.CoConName</span></a></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-592"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#FldName"><span class="hs-identifier hs-var">Scope.FldName</span></a></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-593"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#DataName"><span class="hs-identifier hs-var">Scope.DataName</span></a></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-594"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#RecName"><span class="hs-identifier hs-var">Scope.RecName</span></a></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-595"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#FunName"><span class="hs-identifier hs-var">Scope.FunName</span></a></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-596"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#AxiomName"><span class="hs-identifier hs-var">Scope.AxiomName</span></a></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-597"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#PrimName"><span class="hs-identifier hs-var">Scope.PrimName</span></a></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-598"></span><span>        </span><span class="annot"><span class="annottext">KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#OtherDefName"><span class="hs-identifier hs-var">Scope.OtherDefName</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-599"></span><span>      </span><span id="local-6989586621681880338"><span class="annot"><span class="annottext">qnames :: [QName]
</span><a href="#local-6989586621681880338"><span class="hs-identifier hs-var hs-var">qnames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AbstractName -&gt; QName) -&gt; [AbstractName] -&gt; [QName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">AbstractName -&gt; QName
</span><a href="Agda.Syntax.Scope.Base.html#anameName"><span class="hs-identifier hs-var">Scope.anameName</span></a></span><span>
</span><span id="line-600"></span><span>             </span><span class="annot"><span class="annottext">([AbstractName] -&gt; [QName])
-&gt; ([NonEmpty AbstractName] -&gt; [AbstractName])
-&gt; [NonEmpty AbstractName]
-&gt; [QName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AbstractName -&gt; Bool) -&gt; [AbstractName] -&gt; [AbstractName]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindOfName -&gt; Bool
</span><a href="#local-6989586621681880323"><span class="hs-identifier hs-var">validKind</span></a></span><span> </span><span class="annot"><span class="annottext">(KindOfName -&gt; Bool)
-&gt; (AbstractName -&gt; KindOfName) -&gt; AbstractName -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AbstractName -&gt; KindOfName
</span><a href="Agda.Syntax.Scope.Base.html#anameKind"><span class="hs-identifier hs-var">Scope.anameKind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>             </span><span class="annot"><span class="annottext">([AbstractName] -&gt; [AbstractName])
-&gt; ([NonEmpty AbstractName] -&gt; [AbstractName])
-&gt; [NonEmpty AbstractName]
-&gt; [AbstractName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty AbstractName -&gt; AbstractName)
-&gt; [NonEmpty AbstractName] -&gt; [AbstractName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty AbstractName -&gt; AbstractName
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NonEmptyList.head</span></span><span>
</span><span id="line-602"></span><span>             </span><span class="annot"><span class="annottext">([NonEmpty AbstractName] -&gt; [QName])
-&gt; [NonEmpty AbstractName] -&gt; [QName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NamesInScope -&gt; [NonEmpty AbstractName]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">NamesInScope
</span><a href="#local-6989586621681880321"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-603"></span><span>  </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681880338"><span class="hs-identifier hs-var">qnames</span></a></span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span class="annot"><span class="hs-comment">-- | Turn the let bindings of the current 'TCEnv' into components.</span></span><span>
</span><span id="line-606"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#getLetVars"><span class="hs-identifier hs-type">getLetVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681877253"><span class="annot"><a href="#local-6989586621681877253"><span class="hs-identifier hs-type">tcm</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadFresh"><span class="hs-identifier hs-type">MonadFresh</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#CompId"><span class="hs-identifier hs-type">CompId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877253"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877253"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681877253"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877253"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-607"></span><span id="getLetVars"><span class="annot"><span class="annottext">getLetVars :: forall (tcm :: * -&gt; *).
(MonadFresh VerboseLevel tcm, MonadTCM tcm, Monad tcm) =&gt;
VerboseLevel -&gt; tcm [Open Component]
</span><a href="Agda.Mimer.Mimer.html#getLetVars"><span class="hs-identifier hs-var hs-var">getLetVars</span></a></span></span><span> </span><span id="local-6989586621681880355"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880355"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-608"></span><span>  </span><span id="local-6989586621681880356"><span class="annot"><a href="#local-6989586621681880356"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TCEnv -&gt; LetBindings) -&gt; tcm LetBindings
forall (m :: * -&gt; *) a. MonadTCEnv m =&gt; (TCEnv -&gt; a) -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#asksTC"><span class="hs-identifier hs-var">asksTC</span></a></span><span> </span><span class="annot"><span class="annottext">TCEnv -&gt; LetBindings
</span><a href="Agda.TypeChecking.Monad.Base.html#envLetBindings"><span class="hs-identifier hs-var">envLetBindings</span></a></span><span>
</span><span id="line-609"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="#local-6989586621681880359"><span class="hs-identifier hs-type">makeComp</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.toAscList</span></span><span> </span><span class="annot"><a href="#local-6989586621681880356"><span class="hs-identifier hs-type">bindings</span></a></span><span>
</span><span id="line-610"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-611"></span><span>    </span><span class="annot"><a href="#local-6989586621681880359"><span class="hs-identifier hs-type">makeComp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#LetBinding"><span class="hs-identifier hs-type">LetBinding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877253"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>    </span><span id="local-6989586621681880359"><span class="annot"><span class="annottext">makeComp :: (Name, Open LetBinding) -&gt; tcm (Open Component)
</span><a href="#local-6989586621681880359"><span class="hs-identifier hs-var hs-var">makeComp</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880361"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681880361"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880362"><span class="annot"><span class="annottext">Open LetBinding
</span><a href="#local-6989586621681880362"><span class="hs-identifier hs-var">opn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-613"></span><span>      </span><span id="local-6989586621681880363"><span class="annot"><a href="#local-6989586621681880363"><span class="hs-identifier hs-var">cId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">tcm VerboseLevel
forall i (m :: * -&gt; *). MonadFresh i m =&gt; m i
</span><a href="Agda.TypeChecking.Monad.Base.html#fresh"><span class="hs-identifier hs-var">fresh</span></a></span><span>
</span><span id="line-614"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621681880362"><span class="hs-identifier hs-type">opn</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#LetBinding"><span class="hs-identifier hs-type">LetBinding</span></a></span><span> </span><span id="local-6989586621681880365"><span class="annot"><span class="annottext">Origin
</span><a href="#local-6989586621681880365"><span class="hs-identifier hs-var">_origin</span></a></span></span><span> </span><span id="local-6989586621681880366"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880366"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621681880367"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880367"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-615"></span><span>                </span><span class="annot"><span class="annottext">VerboseLevel
-&gt; [MetaId]
-&gt; VerboseLevel
-&gt; Maybe Name
-&gt; VerboseLevel
-&gt; Term
-&gt; Type
-&gt; Component
</span><a href="Agda.Mimer.Mimer.html#mkComponent"><span class="hs-identifier hs-var">mkComponent</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880363"><span class="hs-identifier hs-var">cId</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880355"><span class="hs-identifier hs-var">cost</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681880361"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880366"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880367"><span class="hs-identifier hs-var">typ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="hs-comment">-- IDEA for implementing case-splitting:</span><span>
</span><span id="line-618"></span><span class="hs-comment">-- [x] 1. Modify the collectRecVarCandidates to get all variables.</span><span>
</span><span id="line-619"></span><span class="hs-comment">-- [ ] 2. Go through all variables to see if they are data types (not records)</span><span>
</span><span id="line-620"></span><span class="hs-comment">-- [ ] 3. Run makeCase for those variables.</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- [ ] 4. Find out how to get the new interaction points/metas from the cases</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- [ ] 5. After search is done, compute out-of-scope variables.</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- [ ] 6. Run make-case again to introduce those variables.</span><span>
</span><span id="line-624"></span><span class="hs-comment">-- [ ] 7. Redo the reification in the new clauses.</span><span>
</span><span id="line-625"></span><span class="hs-comment">-- [ ] 8. Return the new clauses and follow Auto for insertion.</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#getSplitVars"><span class="hs-identifier hs-type">getSplitVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span id="getSplitVars"><span class="annot"><span class="annottext">getSplitVars :: Open [(Term, Maybe VerboseLevel)] -&gt; TCMT IO (Open [Term])
</span><a href="Agda.Mimer.Mimer.html#getSplitVars"><span class="hs-identifier hs-var hs-var">getSplitVars</span></a></span></span><span> </span><span id="local-6989586621681880369"><span class="annot"><span class="annottext">Open [(Term, Maybe VerboseLevel)]
</span><a href="#local-6989586621681880369"><span class="hs-identifier hs-var">lhsVars'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span>    </span><span class="hs-comment">-- Compute the hintSplitVars from the pattern variables of function at the interaction point.</span><span>
</span><span id="line-631"></span><span>    </span><span id="local-6989586621681880370"><span class="annot"><a href="#local-6989586621681880370"><span class="hs-identifier hs-var">lhsVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Open [Term] -&gt; TCMT IO [Term]
forall a (m :: * -&gt; *).
(TermSubst a, MonadTCEnv m) =&gt;
Open a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Open.html#getOpen"><span class="hs-identifier hs-var">getOpen</span></a></span><span> </span><span class="annot"><span class="annottext">(Open [Term] -&gt; TCMT IO [Term]) -&gt; Open [Term] -&gt; TCMT IO [Term]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Term, Maybe VerboseLevel) -&gt; Term)
-&gt; [(Term, Maybe VerboseLevel)] -&gt; [Term]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Term, Maybe VerboseLevel) -&gt; Term
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(Term, Maybe VerboseLevel)] -&gt; [Term])
-&gt; Open [(Term, Maybe VerboseLevel)] -&gt; Open [Term]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Open [(Term, Maybe VerboseLevel)]
</span><a href="#local-6989586621681880369"><span class="hs-identifier hs-var">lhsVars'</span></a></span><span>
</span><span id="line-632"></span><span>    </span><span id="local-6989586621681880372"><span class="annot"><a href="#local-6989586621681880372"><span class="hs-identifier hs-var">typedLocals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#getLocalVarTerms"><span class="hs-identifier hs-type">getLocalVarTerms</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-633"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.components&quot;</span></span><span> </span><span class="annot"><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;All LHS variables:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880370"><span class="hs-identifier hs-type">lhsVars</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#parens"><span class="hs-identifier hs-type">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;or&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880370"><span class="hs-identifier hs-type">lhsVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880375"><span class="annot"><a href="#local-6989586621681880375"><span class="hs-identifier hs-var hs-var">typedLhsVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Term, Dom Type) -&gt; Bool)
-&gt; [(Term, Dom Type)] -&gt; [(Term, Dom Type)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681880376"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880376"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681880377"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880377"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880376"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; [Term] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621681880370"><span class="hs-identifier hs-var">lhsVars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Term, Dom Type)]
</span><a href="#local-6989586621681880372"><span class="hs-identifier hs-var">typedLocals</span></a></span><span>
</span><span id="line-635"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.components&quot;</span></span><span> </span><span class="annot"><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-636"></span><span>      </span><span class="annot"><span class="hs-string">&quot;LHS variables with types:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyList"><span class="hs-identifier hs-type">prettyList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="#local-6989586621681880379"><span class="hs-identifier hs-type">prettyTCMTypedTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880375"><span class="hs-identifier hs-type">typedLhsVars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#parens"><span class="hs-identifier hs-type">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;or&quot;</span></span><span>
</span><span id="line-637"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyList"><span class="hs-identifier hs-type">prettyList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="#local-6989586621681880380"><span class="hs-identifier hs-type">prettyTypedTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880375"><span class="hs-identifier hs-type">typedLhsVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>    </span><span class="hs-comment">-- TODO: For now, we *never* split on implicit arguments even if they are</span><span>
</span><span id="line-639"></span><span>    </span><span class="hs-comment">-- written explicitly on the LHS.</span><span>
</span><span id="line-640"></span><span>    </span><span id="local-6989586621681880381"><span class="annot"><a href="#local-6989586621681880381"><span class="hs-identifier hs-var">splitVarsTyped</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-641"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">filterM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880383"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880383"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880384"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880384"><span class="hs-identifier hs-var">dom</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TCM Bool
forall a. a -&gt; TCMT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type -&gt; Bool
forall a. LensHiding a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#visible"><span class="hs-identifier hs-var">visible</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880384"><span class="hs-identifier hs-var">dom</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCM Bool -&gt; TCM Bool -&gt; TCM Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCM Bool
forall (tcm :: * -&gt; *).
(MonadTCM tcm, MonadReduce tcm, HasConstInfo tcm) =&gt;
Type -&gt; tcm Bool
</span><a href="Agda.Mimer.Mimer.html#isTypeDatatype"><span class="hs-identifier hs-var">isTypeDatatype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880384"><span class="hs-identifier hs-var">dom</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>              </span><span class="annot"><a href="#local-6989586621681880375"><span class="hs-identifier hs-type">typedLhsVars</span></a></span><span>
</span><span id="line-643"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.components&quot;</span></span><span> </span><span class="annot"><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-644"></span><span>      </span><span class="annot"><span class="hs-string">&quot;Splittable variables&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyList"><span class="hs-identifier hs-type">prettyList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="#local-6989586621681880379"><span class="hs-identifier hs-type">prettyTCMTypedTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880381"><span class="hs-identifier hs-type">splitVarsTyped</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#parens"><span class="hs-identifier hs-type">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;or&quot;</span></span><span>
</span><span id="line-645"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyList"><span class="hs-identifier hs-type">prettyList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="#local-6989586621681880380"><span class="hs-identifier hs-type">prettyTypedTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880381"><span class="hs-identifier hs-type">splitVarsTyped</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Open.html#makeOpen"><span class="hs-identifier hs-type">makeOpen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fst</span></span><span> </span><span class="annot"><a href="#local-6989586621681880381"><span class="hs-identifier hs-type">splitVarsTyped</span></a></span><span>
</span><span id="line-647"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-648"></span><span>    </span><span id="local-6989586621681877309"><span id="local-6989586621681877310"><span class="annot"><a href="#local-6989586621681880379"><span class="hs-identifier hs-type">prettyTCMTypedTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877309"><span class="hs-identifier hs-type">tm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877310"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681877309"><span class="hs-identifier hs-type">tm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681877310"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span></span></span><span>
</span><span id="line-649"></span><span>    </span><span id="local-6989586621681880379"><span class="annot"><span class="annottext">prettyTCMTypedTerm :: forall tm ty.
(PrettyTCM tm, PrettyTCM ty) =&gt;
(tm, ty) -&gt; TCMT IO Doc
</span><a href="#local-6989586621681880379"><span class="hs-identifier hs-var hs-var">prettyTCMTypedTerm</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880395"><span class="annot"><span class="annottext">tm
</span><a href="#local-6989586621681880395"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880396"><span class="annot"><span class="annottext">ty
</span><a href="#local-6989586621681880396"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">tm -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; tm -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">tm
</span><a href="#local-6989586621681880395"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ty -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; ty -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">ty
</span><a href="#local-6989586621681880396"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-650"></span><span>    </span><span id="local-6989586621681880380"><span class="annot"><span class="annottext">prettyTypedTerm :: (a, a) -&gt; m Doc
</span><a href="#local-6989586621681880380"><span class="hs-identifier hs-var hs-var">prettyTypedTerm</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880410"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681880410"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880411"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681880411"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681880410"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681880411"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span class="hs-comment">-- | Returns the variables as terms together with whether they where found under</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- some constructor, and if so which argument of the function they appeared in. This</span><span>
</span><span id="line-654"></span><span class="hs-comment">-- information is used when building recursive calls, where it's important that we don't try to</span><span>
</span><span id="line-655"></span><span class="hs-comment">-- construct non-terminating solutions.</span><span>
</span><span id="line-656"></span><span id="local-6989586621681877248"><span class="annot"><a href="Agda.Mimer.Mimer.html#collectLHSVars"><span class="hs-identifier hs-type">collectLHSVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877248"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCErr"><span class="hs-identifier hs-type">TCErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877248"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877248"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-type">HasConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877248"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#InteractionId"><span class="hs-identifier hs-type">InteractionId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877248"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Open"><span class="hs-identifier hs-type">Open</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-658"></span><span id="collectLHSVars"><span class="annot"><span class="annottext">collectLHSVars :: forall (tcm :: * -&gt; *).
(ReadTCState tcm, MonadError TCErr tcm, MonadTCM tcm,
 HasConstInfo tcm) =&gt;
InteractionId -&gt; tcm (Open [(Term, Maybe VerboseLevel)])
</span><a href="Agda.Mimer.Mimer.html#collectLHSVars"><span class="hs-identifier hs-var hs-var">collectLHSVars</span></a></span></span><span> </span><span id="local-6989586621681880483"><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681880483"><span class="hs-identifier hs-var">ii</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-659"></span><span>  </span><span id="local-6989586621681880484"><span class="annot"><a href="#local-6989586621681880484"><span class="hs-identifier hs-var">ipc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InteractionPoint -&gt; IPClause
</span><a href="Agda.TypeChecking.Monad.Base.html#ipClause"><span class="hs-identifier hs-var">ipClause</span></a></span><span> </span><span class="annot"><span class="annottext">(InteractionPoint -&gt; IPClause)
-&gt; tcm InteractionPoint -&gt; tcm IPClause
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">InteractionId -&gt; tcm InteractionPoint
forall (m :: * -&gt; *).
(ReadTCState m, MonadError TCErr m, MonadTCEnv m) =&gt;
InteractionId -&gt; m InteractionPoint
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#lookupInteractionPoint"><span class="hs-identifier hs-var">lookupInteractionPoint</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681880483"><span class="hs-identifier hs-var">ii</span></a></span><span>
</span><span id="line-660"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681880484"><span class="hs-identifier hs-type">ipc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-661"></span><span>    </span><span class="annot"><span class="annottext">IPClause
</span><a href="Agda.TypeChecking.Monad.Base.html#IPNoClause"><span class="hs-identifier hs-var">IPNoClause</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Term, Maybe VerboseLevel)]
-&gt; tcm (Open [(Term, Maybe VerboseLevel)])
forall (m :: * -&gt; *) a.
(ReadTCState m, MonadTCEnv m) =&gt;
a -&gt; m (Open a)
</span><a href="Agda.TypeChecking.Monad.Open.html#makeOpen"><span class="hs-identifier hs-var">makeOpen</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-662"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#IPClause"><span class="hs-identifier hs-type">IPClause</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ipcQName :: IPClause -&gt; QName
</span><a href="Agda.TypeChecking.Monad.Base.html#ipcQName"><span class="hs-identifier hs-var">ipcQName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681880490"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880490"><span class="hs-identifier hs-var">fnName</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ipcClauseNo :: IPClause -&gt; VerboseLevel
</span><a href="Agda.TypeChecking.Monad.Base.html#ipcClauseNo"><span class="hs-identifier hs-var">ipcClauseNo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681880492"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880492"><span class="hs-identifier hs-var">clauseNr</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-663"></span><span>      </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; tcm ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.components&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; tcm ()) -&gt; TCMT IO Doc -&gt; tcm ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Collecting LHS vars for&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionId -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; InteractionId -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681880483"><span class="hs-identifier hs-var">ii</span></a></span><span>
</span><span id="line-664"></span><span>      </span><span id="local-6989586621681880493"><span class="annot"><a href="#local-6989586621681880493"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; tcm Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880490"><span class="hs-identifier hs-var">fnName</span></a></span><span>
</span><span id="line-665"></span><span>      </span><span id="local-6989586621681880494"><span class="annot"><a href="#local-6989586621681880494"><span class="hs-identifier hs-var">parCount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-type">liftTCM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#getCurrentModuleFreeVars"><span class="hs-identifier hs-type">getCurrentModuleFreeVars</span></a></span><span>
</span><span id="line-666"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880493"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-667"></span><span>        </span><span id="local-6989586621681880496"><span class="annot"><span class="annottext">fnDef :: Defn
</span><a href="#local-6989586621681880496"><span class="hs-identifier hs-var">fnDef</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-668"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880497"><span class="annot"><span class="annottext">clause :: Clause
</span><a href="#local-6989586621681880497"><span class="hs-identifier hs-var hs-var hs-var">clause</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defn -&gt; [Clause]
</span><a href="Agda.TypeChecking.Monad.Base.html#funClauses"><span class="hs-identifier hs-var">funClauses</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681880496"><span class="hs-identifier hs-var">fnDef</span></a></span><span> </span><span class="annot"><span class="annottext">[Clause] -&gt; VerboseLevel -&gt; Clause
forall a. HasCallStack =&gt; [a] -&gt; VerboseLevel -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880492"><span class="hs-identifier hs-var">clauseNr</span></a></span><span>
</span><span id="line-669"></span><span>              </span><span id="local-6989586621681880500"><span class="annot"><span class="annottext">naps :: NAPs
</span><a href="#local-6989586621681880500"><span class="hs-identifier hs-var hs-var hs-var">naps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Clause -&gt; NAPs
</span><a href="Agda.Syntax.Internal.html#namedClausePats"><span class="hs-identifier hs-var">namedClausePats</span></a></span><span> </span><span class="annot"><span class="annottext">Clause
</span><a href="#local-6989586621681880497"><span class="hs-identifier hs-var">clause</span></a></span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span>          </span><span class="hs-comment">-- Telescope at interaction point</span><span>
</span><span id="line-672"></span><span>          </span><span id="local-6989586621681880502"><span class="annot"><a href="#local-6989586621681880502"><span class="hs-identifier hs-var">iTel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">tcm Telescope
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m Telescope
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-var">getContextTelescope</span></a></span><span>
</span><span id="line-673"></span><span>          </span><span class="hs-comment">-- Telescope for the body of the clause</span><span>
</span><span id="line-674"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880504"><span class="annot"><a href="#local-6989586621681880504"><span class="hs-identifier hs-var hs-var">cTel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Clause -&gt; Telescope
</span><a href="Agda.Syntax.Internal.html#clauseTel"><span class="hs-identifier hs-var">clauseTel</span></a></span><span> </span><span class="annot"><span class="annottext">Clause
</span><a href="#local-6989586621681880497"><span class="hs-identifier hs-var">clause</span></a></span><span>
</span><span id="line-675"></span><span>          </span><span class="hs-comment">-- HACK: To get the correct indices, we shift by the difference in telescope lengths</span><span>
</span><span id="line-676"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880506"><span class="annot"><a href="#local-6989586621681880506"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Arg ArgName] -&gt; VerboseLevel
forall a. [a] -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; [Arg ArgName]
forall a. TelToArgs a =&gt; a -&gt; [Arg ArgName]
</span><a href="Agda.Syntax.Internal.html#telToArgs"><span class="hs-identifier hs-var">telToArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681880502"><span class="hs-identifier hs-var">iTel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[Arg ArgName] -&gt; VerboseLevel
forall a. [a] -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; [Arg ArgName]
forall a. TelToArgs a =&gt; a -&gt; [Arg ArgName]
</span><a href="Agda.Syntax.Internal.html#telToArgs"><span class="hs-identifier hs-var">telToArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681880504"><span class="hs-identifier hs-var">cTel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer&quot;</span></span><span> </span><span class="annot"><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-679"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Tel:&quot;</span></span><span>
</span><span id="line-680"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880502"><span class="hs-identifier hs-type">iTel</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880502"><span class="hs-identifier hs-type">iTel</span></a></span><span>
</span><span id="line-681"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;CTel:&quot;</span></span><span>
</span><span id="line-682"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880504"><span class="hs-identifier hs-type">cTel</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880504"><span class="hs-identifier hs-type">cTel</span></a></span><span>
</span><span id="line-683"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-684"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer&quot;</span></span><span> </span><span class="annot"><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Shift:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880506"><span class="hs-identifier hs-type">shift</span></a></span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Open.html#makeOpen"><span class="hs-identifier hs-type">makeOpen</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880512"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621681880506"><span class="hs-identifier hs-type">shift</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880513"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621681880494"><span class="hs-identifier hs-type">parCount</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><a href="#local-6989586621681880515"><span class="hs-identifier hs-type">underCon</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- We count arguments excluding module parameters</span><span>
</span><span id="line-687"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880513"><span class="annot"><a href="#local-6989586621681880513"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880516"><span class="annot"><a href="#local-6989586621681880516"><span class="hs-identifier hs-var">nap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621681880500"><span class="hs-identifier hs-type">naps</span></a></span><span>
</span><span id="line-688"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880512"><span class="annot"><a href="#local-6989586621681880512"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880515"><span class="annot"><a href="#local-6989586621681880515"><span class="hs-identifier hs-var">underCon</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681880517"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#namedThing"><span class="hs-identifier hs-var">namedThing</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880516"><span class="hs-identifier hs-type">nap</span></a></span><span>
</span><span id="line-689"></span><span>                   </span><span class="hs-special">]</span><span>
</span><span id="line-690"></span><span>        </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-691"></span><span>          </span><span class="annot"><span class="annottext">[(Term, Maybe VerboseLevel)]
-&gt; tcm (Open [(Term, Maybe VerboseLevel)])
forall (m :: * -&gt; *) a.
(ReadTCState m, MonadTCEnv m) =&gt;
a -&gt; m (Open a)
</span><a href="Agda.TypeChecking.Monad.Open.html#makeOpen"><span class="hs-identifier hs-var">makeOpen</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-692"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-693"></span><span>    </span><span id="local-6989586621681880517"><span class="annot"><span class="annottext">go :: Bool -&gt; DeBruijnPattern -&gt; [(VerboseLevel, Bool)]
</span><a href="#local-6989586621681880517"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681880520"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681880520"><span class="hs-identifier hs-var">isUnderCon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-694"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#VarP"><span class="hs-identifier hs-type">VarP</span></a></span><span> </span><span id="local-6989586621681880522"><span class="annot"><span class="annottext">PatternInfo
</span><a href="#local-6989586621681880522"><span class="hs-identifier hs-var">patInf</span></a></span></span><span> </span><span id="local-6989586621681880523"><span class="annot"><span class="annottext">DBPatVar
</span><a href="#local-6989586621681880523"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">DBPatVar -&gt; VerboseLevel
</span><a href="Agda.Syntax.Internal.html#dbPatVarIndex"><span class="hs-identifier hs-var">dbPatVarIndex</span></a></span><span> </span><span class="annot"><span class="annottext">DBPatVar
</span><a href="#local-6989586621681880523"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681880520"><span class="hs-identifier hs-var">isUnderCon</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-695"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#DotP"><span class="hs-identifier hs-type">DotP</span></a></span><span> </span><span id="local-6989586621681880526"><span class="annot"><span class="annottext">PatternInfo
</span><a href="#local-6989586621681880526"><span class="hs-identifier hs-var">patInf</span></a></span></span><span> </span><span id="local-6989586621681880527"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880527"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Ignore dot patterns</span><span>
</span><span id="line-696"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#ConP"><span class="hs-identifier hs-type">ConP</span></a></span><span> </span><span id="local-6989586621681880529"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681880529"><span class="hs-identifier hs-var">conHead</span></a></span></span><span> </span><span id="local-6989586621681880530"><span class="annot"><span class="annottext">ConPatternInfo
</span><a href="#local-6989586621681880530"><span class="hs-identifier hs-var">conPatInf</span></a></span></span><span> </span><span id="local-6989586621681880531"><span class="annot"><span class="annottext">NAPs
</span><a href="#local-6989586621681880531"><span class="hs-identifier hs-var">namedArgs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(NamedArg DeBruijnPattern -&gt; [(VerboseLevel, Bool)])
-&gt; NAPs -&gt; [(VerboseLevel, Bool)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; DeBruijnPattern -&gt; [(VerboseLevel, Bool)]
</span><a href="#local-6989586621681880517"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">(DeBruijnPattern -&gt; [(VerboseLevel, Bool)])
-&gt; (NamedArg DeBruijnPattern -&gt; DeBruijnPattern)
-&gt; NamedArg DeBruijnPattern
-&gt; [(VerboseLevel, Bool)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Named NamedName DeBruijnPattern -&gt; DeBruijnPattern
forall name a. Named name a -&gt; a
</span><a href="Agda.Syntax.Common.html#namedThing"><span class="hs-identifier hs-var">namedThing</span></a></span><span> </span><span class="annot"><span class="annottext">(Named NamedName DeBruijnPattern -&gt; DeBruijnPattern)
-&gt; (NamedArg DeBruijnPattern -&gt; Named NamedName DeBruijnPattern)
-&gt; NamedArg DeBruijnPattern
-&gt; DeBruijnPattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NamedArg DeBruijnPattern -&gt; Named NamedName DeBruijnPattern
forall e. Arg e -&gt; e
</span><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NAPs
</span><a href="#local-6989586621681880531"><span class="hs-identifier hs-var">namedArgs</span></a></span><span>
</span><span id="line-697"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#LitP"><span class="hs-identifier hs-type">LitP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-698"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#ProjP"><span class="hs-identifier hs-type">ProjP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-699"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#IApplyP"><span class="hs-identifier hs-type">IApplyP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Only for Cubical?</span><span>
</span><span id="line-700"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#DefP"><span class="hs-identifier hs-type">DefP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Only for Cubical?</span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#declarationQnames"><span class="hs-identifier hs-type">declarationQnames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Declaration"><span class="hs-identifier hs-type">A.Declaration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-703"></span><span id="declarationQnames"><span class="annot"><span class="annottext">declarationQnames :: Declaration -&gt; [QName]
</span><a href="Agda.Mimer.Mimer.html#declarationQnames"><span class="hs-identifier hs-var hs-var">declarationQnames</span></a></span></span><span> </span><span id="local-6989586621681880538"><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621681880538"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880539"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#WithKind"><span class="hs-identifier hs-type">Scope.WithKind</span></a></span><span> </span><span class="annot"><span class="annottext">KindOfName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681880539"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880539"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; [KName]
forall m. Collection KName m =&gt; Declaration -&gt; m
forall a m. (DeclaredNames a, Collection KName m) =&gt; a -&gt; m
</span><a href="Agda.Syntax.Abstract.Views.html#declaredNames"><span class="hs-identifier hs-var">A.declaredNames</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621681880538"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-704"></span><span>
</span><span id="line-705"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-706"></span><span class="annot"><span class="hs-comment">-- * Measure performance</span></span><span>
</span><span id="line-707"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-708"></span><span class="hs-keyword">data</span><span> </span><span id="MimerStats"><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerStats"><span class="hs-identifier hs-var">MimerStats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MimerStats"><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerStats"><span class="hs-identifier hs-var">MimerStats</span></a></span></span><span>
</span><span id="line-709"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="statCompHit"><span class="annot"><span class="annottext">MimerStats -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statCompHit"><span class="hs-identifier hs-var hs-var">statCompHit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Could make use of an already generated component</span></span><span>
</span><span id="line-710"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statCompGen"><span class="annot"><span class="annottext">MimerStats -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statCompGen"><span class="hs-identifier hs-var hs-var">statCompGen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Could use a generator for a component</span></span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statCompRegen"><span class="annot"><span class="annottext">MimerStats -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statCompRegen"><span class="hs-identifier hs-var hs-var">statCompRegen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Had to regenerate the cache (new context)</span></span><span>
</span><span id="line-712"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statCompNoRegen"><span class="annot"><span class="annottext">MimerStats -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statCompNoRegen"><span class="hs-identifier hs-var hs-var">statCompNoRegen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Did not have to regenerate the cache</span></span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statMetasCreated"><span class="annot"><span class="annottext">MimerStats -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statMetasCreated"><span class="hs-identifier hs-var hs-var">statMetasCreated</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Total number of meta-variables created explicitly (not through unification)</span></span><span>
</span><span id="line-714"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statTypeEqChecks"><span class="annot"><span class="annottext">MimerStats -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statTypeEqChecks"><span class="hs-identifier hs-var hs-var">statTypeEqChecks</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Number of times type equality is tested (with unification)</span></span><span>
</span><span id="line-715"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statRefineSuccess"><span class="annot"><span class="annottext">MimerStats -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statRefineSuccess"><span class="hs-identifier hs-var hs-var">statRefineSuccess</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Number of times a refinement has been successful</span></span><span>
</span><span id="line-716"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statRefineFail"><span class="annot"><span class="annottext">MimerStats -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statRefineFail"><span class="hs-identifier hs-var hs-var">statRefineFail</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Number of times a refinement has failed</span></span><span>
</span><span id="line-717"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880552"><span id="local-6989586621681880563"><span id="local-6989586621681880566"><span class="annot"><span class="annottext">VerboseLevel -&gt; MimerStats -&gt; ArgName -&gt; ArgName
[MimerStats] -&gt; ArgName -&gt; ArgName
MimerStats -&gt; ArgName
(VerboseLevel -&gt; MimerStats -&gt; ArgName -&gt; ArgName)
-&gt; (MimerStats -&gt; ArgName)
-&gt; ([MimerStats] -&gt; ArgName -&gt; ArgName)
-&gt; Show MimerStats
forall a.
(VerboseLevel -&gt; a -&gt; ArgName -&gt; ArgName)
-&gt; (a -&gt; ArgName) -&gt; ([a] -&gt; ArgName -&gt; ArgName) -&gt; Show a
$cshowsPrec :: VerboseLevel -&gt; MimerStats -&gt; ArgName -&gt; ArgName
showsPrec :: VerboseLevel -&gt; MimerStats -&gt; ArgName -&gt; ArgName
$cshow :: MimerStats -&gt; ArgName
show :: MimerStats -&gt; ArgName
$cshowList :: [MimerStats] -&gt; ArgName -&gt; ArgName
showList :: [MimerStats] -&gt; ArgName -&gt; ArgName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880571"><span id="local-6989586621681880581"><span class="annot"><span class="annottext">MimerStats -&gt; MimerStats -&gt; Bool
(MimerStats -&gt; MimerStats -&gt; Bool)
-&gt; (MimerStats -&gt; MimerStats -&gt; Bool) -&gt; Eq MimerStats
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: MimerStats -&gt; MimerStats -&gt; Bool
== :: MimerStats -&gt; MimerStats -&gt; Bool
$c/= :: MimerStats -&gt; MimerStats -&gt; Bool
/= :: MimerStats -&gt; MimerStats -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880585"><span id="local-6989586621681880587"><span class="annot"><span class="annottext">(forall x. MimerStats -&gt; Rep MimerStats x)
-&gt; (forall x. Rep MimerStats x -&gt; MimerStats) -&gt; Generic MimerStats
forall x. Rep MimerStats x -&gt; MimerStats
forall x. MimerStats -&gt; Rep MimerStats x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. MimerStats -&gt; Rep MimerStats x
from :: forall x. MimerStats -&gt; Rep MimerStats x
$cto :: forall x. Rep MimerStats x -&gt; MimerStats
to :: forall x. Rep MimerStats x -&gt; MimerStats
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-718"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681880590"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerStats"><span class="hs-identifier hs-type">MimerStats</span></a></span></span><span>
</span><span id="line-719"></span><span>
</span><span id="line-720"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#emptyMimerStats"><span class="hs-identifier hs-type">emptyMimerStats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerStats"><span class="hs-identifier hs-type">MimerStats</span></a></span><span>
</span><span id="line-721"></span><span id="emptyMimerStats"><span class="annot"><span class="annottext">emptyMimerStats :: MimerStats
</span><a href="Agda.Mimer.Mimer.html#emptyMimerStats"><span class="hs-identifier hs-var hs-var">emptyMimerStats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerStats"><span class="hs-identifier hs-type">MimerStats</span></a></span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">statCompHit :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statCompHit"><span class="hs-identifier hs-var">statCompHit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statCompGen :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statCompGen"><span class="hs-identifier hs-var">statCompGen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statCompRegen :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statCompRegen"><span class="hs-identifier hs-var">statCompRegen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statCompNoRegen :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statCompNoRegen"><span class="hs-identifier hs-var">statCompNoRegen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statMetasCreated :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statMetasCreated"><span class="hs-identifier hs-var">statMetasCreated</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statTypeEqChecks :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statTypeEqChecks"><span class="hs-identifier hs-var">statTypeEqChecks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statRefineSuccess :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statRefineSuccess"><span class="hs-identifier hs-var">statRefineSuccess</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statRefineFail :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#statRefineFail"><span class="hs-identifier hs-var">statRefineFail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span class="hs-special">}</span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#incCompHit"><span class="hs-identifier hs-type">incCompHit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#incCompGen"><span class="hs-identifier hs-type">incCompGen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#incCompRegen"><span class="hs-identifier hs-type">incCompRegen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#incCompNoRegen"><span class="hs-identifier hs-type">incCompNoRegen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#incMetasCreated"><span class="hs-identifier hs-type">incMetasCreated</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#incTypeEqChecks"><span class="hs-identifier hs-type">incTypeEqChecks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#incRefineSuccess"><span class="hs-identifier hs-type">incRefineSuccess</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#incRefineFail"><span class="hs-identifier hs-type">incRefineFail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerStats"><span class="hs-identifier hs-type">MimerStats</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerStats"><span class="hs-identifier hs-type">MimerStats</span></a></span><span>
</span><span id="line-725"></span><span id="incCompHit"><span class="annot"><span class="annottext">incCompHit :: MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incCompHit"><span class="hs-identifier hs-var hs-var">incCompHit</span></a></span></span><span>       </span><span id="local-6989586621681880623"><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880623"><span class="hs-identifier hs-var">stats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880623"><span class="hs-identifier hs-var">stats</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#statCompHit"><span class="hs-identifier hs-var">statCompHit</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">succ</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#statCompHit"><span class="hs-identifier hs-var">statCompHit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880623"><span class="hs-identifier hs-type">stats</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-726"></span><span id="incCompGen"><span class="annot"><span class="annottext">incCompGen :: MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incCompGen"><span class="hs-identifier hs-var hs-var">incCompGen</span></a></span></span><span>       </span><span id="local-6989586621681880625"><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880625"><span class="hs-identifier hs-var">stats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880625"><span class="hs-identifier hs-var">stats</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#statCompGen"><span class="hs-identifier hs-var">statCompGen</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">succ</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#statCompGen"><span class="hs-identifier hs-var">statCompGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880625"><span class="hs-identifier hs-type">stats</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-727"></span><span id="incCompRegen"><span class="annot"><span class="annottext">incCompRegen :: MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incCompRegen"><span class="hs-identifier hs-var hs-var">incCompRegen</span></a></span></span><span>     </span><span id="local-6989586621681880626"><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880626"><span class="hs-identifier hs-var">stats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880626"><span class="hs-identifier hs-var">stats</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#statCompRegen"><span class="hs-identifier hs-var">statCompRegen</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">succ</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#statCompRegen"><span class="hs-identifier hs-var">statCompRegen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880626"><span class="hs-identifier hs-type">stats</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-728"></span><span id="incCompNoRegen"><span class="annot"><span class="annottext">incCompNoRegen :: MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incCompNoRegen"><span class="hs-identifier hs-var hs-var">incCompNoRegen</span></a></span></span><span>   </span><span id="local-6989586621681880627"><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880627"><span class="hs-identifier hs-var">stats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880627"><span class="hs-identifier hs-var">stats</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#statCompNoRegen"><span class="hs-identifier hs-var">statCompNoRegen</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">succ</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#statCompNoRegen"><span class="hs-identifier hs-var">statCompNoRegen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880627"><span class="hs-identifier hs-type">stats</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-729"></span><span id="incMetasCreated"><span class="annot"><span class="annottext">incMetasCreated :: MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incMetasCreated"><span class="hs-identifier hs-var hs-var">incMetasCreated</span></a></span></span><span>  </span><span id="local-6989586621681880628"><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880628"><span class="hs-identifier hs-var">stats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880628"><span class="hs-identifier hs-var">stats</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#statMetasCreated"><span class="hs-identifier hs-var">statMetasCreated</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">succ</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#statMetasCreated"><span class="hs-identifier hs-var">statMetasCreated</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880628"><span class="hs-identifier hs-type">stats</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-730"></span><span id="incTypeEqChecks"><span class="annot"><span class="annottext">incTypeEqChecks :: MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incTypeEqChecks"><span class="hs-identifier hs-var hs-var">incTypeEqChecks</span></a></span></span><span>  </span><span id="local-6989586621681880629"><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880629"><span class="hs-identifier hs-var">stats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880629"><span class="hs-identifier hs-var">stats</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#statTypeEqChecks"><span class="hs-identifier hs-var">statTypeEqChecks</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">succ</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#statTypeEqChecks"><span class="hs-identifier hs-var">statTypeEqChecks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880629"><span class="hs-identifier hs-type">stats</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-731"></span><span id="incRefineSuccess"><span class="annot"><span class="annottext">incRefineSuccess :: MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incRefineSuccess"><span class="hs-identifier hs-var hs-var">incRefineSuccess</span></a></span></span><span> </span><span id="local-6989586621681880630"><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880630"><span class="hs-identifier hs-var">stats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880630"><span class="hs-identifier hs-var">stats</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#statRefineSuccess"><span class="hs-identifier hs-var">statRefineSuccess</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">succ</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#statRefineSuccess"><span class="hs-identifier hs-var">statRefineSuccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880630"><span class="hs-identifier hs-type">stats</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-732"></span><span id="incRefineFail"><span class="annot"><span class="annottext">incRefineFail :: MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incRefineFail"><span class="hs-identifier hs-var hs-var">incRefineFail</span></a></span></span><span>    </span><span id="local-6989586621681880631"><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880631"><span class="hs-identifier hs-var">stats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MimerStats
</span><a href="#local-6989586621681880631"><span class="hs-identifier hs-var">stats</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#statRefineFail"><span class="hs-identifier hs-var">statRefineFail</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">succ</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#statRefineFail"><span class="hs-identifier hs-var">statRefineFail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880631"><span class="hs-identifier hs-type">stats</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-733"></span><span>
</span><span id="line-734"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#updateStat"><span class="hs-identifier hs-type">updateStat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerStats"><span class="hs-identifier hs-type">MimerStats</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerStats"><span class="hs-identifier hs-type">MimerStats</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-735"></span><span id="updateStat"><span class="annot"><span class="annottext">updateStat :: (MimerStats -&gt; MimerStats) -&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#updateStat"><span class="hs-identifier hs-var hs-var">updateStat</span></a></span></span><span> </span><span id="local-6989586621681880633"><span class="annot"><span class="annottext">MimerStats -&gt; MimerStats
</span><a href="#local-6989586621681880633"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) ()
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; m () -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#verboseS"><span class="hs-identifier hs-var">verboseS</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.stats&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) ()
 -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; ReaderT SearchOptions (TCMT IO) ()
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-736"></span><span>  </span><span id="local-6989586621681880634"><span class="annot"><a href="#local-6989586621681880634"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; IORef MimerStats)
-&gt; ReaderT SearchOptions (TCMT IO) (IORef MimerStats)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; IORef MimerStats
</span><a href="Agda.Mimer.Mimer.html#searchStats"><span class="hs-identifier hs-var">searchStats</span></a></span><span>
</span><span id="line-737"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">modifyIORef'</span></span><span> </span><span class="annot"><a href="#local-6989586621681880634"><span class="hs-identifier hs-type">ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880633"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-741"></span><span class="annot"><span class="hs-comment">-- * Core algorithm</span></span><span>
</span><span id="line-742"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-743"></span><span>
</span><span id="line-744"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#runSearch"><span class="hs-identifier hs-type">runSearch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Interaction.Base.html#Rewrite"><span class="hs-identifier hs-type">Rewrite</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Options.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#InteractionId"><span class="hs-identifier hs-type">InteractionId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerResult"><span class="hs-identifier hs-type">MimerResult</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-745"></span><span id="runSearch"><span class="annot"><span class="annottext">runSearch :: Rewrite -&gt; Options -&gt; InteractionId -&gt; Range -&gt; TCM [MimerResult]
</span><a href="Agda.Mimer.Mimer.html#runSearch"><span class="hs-identifier hs-var hs-var">runSearch</span></a></span></span><span> </span><span id="local-6989586621681880635"><span class="annot"><span class="annottext">Rewrite
</span><a href="#local-6989586621681880635"><span class="hs-identifier hs-var">norm</span></a></span></span><span> </span><span id="local-6989586621681880636"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621681880636"><span class="hs-identifier hs-var">options</span></a></span></span><span> </span><span id="local-6989586621681880637"><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681880637"><span class="hs-identifier hs-var">ii</span></a></span></span><span> </span><span id="local-6989586621681880638"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681880638"><span class="hs-identifier hs-var">rng</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InteractionId -&gt; TCM [MimerResult] -&gt; TCM [MimerResult]
forall (m :: * -&gt; *) a.
(MonadDebug m, ReadTCState m, MonadError TCErr m, MonadTCEnv m,
 MonadTrace m) =&gt;
InteractionId -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#withInteractionId"><span class="hs-identifier hs-var">withInteractionId</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681880637"><span class="hs-identifier hs-var">ii</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM [MimerResult] -&gt; TCM [MimerResult])
-&gt; TCM [MimerResult] -&gt; TCM [MimerResult]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-746"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681880640"><span class="annot"><a href="#local-6989586621681880640"><span class="hs-identifier hs-var">mTheFunctionQName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880641"><span class="annot"><a href="#local-6989586621681880641"><span class="hs-identifier hs-var">whereNames</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(InteractionPoint -&gt; IPClause)
-&gt; TCMT IO InteractionPoint -&gt; TCMT IO IPClause
forall a b. (a -&gt; b) -&gt; TCMT IO a -&gt; TCMT IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">InteractionPoint -&gt; IPClause
</span><a href="Agda.TypeChecking.Monad.Base.html#ipClause"><span class="hs-identifier hs-var">ipClause</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InteractionId -&gt; TCMT IO InteractionPoint
forall (m :: * -&gt; *).
(ReadTCState m, MonadError TCErr m, MonadTCEnv m) =&gt;
InteractionId -&gt; m InteractionPoint
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#lookupInteractionPoint"><span class="hs-identifier hs-var">lookupInteractionPoint</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681880637"><span class="hs-identifier hs-var">ii</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCMT IO IPClause
-&gt; (IPClause -&gt; (Maybe QName, [QName]))
-&gt; TCMT IO (Maybe QName, [QName])
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-747"></span><span>    </span><span id="local-6989586621681880642"><span class="annot"><span class="annottext">clause :: IPClause
</span><a href="#local-6989586621681880642"><span class="hs-identifier hs-var">clause</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#IPClause"><span class="hs-identifier hs-type">IPClause</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Maybe QName) -&gt; QName -&gt; Maybe QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IPClause -&gt; QName
</span><a href="Agda.TypeChecking.Monad.Base.html#ipcQName"><span class="hs-identifier hs-var">ipcQName</span></a></span><span> </span><span class="annot"><span class="annottext">IPClause
</span><a href="#local-6989586621681880642"><span class="hs-identifier hs-var">clause</span></a></span><span>
</span><span id="line-748"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">WhereDeclarations -&gt; Maybe Declaration
</span><a href="Agda.Syntax.Abstract.html#whereDecls"><span class="hs-identifier hs-var">A.whereDecls</span></a></span><span> </span><span class="annot"><span class="annottext">(WhereDeclarations -&gt; Maybe Declaration)
-&gt; WhereDeclarations -&gt; Maybe Declaration
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Clause' SpineLHS -&gt; WhereDeclarations
forall lhs. Clause' lhs -&gt; WhereDeclarations
</span><a href="Agda.Syntax.Abstract.html#clauseWhereDecls"><span class="hs-identifier hs-var">A.clauseWhereDecls</span></a></span><span> </span><span class="annot"><span class="annottext">(Clause' SpineLHS -&gt; WhereDeclarations)
-&gt; Clause' SpineLHS -&gt; WhereDeclarations
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IPClause -&gt; Clause' SpineLHS
</span><a href="Agda.TypeChecking.Monad.Base.html#ipcClause"><span class="hs-identifier hs-var">ipcClause</span></a></span><span> </span><span class="annot"><span class="annottext">IPClause
</span><a href="#local-6989586621681880642"><span class="hs-identifier hs-var">clause</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-749"></span><span>                             </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681880646"><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621681880646"><span class="hs-identifier hs-var">decl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; [QName]
</span><a href="Agda.Mimer.Mimer.html#declarationQnames"><span class="hs-identifier hs-var">declarationQnames</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621681880646"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-750"></span><span>                             </span><span class="annot"><span class="annottext">Maybe Declaration
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-751"></span><span>                         </span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span>    </span><span class="annot"><span class="annottext">IPClause
</span><a href="Agda.TypeChecking.Monad.Base.html#IPNoClause"><span class="hs-identifier hs-var">IPNoClause</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe QName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-753"></span><span>
</span><span id="line-754"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.init&quot;</span></span><span> </span><span class="annot"><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Interaction point in function:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880640"><span class="hs-identifier hs-type">mTheFunctionQName</span></a></span><span>
</span><span id="line-755"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.init&quot;</span></span><span> </span><span class="annot"><span class="hs-number">25</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Names in where-block&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880641"><span class="hs-identifier hs-type">whereNames</span></a></span><span>
</span><span id="line-756"></span><span>
</span><span id="line-757"></span><span>  </span><span id="local-6989586621681880647"><span class="annot"><a href="#local-6989586621681880647"><span class="hs-identifier hs-var">metaId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html#lookupInteractionId"><span class="hs-identifier hs-type">lookupInteractionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880637"><span class="hs-identifier hs-type">ii</span></a></span><span>
</span><span id="line-758"></span><span>  </span><span id="local-6989586621681880649"><span class="annot"><a href="#local-6989586621681880649"><span class="hs-identifier hs-var">metaVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html#lookupLocalMeta"><span class="hs-identifier hs-type">lookupLocalMeta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880647"><span class="hs-identifier hs-type">metaId</span></a></span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span>  </span><span class="hs-comment">-- We want to be able to solve with recursive calls</span><span>
</span><span id="line-761"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html#setMetaOccursCheck"><span class="hs-identifier hs-type">setMetaOccursCheck</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880647"><span class="hs-identifier hs-type">metaId</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DontRunMetaOccursCheck"><span class="hs-identifier hs-type">DontRunMetaOccursCheck</span></a></span><span>
</span><span id="line-762"></span><span>
</span><span id="line-763"></span><span>  </span><span id="local-6989586621681880652"><span class="annot"><a href="#local-6989586621681880652"><span class="hs-identifier hs-var">metaIds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#mvInstantiation"><span class="hs-identifier hs-var">mvInstantiation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880649"><span class="hs-identifier hs-type">metaVar</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-764"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#InstV"><span class="hs-identifier hs-type">InstV</span></a></span><span> </span><span id="local-6989586621681880653"><span class="annot"><span class="annottext">Instantiation
</span><a href="#local-6989586621681880653"><span class="hs-identifier hs-var">inst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span>      </span><span id="local-6989586621681880654"><span class="annot"><a href="#local-6989586621681880654"><span class="hs-identifier hs-var">metaIds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO [MetaId]
forall t (tcm :: * -&gt; *).
(AllMetas t, ReadTCState tcm) =&gt;
t -&gt; tcm [MetaId]
</span><a href="Agda.Mimer.Mimer.html#allOpenMetas"><span class="hs-identifier hs-var">allOpenMetas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instantiation -&gt; Term
</span><a href="Agda.TypeChecking.Monad.Base.html#instBody"><span class="hs-identifier hs-var">instBody</span></a></span><span> </span><span class="annot"><span class="annottext">Instantiation
</span><a href="#local-6989586621681880653"><span class="hs-identifier hs-var">inst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span>      </span><span class="hs-comment">-- TODO: Make pretty instantiation for 'Instantiation'?</span><span>
</span><span id="line-769"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.init&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Interaction point already instantiated:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#instBody"><span class="hs-identifier hs-var">instBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880653"><span class="hs-identifier hs-type">inst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-770"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;with args&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#instTel"><span class="hs-identifier hs-var">instTel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880653"><span class="hs-identifier hs-type">inst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-771"></span><span>
</span><span id="line-772"></span><span>      </span><span class="hs-comment">-- ctx &lt;- getContextTelescope</span><span>
</span><span id="line-773"></span><span>      </span><span class="hs-comment">-- #7402: still solve the top-level meta, because we don't have the correct contexts for the</span><span>
</span><span id="line-774"></span><span>      </span><span class="hs-comment">--        submetas</span><span>
</span><span id="line-775"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681880647"><span class="hs-identifier hs-type">metaId</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-type">null</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880654"><span class="hs-identifier hs-type">metaIds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-776"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#OpenMeta"><span class="hs-identifier hs-type">OpenMeta</span></a></span><span> </span><span class="annot"><span class="annottext">MetaKind
</span><a href="Agda.Syntax.Info.html#UnificationMeta"><span class="hs-identifier hs-var">UnificationMeta</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-777"></span><span>      </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.init&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;Interaction point not instantiated.&quot;</span></span><span>
</span><span id="line-778"></span><span>      </span><span class="annot"><span class="annottext">[MetaId] -&gt; TCMT IO [MetaId]
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681880647"><span class="hs-identifier hs-var">metaId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-779"></span><span>    </span><span class="annot"><span class="annottext">MetaInstantiation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCMT IO [MetaId]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-780"></span><span>  </span><span class="hs-comment">-- TODO: Print each meta-variable's full context telescope</span><span>
</span><span id="line-781"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.init&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Remaining meta-variables to solve:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880652"><span class="hs-identifier hs-type">metaIds</span></a></span><span>
</span><span id="line-782"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.init&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Meta var args&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html#getMetaContextArgs"><span class="hs-identifier hs-type">getMetaContextArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880649"><span class="hs-identifier hs-type">metaVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span>
</span><span id="line-784"></span><span>
</span><span id="line-785"></span><span>  </span><span id="local-6989586621681880659"><span class="annot"><a href="#local-6989586621681880659"><span class="hs-identifier hs-var">fnArgs1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Options.html#withShowAllArguments%27"><span class="hs-identifier hs-type">withShowAllArguments'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContextArgs"><span class="hs-identifier hs-type">getContextArgs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span>
</span><span id="line-786"></span><span>  </span><span id="local-6989586621681880662"><span class="annot"><a href="#local-6989586621681880662"><span class="hs-identifier hs-var">fnArgs2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Options.html#withShowAllArguments%27"><span class="hs-identifier hs-type">withShowAllArguments'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>  </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContextArgs"><span class="hs-identifier hs-type">getContextArgs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span>
</span><span id="line-787"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880663"><span class="annot"><a href="#local-6989586621681880663"><span class="hs-identifier hs-var hs-var">bringScope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Doc, Doc) -&gt; Doc) -&gt; [(Doc, Doc)] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Doc, Doc) -&gt; Doc
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(Doc, Doc)] -&gt; [Doc]) -&gt; [(Doc, Doc)] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Doc, Doc) -&gt; Bool) -&gt; [(Doc, Doc)] -&gt; [(Doc, Doc)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Doc -&gt; Doc -&gt; Bool) -&gt; (Doc, Doc) -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Doc, Doc)] -&gt; [(Doc, Doc)]) -&gt; [(Doc, Doc)] -&gt; [(Doc, Doc)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; [Doc] -&gt; [(Doc, Doc)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Doc]
</span><a href="#local-6989586621681880659"><span class="hs-identifier hs-var">fnArgs1</span></a></span><span> </span><span class="annot"><span class="annottext">[Doc]
</span><a href="#local-6989586621681880662"><span class="hs-identifier hs-var">fnArgs2</span></a></span><span>
</span><span id="line-788"></span><span>      </span><span id="local-6989586621681880666"><span class="annot"><a href="#local-6989586621681880666"><span class="hs-identifier hs-var hs-var">bringScopeNoBraces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; ArgName) -&gt; [Doc] -&gt; [ArgName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ArgName -&gt; ArgName
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ArgName -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'{'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'}'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; ArgName) -&gt; (Doc -&gt; ArgName) -&gt; Doc -&gt; ArgName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; ArgName
forall a. Doc a -&gt; ArgName
</span><span class="hs-identifier hs-var">P.render</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Doc]
</span><a href="#local-6989586621681880663"><span class="hs-identifier hs-var">bringScope</span></a></span><span>
</span><span id="line-789"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.temp&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-790"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Things to bring into scope:&quot;</span></span><span>
</span><span id="line-791"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-792"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Context args (don't show):&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880659"><span class="hs-identifier hs-type">fnArgs1</span></a></span><span>
</span><span id="line-793"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Context args (show all):  &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880662"><span class="hs-identifier hs-type">fnArgs2</span></a></span><span>
</span><span id="line-794"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;To bring into scope:      &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880663"><span class="hs-identifier hs-type">bringScope</span></a></span><span>
</span><span id="line-795"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;To bring into scope (str):&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880666"><span class="hs-identifier hs-type">bringScopeNoBraces</span></a></span><span>
</span><span id="line-796"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-797"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span>  </span><span class="hs-comment">-- Check if there are any meta-variables to be solved</span><span>
</span><span id="line-800"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681880652"><span class="hs-identifier hs-type">metaIds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-801"></span><span>    </span><span class="hs-comment">-- No variables to solve, return the instantiation given</span><span>
</span><span id="line-802"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-803"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MetaVariable -&gt; MetaInstantiation
</span><a href="Agda.TypeChecking.Monad.Base.html#mvInstantiation"><span class="hs-identifier hs-var">mvInstantiation</span></a></span><span> </span><span class="annot"><span class="annottext">MetaVariable
</span><a href="#local-6989586621681880649"><span class="hs-identifier hs-var">metaVar</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-804"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#InstV"><span class="hs-identifier hs-type">InstV</span></a></span><span> </span><span id="local-6989586621681880669"><span class="annot"><span class="annottext">Instantiation
</span><a href="#local-6989586621681880669"><span class="hs-identifier hs-var">inst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-805"></span><span>          </span><span id="local-6989586621681880670"><span class="annot"><a href="#local-6989586621681880670"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InteractionId -&gt; TCMT IO Expr -&gt; TCMT IO Expr
forall (m :: * -&gt; *) a.
(MonadDebug m, ReadTCState m, MonadError TCErr m, MonadTCEnv m,
 MonadTrace m) =&gt;
InteractionId -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#withInteractionId"><span class="hs-identifier hs-var">withInteractionId</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681880637"><span class="hs-identifier hs-var">ii</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Expr -&gt; TCMT IO Expr) -&gt; TCMT IO Expr -&gt; TCMT IO Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-806"></span><span>            </span><span id="local-6989586621681880671"><span class="annot"><a href="#local-6989586621681880671"><span class="hs-identifier hs-var">metaArgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MetaVariable -&gt; TCMT IO Args
forall (m :: * -&gt; *). MonadTCEnv m =&gt; MetaVariable -&gt; m Args
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#getMetaContextArgs"><span class="hs-identifier hs-var">getMetaContextArgs</span></a></span><span> </span><span class="annot"><span class="annottext">MetaVariable
</span><a href="#local-6989586621681880649"><span class="hs-identifier hs-var">metaVar</span></a></span><span>
</span><span id="line-807"></span><span>            </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#instantiateFull"><span class="hs-identifier hs-type">instantiateFull</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#apply"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880647"><span class="hs-identifier hs-type">metaId</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880671"><span class="hs-identifier hs-type">metaArgs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Agda.Interaction.BasicOps.html#normalForm"><span class="hs-identifier hs-type">normalForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880635"><span class="hs-identifier hs-type">norm</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.InternalToAbstract.html#reify"><span class="hs-identifier hs-type">reify</span></a></span><span>
</span><span id="line-808"></span><span>          </span><span id="local-6989586621681880673"><span class="annot"><a href="#local-6989586621681880673"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.render</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880670"><span class="hs-identifier hs-type">expr</span></a></span><span>
</span><span id="line-809"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880674"><span class="annot"><a href="#local-6989586621681880674"><span class="hs-identifier hs-var hs-var">sol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; MimerResult
</span><a href="Agda.Mimer.Mimer.html#MimerExpr"><span class="hs-identifier hs-var">MimerExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681880673"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-810"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.init&quot;</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Goal already solved. Solution:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880673"><span class="hs-identifier hs-type">str</span></a></span><span>
</span><span id="line-811"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681880674"><span class="hs-identifier hs-type">sol</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-812"></span><span>        </span><span class="annot"><span class="annottext">MetaInstantiation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM [MimerResult]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-813"></span><span>    </span><span class="annot"><span class="annottext">[MetaId]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-814"></span><span>      </span><span id="local-6989586621681880675"><span class="annot"><a href="#local-6989586621681880675"><span class="hs-identifier hs-var">costs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM Bool -&gt; TCMT IO Costs -&gt; TCMT IO Costs -&gt; TCMT IO Costs
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCM Bool
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; m Bool
</span><a href="Agda.TypeChecking.Monad.Debug.html#hasVerbosity"><span class="hs-identifier hs-var">hasVerbosity</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.cost.custom&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span>
</span><span id="line-815"></span><span>                 </span><span class="hs-comment">{- then -}</span><span> </span><span class="annot"><span class="annottext">TCMT IO Costs
</span><a href="Agda.Mimer.Mimer.html#customCosts"><span class="hs-identifier hs-var">customCosts</span></a></span><span>
</span><span id="line-816"></span><span>                 </span><span class="hs-comment">{- else -}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Costs -&gt; TCMT IO Costs
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="Agda.Mimer.Mimer.html#defaultCosts"><span class="hs-identifier hs-var">defaultCosts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-817"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.cost.custom&quot;</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Using costs:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880675"><span class="hs-identifier hs-type">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-818"></span><span>      </span><span id="local-6989586621681880678"><span class="annot"><a href="#local-6989586621681880678"><span class="hs-identifier hs-var">components</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#collectComponents"><span class="hs-identifier hs-type">collectComponents</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880636"><span class="hs-identifier hs-type">options</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880675"><span class="hs-identifier hs-type">costs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880637"><span class="hs-identifier hs-type">ii</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880640"><span class="hs-identifier hs-type">mTheFunctionQName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880641"><span class="hs-identifier hs-type">whereNames</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880647"><span class="hs-identifier hs-type">metaId</span></a></span><span>
</span><span id="line-819"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880679"><span class="annot"><a href="#local-6989586621681880679"><span class="hs-identifier hs-var hs-var">startGoals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MetaId -&gt; Goal) -&gt; [MetaId] -&gt; [Goal]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Goal
</span><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-var">Goal</span></a></span><span> </span><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621681880652"><span class="hs-identifier hs-var">metaIds</span></a></span><span>
</span><span id="line-820"></span><span>
</span><span id="line-821"></span><span>      </span><span id="local-6989586621681880680"><span class="annot"><a href="#local-6989586621681880680"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#getTC"><span class="hs-identifier hs-type">getTC</span></a></span><span>
</span><span id="line-822"></span><span>      </span><span id="local-6989586621681880682"><span class="annot"><a href="#local-6989586621681880682"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#askTC"><span class="hs-identifier hs-type">askTC</span></a></span><span>
</span><span id="line-823"></span><span>
</span><span id="line-824"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880684"><span class="annot"><a href="#local-6989586621681880684"><span class="hs-identifier hs-var hs-var">startBranch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span>
</span><span id="line-825"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sbTCState :: TCState
</span><a href="Agda.Mimer.Mimer.html#sbTCState"><span class="hs-identifier hs-var">sbTCState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681880680"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-826"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sbGoals :: [Goal]
</span><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Goal]
</span><a href="#local-6989586621681880679"><span class="hs-identifier hs-var">startGoals</span></a></span><span>
</span><span id="line-827"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sbCost :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#sbCost"><span class="hs-identifier hs-var">sbCost</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-828"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sbCache :: Map CheckpointId ComponentCache
</span><a href="Agda.Mimer.Mimer.html#sbCache"><span class="hs-identifier hs-var">sbCache</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map CheckpointId ComponentCache
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-829"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sbComponentsUsed :: Map Name VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#sbComponentsUsed"><span class="hs-identifier hs-var">sbComponentsUsed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name VerboseLevel
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-830"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-831"></span><span>
</span><span id="line-832"></span><span>      </span><span id="local-6989586621681880686"><span class="annot"><a href="#local-6989586621681880686"><span class="hs-identifier hs-var">statsRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">newIORef</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#emptyMimerStats"><span class="hs-identifier hs-type">emptyMimerStats</span></a></span><span>
</span><span id="line-833"></span><span>      </span><span id="local-6989586621681880687"><span class="annot"><a href="#local-6989586621681880687"><span class="hs-identifier hs-var">checkpoint</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#viewTC"><span class="hs-identifier hs-type">viewTC</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#eCurrentCheckpoint"><span class="hs-identifier hs-type">eCurrentCheckpoint</span></a></span><span>
</span><span id="line-834"></span><span>      </span><span id="local-6989586621681880692"><span class="annot"><a href="#local-6989586621681880692"><span class="hs-identifier hs-var">mflat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-type">getBuiltinName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Builtin.html#BuiltinFlat"><span class="hs-identifier hs-type">BuiltinFlat</span></a></span><span>
</span><span id="line-835"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880694"><span class="annot"><a href="#local-6989586621681880694"><span class="hs-identifier hs-var hs-var">searchOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchOptions"><span class="hs-identifier hs-type">SearchOptions</span></a></span><span>
</span><span id="line-836"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">searchBaseComponents :: BaseComponents
</span><a href="Agda.Mimer.Mimer.html#searchBaseComponents"><span class="hs-identifier hs-var">searchBaseComponents</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681880678"><span class="hs-identifier hs-var">components</span></a></span><span>
</span><span id="line-837"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchHintMode :: HintMode
</span><a href="Agda.Mimer.Mimer.html#searchHintMode"><span class="hs-identifier hs-var">searchHintMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; HintMode
</span><a href="Agda.Mimer.Options.html#optHintMode"><span class="hs-identifier hs-var">optHintMode</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621681880636"><span class="hs-identifier hs-var">options</span></a></span><span>
</span><span id="line-838"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchTimeout :: Integer
</span><a href="Agda.Mimer.Mimer.html#searchTimeout"><span class="hs-identifier hs-var">searchTimeout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Integer
</span><a href="Agda.Mimer.Options.html#optTimeout"><span class="hs-identifier hs-var">optTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621681880636"><span class="hs-identifier hs-var">options</span></a></span><span>
</span><span id="line-839"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchGenProjectionsLocal :: Bool
</span><a href="Agda.Mimer.Mimer.html#searchGenProjectionsLocal"><span class="hs-identifier hs-var">searchGenProjectionsLocal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-840"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchGenProjectionsLet :: Bool
</span><a href="Agda.Mimer.Mimer.html#searchGenProjectionsLet"><span class="hs-identifier hs-var">searchGenProjectionsLet</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-841"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchGenProjectionsExternal :: Bool
</span><a href="Agda.Mimer.Mimer.html#searchGenProjectionsExternal"><span class="hs-identifier hs-var">searchGenProjectionsExternal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-842"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchGenProjectionsRec :: Bool
</span><a href="Agda.Mimer.Mimer.html#searchGenProjectionsRec"><span class="hs-identifier hs-var">searchGenProjectionsRec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-843"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchSpeculateProjections :: Bool
</span><a href="Agda.Mimer.Mimer.html#searchSpeculateProjections"><span class="hs-identifier hs-var">searchSpeculateProjections</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-844"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchTopMeta :: MetaId
</span><a href="Agda.Mimer.Mimer.html#searchTopMeta"><span class="hs-identifier hs-var">searchTopMeta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681880647"><span class="hs-identifier hs-var">metaId</span></a></span><span>
</span><span id="line-845"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchTopEnv :: TCEnv
</span><a href="Agda.Mimer.Mimer.html#searchTopEnv"><span class="hs-identifier hs-var">searchTopEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCEnv
</span><a href="#local-6989586621681880682"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-846"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchTopCheckpoint :: CheckpointId
</span><a href="Agda.Mimer.Mimer.html#searchTopCheckpoint"><span class="hs-identifier hs-var">searchTopCheckpoint</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CheckpointId
</span><a href="#local-6989586621681880687"><span class="hs-identifier hs-var">checkpoint</span></a></span><span>
</span><span id="line-847"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchInteractionId :: InteractionId
</span><a href="Agda.Mimer.Mimer.html#searchInteractionId"><span class="hs-identifier hs-var">searchInteractionId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681880637"><span class="hs-identifier hs-var">ii</span></a></span><span>
</span><span id="line-848"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchFnName :: Maybe QName
</span><a href="Agda.Mimer.Mimer.html#searchFnName"><span class="hs-identifier hs-var">searchFnName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681880640"><span class="hs-identifier hs-var">mTheFunctionQName</span></a></span><span>
</span><span id="line-849"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchCosts :: Costs
</span><a href="Agda.Mimer.Mimer.html#searchCosts"><span class="hs-identifier hs-var">searchCosts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681880675"><span class="hs-identifier hs-var">costs</span></a></span><span>
</span><span id="line-850"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchStats :: IORef MimerStats
</span><a href="Agda.Mimer.Mimer.html#searchStats"><span class="hs-identifier hs-var">searchStats</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IORef MimerStats
</span><a href="#local-6989586621681880686"><span class="hs-identifier hs-var">statsRef</span></a></span><span>
</span><span id="line-851"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchRewrite :: Rewrite
</span><a href="Agda.Mimer.Mimer.html#searchRewrite"><span class="hs-identifier hs-var">searchRewrite</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rewrite
</span><a href="#local-6989586621681880635"><span class="hs-identifier hs-var">norm</span></a></span><span>
</span><span id="line-852"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchBuiltinFlat :: Maybe QName
</span><a href="Agda.Mimer.Mimer.html#searchBuiltinFlat"><span class="hs-identifier hs-var">searchBuiltinFlat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681880692"><span class="hs-identifier hs-var">mflat</span></a></span><span>
</span><span id="line-853"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-854"></span><span>
</span><span id="line-855"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.init&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Using search options:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880694"><span class="hs-identifier hs-type">searchOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-856"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.init&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Initial search branch:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880684"><span class="hs-identifier hs-type">startBranch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">flip</span></span><span> </span><span class="annot"><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621681880694"><span class="hs-identifier hs-type">searchOptions</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#bench"><span class="hs-identifier hs-type">bench</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span>        </span><span class="hs-comment">-- TODO: Check what timing stuff is used in Agda.Utils.Time</span><span>
</span><span id="line-861"></span><span>        </span><span id="local-6989586621681880698"><span class="annot"><a href="#local-6989586621681880698"><span class="hs-identifier hs-var">timeout</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Utils.Time.html#fromMilliseconds"><span class="hs-identifier hs-type">fromMilliseconds</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">asks</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#searchTimeout"><span class="hs-identifier hs-var">searchTimeout</span></a></span><span>
</span><span id="line-862"></span><span>        </span><span id="local-6989586621681880699"><span class="annot"><a href="#local-6989586621681880699"><span class="hs-identifier hs-var">startTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><a href="Agda.Utils.Time.html#getCPUTime"><span class="hs-identifier hs-type">getCPUTime</span></a></span><span>
</span><span id="line-863"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621681880700"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MinQueue</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerResult"><span class="hs-identifier hs-type">MimerResult</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-864"></span><span>            </span><span id="local-6989586621681880700"><span class="annot"><a href="#local-6989586621681880700"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621681880701"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880701"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">MinQueue SearchBranch
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([MimerResult], VerboseLevel) -&gt; SM ([MimerResult], VerboseLevel)
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880701"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-865"></span><span>            </span><span class="annot"><a href="#local-6989586621681880700"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681880702"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880702"><span class="hs-identifier hs-var">need</span></a></span></span><span> </span><span id="local-6989586621681880703"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880703"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681880704"><span class="annot"><span class="annottext">MinQueue SearchBranch
</span><a href="#local-6989586621681880704"><span class="hs-identifier hs-var">branchQueue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MinQueue SearchBranch
-&gt; Maybe (SearchBranch, MinQueue SearchBranch)
forall a. Ord a =&gt; MinQueue a -&gt; Maybe (a, MinQueue a)
</span><span class="hs-identifier hs-var">Q.minView</span></span><span> </span><span class="annot"><span class="annottext">MinQueue SearchBranch
</span><a href="#local-6989586621681880704"><span class="hs-identifier hs-var">branchQueue</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-866"></span><span>              </span><span class="annot"><span class="annottext">Maybe (SearchBranch, MinQueue SearchBranch)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-867"></span><span>                </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel -&gt; ArgName -&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.search&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; ArgName -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;No remaining search branches.&quot;</span></span><span>
</span><span id="line-868"></span><span>                </span><span class="annot"><span class="annottext">([MimerResult], VerboseLevel) -&gt; SM ([MimerResult], VerboseLevel)
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880703"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-869"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880706"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880706"><span class="hs-identifier hs-var">branch</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880707"><span class="annot"><span class="annottext">MinQueue SearchBranch
</span><a href="#local-6989586621681880707"><span class="hs-identifier hs-var">branchQueue'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-870"></span><span>                </span><span id="local-6989586621681880708"><span class="annot"><a href="#local-6989586621681880708"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO CPUTime -&gt; ReaderT SearchOptions (TCMT IO) CPUTime
forall a. IO a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO CPUTime
forall (m :: * -&gt; *). MonadIO m =&gt; m CPUTime
</span><a href="Agda.Utils.Time.html#getCPUTime"><span class="hs-identifier hs-var">getCPUTime</span></a></span><span>
</span><span id="line-871"></span><span>                </span><span class="annot"><a href="Agda.Mimer.Mimer.html#mimerTrace"><span class="hs-identifier hs-type">mimerTrace</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-872"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Choosing branch&quot;</span></span><span>
</span><span id="line-873"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span>
</span><span id="line-874"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#branchInstantiationDocCost"><span class="hs-identifier hs-type">branchInstantiationDocCost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880706"><span class="hs-identifier hs-type">branch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;,&quot;</span></span><span>
</span><span id="line-875"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;metas:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880706"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-876"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-877"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-878"></span><span>                </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.search&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Full branch:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880706"><span class="hs-identifier hs-type">branch</span></a></span><span>
</span><span id="line-879"></span><span>                </span><span class="annot"><a href="Agda.Mimer.Mimer.html#reportSMDoc"><span class="hs-identifier hs-type">reportSMDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.search&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-880"></span><span>                  </span><span class="annot"><span class="hs-string">&quot;Instantiation of other branches:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyList"><span class="hs-identifier hs-type">prettyList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#branchInstantiationDocCost"><span class="hs-identifier hs-type">branchInstantiationDocCost</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q.toAscList</span></span><span> </span><span class="annot"><a href="#local-6989586621681880707"><span class="hs-identifier hs-type">branchQueue'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-881"></span><span>
</span><span id="line-882"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880713"><span class="annot"><a href="#local-6989586621681880713"><span class="hs-identifier hs-var hs-var">elapsed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CPUTime
</span><a href="#local-6989586621681880708"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">CPUTime -&gt; CPUTime -&gt; CPUTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">CPUTime
</span><a href="#local-6989586621681880699"><span class="hs-identifier hs-var">startTime</span></a></span><span>
</span><span id="line-883"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621681880713"><span class="hs-identifier hs-type">elapsed</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;</span></span><span> </span><span class="annot"><a href="#local-6989586621681880698"><span class="hs-identifier hs-type">timeout</span></a></span><span>
</span><span id="line-884"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-885"></span><span>                  </span><span class="hs-special">(</span><span id="local-6989586621681880715"><span class="annot"><a href="#local-6989586621681880715"><span class="hs-identifier hs-var">newBranches</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880716"><span class="annot"><a href="#local-6989586621681880716"><span class="hs-identifier hs-var">sols</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#refine"><span class="hs-identifier hs-type">refine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880706"><span class="hs-identifier hs-type">branch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#partitionStepResult"><span class="hs-identifier hs-type">partitionStepResult</span></a></span><span>
</span><span id="line-886"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880719"><span class="annot"><a href="#local-6989586621681880719"><span class="hs-identifier hs-var hs-var">branchQueue''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SearchBranch -&gt; MinQueue SearchBranch -&gt; MinQueue SearchBranch)
-&gt; MinQueue SearchBranch -&gt; [SearchBranch] -&gt; MinQueue SearchBranch
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; MinQueue SearchBranch -&gt; MinQueue SearchBranch
forall a. Ord a =&gt; a -&gt; MinQueue a -&gt; MinQueue a
</span><span class="hs-identifier hs-var">Q.insert</span></span><span> </span><span class="annot"><span class="annottext">MinQueue SearchBranch
</span><a href="#local-6989586621681880707"><span class="hs-identifier hs-var">branchQueue'</span></a></span><span> </span><span class="annot"><span class="annottext">[SearchBranch]
</span><a href="#local-6989586621681880715"><span class="hs-identifier hs-var">newBranches</span></a></span><span>
</span><span id="line-887"></span><span>                  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-type">reportSLn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.search&quot;</span></span><span> </span><span class="annot"><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">length</span></span><span> </span><span class="annot"><a href="#local-6989586621681880716"><span class="hs-identifier hs-type">sols</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; solutions found during cycle &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880703"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>                  </span><span class="annot"><a href="Agda.Mimer.Mimer.html#reportSMDoc"><span class="hs-identifier hs-type">reportSMDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.search&quot;</span></span><span> </span><span class="annot"><span class="hs-number">45</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Solutions:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880716"><span class="hs-identifier hs-type">sols</span></a></span><span>
</span><span id="line-889"></span><span>                  </span><span class="annot"><a href="Agda.Mimer.Mimer.html#mimerTrace"><span class="hs-identifier hs-type">mimerTrace</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-890"></span><span>                     </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Cycle&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880703"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;branches&quot;</span></span><span>
</span><span id="line-891"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#branchInstantiationDocCost"><span class="hs-identifier hs-type">branchInstantiationDocCost</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q.toAscList</span></span><span> </span><span class="annot"><a href="#local-6989586621681880719"><span class="hs-identifier hs-type">branchQueue''</span></a></span><span>
</span><span id="line-892"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-893"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-type">null</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880716"><span class="hs-identifier hs-type">sols</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#mimerTrace"><span class="hs-identifier hs-type">mimerTrace</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-894"></span><span>                     </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Cycle&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880703"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;solutions&quot;</span></span><span>
</span><span id="line-895"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880716"><span class="hs-identifier hs-type">sols</span></a></span><span>
</span><span id="line-896"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-897"></span><span>
</span><span id="line-898"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880723"><span class="annot"><a href="#local-6989586621681880723"><span class="hs-identifier hs-var hs-var">sols'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; [MimerResult] -&gt; [MimerResult]
forall a. VerboseLevel -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880702"><span class="hs-identifier hs-var">need</span></a></span><span> </span><span class="annot"><span class="annottext">[MimerResult]
</span><a href="#local-6989586621681880716"><span class="hs-identifier hs-var">sols</span></a></span><span>
</span><span id="line-899"></span><span>                  </span><span class="annot"><a href="Agda.Utils.Tuple.html#mapFst"><span class="hs-identifier hs-type">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sols'</span></span><span> </span><span class="annot"><span class="hs-operator">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621681880700"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880702"><span class="hs-identifier hs-type">need</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">length</span></span><span> </span><span class="annot"><a href="#local-6989586621681880723"><span class="hs-identifier hs-type">sols'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880703"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880719"><span class="hs-identifier hs-type">branchQueue''</span></a></span><span>
</span><span id="line-900"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-901"></span><span>                  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-type">reportSLn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.search&quot;</span></span><span> </span><span class="annot"><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Search time limit reached. Elapsed search time: &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621681880713"><span class="hs-identifier hs-type">elapsed</span></a></span><span>
</span><span id="line-902"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681880703"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-903"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880725"><span class="annot"><a href="#local-6989586621681880725"><span class="hs-identifier hs-var hs-var">numSolutions</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Bool
</span><a href="Agda.Mimer.Options.html#optList"><span class="hs-identifier hs-var">optList</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621681880636"><span class="hs-identifier hs-var">options</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Options -&gt; VerboseLevel
</span><a href="Agda.Mimer.Options.html#optSkip"><span class="hs-identifier hs-var">optSkip</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621681880636"><span class="hs-identifier hs-var">options</span></a></span><span>
</span><span id="line-904"></span><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Options -&gt; VerboseLevel
</span><a href="Agda.Mimer.Options.html#optSkip"><span class="hs-identifier hs-var">optSkip</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621681880636"><span class="hs-identifier hs-var">options</span></a></span><span>
</span><span id="line-905"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681880726"><span class="annot"><a href="#local-6989586621681880726"><span class="hs-identifier hs-var">sols</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880727"><span class="annot"><a href="#local-6989586621681880727"><span class="hs-identifier hs-var">nrSteps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681880700"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880725"><span class="hs-identifier hs-type">numSolutions</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q.singleton</span></span><span> </span><span class="annot"><a href="#local-6989586621681880684"><span class="hs-identifier hs-type">startBranch</span></a></span><span>
</span><span id="line-906"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-type">reportSLn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.search&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Search ended after &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880727"><span class="hs-identifier hs-type">nrSteps</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; cycles&quot;</span></span><span>
</span><span id="line-907"></span><span>        </span><span class="hs-comment">-- results &lt;- liftTCM $ mapM exprToStringAndVars sols</span><span>
</span><span id="line-908"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.search&quot;</span></span><span> </span><span class="annot"><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Solutions found: &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyList"><span class="hs-identifier hs-type">prettyList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880726"><span class="hs-identifier hs-type">sols</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span>        </span><span class="annot"><a href="Agda.Mimer.Mimer.html#reportSMDoc"><span class="hs-identifier hs-type">reportSMDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.stats&quot;</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-910"></span><span>          </span><span id="local-6989586621681880729"><span class="annot"><a href="#local-6989586621681880729"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">asks</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#searchStats"><span class="hs-identifier hs-var">searchStats</span></a></span><span>
</span><span id="line-911"></span><span>          </span><span id="local-6989586621681880730"><span class="annot"><a href="#local-6989586621681880730"><span class="hs-identifier hs-var">stats</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">readIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621681880729"><span class="hs-identifier hs-type">ref</span></a></span><span>
</span><span id="line-912"></span><span>          </span><span class="annot"><span class="hs-string">&quot;Statistics:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621681880730"><span class="hs-identifier hs-type">stats</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-913"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621681880726"><span class="hs-identifier hs-type">sols</span></a></span><span>
</span><span id="line-914"></span><span>
</span><span id="line-915"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryComponents"><span class="hs-identifier hs-type">tryComponents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-916"></span><span id="tryComponents"><span class="annot"><span class="annottext">tryComponents :: Goal
-&gt; Type
-&gt; SearchBranch
-&gt; [(Component, [Component])]
-&gt; SM [SearchStepResult]
</span><a href="Agda.Mimer.Mimer.html#tryComponents"><span class="hs-identifier hs-var hs-var">tryComponents</span></a></span></span><span> </span><span id="local-6989586621681880732"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880732"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span id="local-6989586621681880733"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880733"><span class="hs-identifier hs-var">goalType</span></a></span></span><span> </span><span id="local-6989586621681880734"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880734"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span id="local-6989586621681880735"><span class="annot"><span class="annottext">[(Component, [Component])]
</span><a href="#local-6989586621681880735"><span class="hs-identifier hs-var">comps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch
-&gt; Goal -&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a. SearchBranch -&gt; Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-var">withBranchAndGoal</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880734"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880732"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">(SM [SearchStepResult] -&gt; SM [SearchStepResult])
-&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-917"></span><span>  </span><span id="local-6989586621681880736"><span class="annot"><a href="#local-6989586621681880736"><span class="hs-identifier hs-var">checkpoint</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Lens' TCEnv CheckpointId
-&gt; ReaderT SearchOptions (TCMT IO) CheckpointId
forall (m :: * -&gt; *) a. MonadTCEnv m =&gt; Lens' TCEnv a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#viewTC"><span class="hs-identifier hs-var">viewTC</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckpointId -&gt; f CheckpointId) -&gt; TCEnv -&gt; f TCEnv
Lens' TCEnv CheckpointId
</span><a href="Agda.TypeChecking.Monad.Base.html#eCurrentCheckpoint"><span class="hs-identifier hs-var">eCurrentCheckpoint</span></a></span><span>
</span><span id="line-918"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880739"><span class="annot"><a href="#local-6989586621681880739"><span class="hs-identifier hs-var hs-var">tryFor</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880740"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880740"><span class="hs-identifier hs-var">sourceComp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880741"><span class="annot"><span class="annottext">[Component]
</span><a href="#local-6989586621681880741"><span class="hs-identifier hs-var">comps'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-919"></span><span>        </span><span class="hs-comment">-- Clear out components that depend on meta-variables that have been used.</span><span>
</span><span id="line-920"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880742"><span class="annot"><span class="annottext">newCache :: ComponentCache
</span><a href="#local-6989586621681880742"><span class="hs-identifier hs-var hs-var hs-var">newCache</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Component -&gt; Maybe [Component] -&gt; ComponentCache -&gt; ComponentCache
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880740"><span class="hs-identifier hs-var">sourceComp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [Component]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SearchBranch -&gt; Map CheckpointId ComponentCache
</span><a href="Agda.Mimer.Mimer.html#sbCache"><span class="hs-identifier hs-var">sbCache</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880734"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">Map CheckpointId ComponentCache -&gt; CheckpointId -&gt; ComponentCache
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">CheckpointId
</span><a href="#local-6989586621681880736"><span class="hs-identifier hs-var">checkpoint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-921"></span><span>        </span><span id="local-6989586621681880745"><span class="annot"><a href="#local-6989586621681880745"><span class="hs-identifier hs-var">newBranches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Maybe SearchBranch] -&gt; [SearchBranch]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe SearchBranch] -&gt; [SearchBranch])
-&gt; ReaderT SearchOptions (TCMT IO) [Maybe SearchBranch]
-&gt; ReaderT SearchOptions (TCMT IO) [SearchBranch]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Component -&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch))
-&gt; [Component]
-&gt; ReaderT SearchOptions (TCMT IO) [Maybe SearchBranch]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Goal
-&gt; Type
-&gt; SearchBranch
-&gt; Component
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
</span><a href="Agda.Mimer.Mimer.html#tryRefineWith"><span class="hs-identifier hs-var">tryRefineWith</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880732"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880733"><span class="hs-identifier hs-var">goalType</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880734"><span class="hs-identifier hs-var">branch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Component]
</span><a href="#local-6989586621681880741"><span class="hs-identifier hs-var">comps'</span></a></span><span>
</span><span id="line-922"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681880747"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880747"><span class="hs-identifier hs-var">br</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880747"><span class="hs-identifier hs-var">br</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbCache"><span class="hs-identifier hs-var">sbCache</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.insert</span></span><span> </span><span class="annot"><a href="#local-6989586621681880736"><span class="hs-identifier hs-type">checkpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880742"><span class="hs-identifier hs-type">newCache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbCache"><span class="hs-identifier hs-var">sbCache</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880734"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880745"><span class="hs-identifier hs-type">newBranches</span></a></span><span>
</span><span id="line-923"></span><span>  </span><span id="local-6989586621681880748"><span class="annot"><a href="#local-6989586621681880748"><span class="hs-identifier hs-var">newBranches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#concatMapM"><span class="hs-identifier hs-type">concatMapM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880739"><span class="hs-identifier hs-type">tryFor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880735"><span class="hs-identifier hs-type">comps</span></a></span><span>
</span><span id="line-924"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#checkSolved"><span class="hs-identifier hs-type">checkSolved</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880748"><span class="hs-identifier hs-type">newBranches</span></a></span><span>
</span><span id="line-925"></span><span>
</span><span id="line-926"></span><span class="hs-comment">-- | If there is no cache entry for the checkpoint, create one. If there already</span><span>
</span><span id="line-927"></span><span class="hs-comment">-- is one, even if the components are not yet generated for some entries, it is</span><span>
</span><span id="line-928"></span><span class="hs-comment">-- returned as is.</span><span>
</span><span id="line-929"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#prepareComponents"><span class="hs-identifier hs-type">prepareComponents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-930"></span><span id="prepareComponents"><span class="annot"><span class="annottext">prepareComponents :: Goal
-&gt; SearchBranch -&gt; SM (SearchBranch, [(Component, [Component])])
</span><a href="Agda.Mimer.Mimer.html#prepareComponents"><span class="hs-identifier hs-var hs-var">prepareComponents</span></a></span></span><span> </span><span id="local-6989586621681880752"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880752"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span id="local-6989586621681880753"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880753"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch
-&gt; Goal
-&gt; SM (SearchBranch, [(Component, [Component])])
-&gt; SM (SearchBranch, [(Component, [Component])])
forall a. SearchBranch -&gt; Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-var">withBranchAndGoal</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880753"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880752"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">(SM (SearchBranch, [(Component, [Component])])
 -&gt; SM (SearchBranch, [(Component, [Component])]))
-&gt; SM (SearchBranch, [(Component, [Component])])
-&gt; SM (SearchBranch, [(Component, [Component])])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-931"></span><span>  </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.components&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Preparing components for goal&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; MetaId -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Goal -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880752"><span class="hs-identifier hs-var">goal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-932"></span><span>  </span><span id="local-6989586621681880754"><span class="annot"><a href="#local-6989586621681880754"><span class="hs-identifier hs-var">checkpoint</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Lens' TCEnv CheckpointId
-&gt; ReaderT SearchOptions (TCMT IO) CheckpointId
forall (m :: * -&gt; *) a. MonadTCEnv m =&gt; Lens' TCEnv a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#viewTC"><span class="hs-identifier hs-var">viewTC</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckpointId -&gt; f CheckpointId) -&gt; TCEnv -&gt; f TCEnv
Lens' TCEnv CheckpointId
</span><a href="Agda.TypeChecking.Monad.Base.html#eCurrentCheckpoint"><span class="hs-identifier hs-var">eCurrentCheckpoint</span></a></span><span>
</span><span id="line-933"></span><span>  </span><span class="hs-comment">-- Check if we there is something in the cache for this checkpoint</span><span>
</span><span id="line-934"></span><span>  </span><span id="local-6989586621681880757"><span class="annot"><a href="#local-6989586621681880757"><span class="hs-identifier hs-var">comps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.lookup</span></span><span> </span><span class="annot"><a href="#local-6989586621681880754"><span class="hs-identifier hs-type">checkpoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbCache"><span class="hs-identifier hs-var">sbCache</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880753"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-935"></span><span>    </span><span class="hs-comment">-- No, generate components from scratch</span><span>
</span><span id="line-936"></span><span>    </span><span class="annot"><span class="annottext">Maybe ComponentCache
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-937"></span><span>      </span><span class="annot"><span class="annottext">(MimerStats -&gt; MimerStats) -&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#updateStat"><span class="hs-identifier hs-var">updateStat</span></a></span><span> </span><span class="annot"><span class="annottext">MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incCompRegen"><span class="hs-identifier hs-var">incCompRegen</span></a></span><span>
</span><span id="line-938"></span><span>      </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.components&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-939"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;No cache found checkpoint:&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointId -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointId
</span><a href="#local-6989586621681880754"><span class="hs-identifier hs-var">checkpoint</span></a></span><span>
</span><span id="line-940"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;with context:&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc
forall (tcm :: * -&gt; *) a.
(MonadTCEnv tcm, ReadTCState tcm) =&gt;
tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-var">inTopContext</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc)
-&gt; (Telescope -&gt; TCMT IO Doc) -&gt; Telescope -&gt; TCMT IO Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; TCMT IO Doc) -&gt; TCMT IO Telescope -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Telescope
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m Telescope
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-var">getContextTelescope</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-941"></span><span>      </span><span class="hs-comment">-- Generate components for this context</span><span>
</span><span id="line-942"></span><span>      </span><span id="local-6989586621681880760"><span class="annot"><a href="#local-6989586621681880760"><span class="hs-identifier hs-var">comps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) [(Component, [Component])]
</span><a href="Agda.Mimer.Mimer.html#genComponents"><span class="hs-identifier hs-var">genComponents</span></a></span><span>
</span><span id="line-943"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.components&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Generated&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">sum</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">length</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880760"><span class="hs-identifier hs-type">comps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;components&quot;</span></span><span>
</span><span id="line-944"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621681880760"><span class="hs-identifier hs-type">comps</span></a></span><span>
</span><span id="line-945"></span><span>    </span><span class="hs-comment">-- Yes, just update the missing generated components</span><span>
</span><span id="line-946"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681880763"><span class="annot"><span class="annottext">ComponentCache
</span><a href="#local-6989586621681880763"><span class="hs-identifier hs-var">cache</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Component, Maybe [Component])
 -&gt; ReaderT SearchOptions (TCMT IO) (Component, [Component]))
-&gt; [(Component, Maybe [Component])]
-&gt; ReaderT SearchOptions (TCMT IO) [(Component, [Component])]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(Component, Maybe [Component])
-&gt; ReaderT SearchOptions (TCMT IO) (Component, [Component])
</span><a href="#local-6989586621681880764"><span class="hs-identifier hs-var">prepare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentCache -&gt; [(Component, Maybe [Component])]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toAscList</span></span><span> </span><span class="annot"><span class="annottext">ComponentCache
</span><a href="#local-6989586621681880763"><span class="hs-identifier hs-var">cache</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-947"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880765"><span class="annot"><a href="#local-6989586621681880765"><span class="hs-identifier hs-var hs-var">newCache</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Component, Maybe [Component])] -&gt; ComponentCache
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Component, Maybe [Component])] -&gt; ComponentCache)
-&gt; [(Component, Maybe [Component])] -&gt; ComponentCache
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Component, [Component]) -&gt; (Component, Maybe [Component]))
-&gt; [(Component, [Component])] -&gt; [(Component, Maybe [Component])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Component] -&gt; Maybe [Component])
-&gt; (Component, [Component]) -&gt; (Component, Maybe [Component])
forall b d a. (b -&gt; d) -&gt; (a, b) -&gt; (a, d)
</span><a href="Agda.Utils.Tuple.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a></span><span> </span><span class="annot"><span class="annottext">[Component] -&gt; Maybe [Component]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Component, [Component])]
</span><a href="#local-6989586621681880757"><span class="hs-identifier hs-var">comps</span></a></span><span>
</span><span id="line-948"></span><span>  </span><span id="local-6989586621681880767"><span class="annot"><a href="#local-6989586621681880767"><span class="hs-identifier hs-var">branch'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#updateBranch"><span class="hs-identifier hs-type">updateBranch</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621681880753"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbCache"><span class="hs-identifier hs-var">sbCache</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.insert</span></span><span> </span><span class="annot"><a href="#local-6989586621681880754"><span class="hs-identifier hs-type">checkpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880765"><span class="hs-identifier hs-type">newCache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbCache"><span class="hs-identifier hs-var">sbCache</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880753"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-949"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880767"><span class="hs-identifier hs-type">branch'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681880757"><span class="hs-identifier hs-type">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-950"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-951"></span><span>  </span><span class="annot"><a href="#local-6989586621681880764"><span class="hs-identifier hs-type">prepare</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-952"></span><span>  </span><span id="local-6989586621681880764"><span class="annot"><span class="annottext">prepare :: (Component, Maybe [Component])
-&gt; ReaderT SearchOptions (TCMT IO) (Component, [Component])
</span><a href="#local-6989586621681880764"><span class="hs-identifier hs-var hs-var">prepare</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880769"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880769"><span class="hs-identifier hs-var">sourceComp</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681880770"><span class="annot"><span class="annottext">[Component]
</span><a href="#local-6989586621681880770"><span class="hs-identifier hs-var">comps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-953"></span><span>    </span><span class="annot"><span class="annottext">(MimerStats -&gt; MimerStats) -&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#updateStat"><span class="hs-identifier hs-var">updateStat</span></a></span><span> </span><span class="annot"><span class="annottext">MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incCompNoRegen"><span class="hs-identifier hs-var">incCompNoRegen</span></a></span><span>
</span><span id="line-954"></span><span>    </span><span class="annot"><span class="annottext">(Component, [Component])
-&gt; ReaderT SearchOptions (TCMT IO) (Component, [Component])
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880769"><span class="hs-identifier hs-var">sourceComp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Component]
</span><a href="#local-6989586621681880770"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-955"></span><span>  </span><span class="annot"><a href="#local-6989586621681880764"><span class="hs-identifier hs-var">prepare</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880771"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880771"><span class="hs-identifier hs-var">sourceComp</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe [Component]
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-956"></span><span>    </span><span class="annot"><span class="annottext">(MimerStats -&gt; MimerStats) -&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#updateStat"><span class="hs-identifier hs-var">updateStat</span></a></span><span> </span><span class="annot"><span class="annottext">MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incCompRegen"><span class="hs-identifier hs-var">incCompRegen</span></a></span><span>
</span><span id="line-957"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880771"><span class="hs-identifier hs-var">sourceComp</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Component] -&gt; (Component, [Component]))
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
-&gt; ReaderT SearchOptions (TCMT IO) (Component, [Component])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Component -&gt; ReaderT SearchOptions (TCMT IO) [Component]
</span><a href="Agda.Mimer.Mimer.html#genComponentsFrom"><span class="hs-identifier hs-var">genComponentsFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880771"><span class="hs-identifier hs-var">sourceComp</span></a></span><span>
</span><span id="line-958"></span><span>
</span><span id="line-959"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#localVarCount"><span class="hs-identifier hs-type">localVarCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-960"></span><span id="localVarCount"><span class="annot"><span class="annottext">localVarCount :: SM VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#localVarCount"><span class="hs-identifier hs-var hs-var">localVarCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-961"></span><span>  </span><span id="local-6989586621681880774"><span class="annot"><a href="#local-6989586621681880774"><span class="hs-identifier hs-var">top</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; VerboseLevel) -&gt; SM VerboseLevel
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">((SearchOptions -&gt; VerboseLevel) -&gt; SM VerboseLevel)
-&gt; (SearchOptions -&gt; VerboseLevel) -&gt; SM VerboseLevel
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ContextEntry] -&gt; VerboseLevel
forall a. [a] -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">([ContextEntry] -&gt; VerboseLevel)
-&gt; (SearchOptions -&gt; [ContextEntry])
-&gt; SearchOptions
-&gt; VerboseLevel
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TCEnv -&gt; [ContextEntry]
</span><a href="Agda.TypeChecking.Monad.Base.html#envContext"><span class="hs-identifier hs-var">envContext</span></a></span><span> </span><span class="annot"><span class="annottext">(TCEnv -&gt; [ContextEntry])
-&gt; (SearchOptions -&gt; TCEnv) -&gt; SearchOptions -&gt; [ContextEntry]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; TCEnv
</span><a href="Agda.Mimer.Mimer.html#searchTopEnv"><span class="hs-identifier hs-var">searchTopEnv</span></a></span><span>
</span><span id="line-962"></span><span>  </span><span id="local-6989586621681880776"><span class="annot"><a href="#local-6989586621681880776"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">length</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContext"><span class="hs-identifier hs-type">getContext</span></a></span><span>
</span><span id="line-963"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621681880776"><span class="hs-identifier hs-type">cur</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621681880774"><span class="hs-identifier hs-type">top</span></a></span><span>
</span><span id="line-964"></span><span>
</span><span id="line-965"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#genComponents"><span class="hs-identifier hs-type">genComponents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-966"></span><span id="genComponents"><span class="annot"><span class="annottext">genComponents :: ReaderT SearchOptions (TCMT IO) [(Component, [Component])]
</span><a href="Agda.Mimer.Mimer.html#genComponents"><span class="hs-identifier hs-var hs-var">genComponents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-967"></span><span>  </span><span id="local-6989586621681880778"><span class="annot"><a href="#local-6989586621681880778"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) SearchOptions
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-968"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880779"><span class="annot"><a href="#local-6989586621681880779"><span class="hs-identifier hs-var hs-var">comps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; BaseComponents
</span><a href="Agda.Mimer.Mimer.html#searchBaseComponents"><span class="hs-identifier hs-var">searchBaseComponents</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681880778"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-969"></span><span>  </span><span id="local-6989586621681880780"><span class="annot"><a href="#local-6989586621681880780"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#localVarCount"><span class="hs-identifier hs-type">localVarCount</span></a></span><span>
</span><span id="line-970"></span><span>  </span><span id="local-6989586621681880781"><span class="annot"><a href="#local-6989586621681880781"><span class="hs-identifier hs-var">localVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#getLocalVars"><span class="hs-identifier hs-type">getLocalVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880780"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#costLocal"><span class="hs-identifier hs-var">costLocal</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#searchCosts"><span class="hs-identifier hs-var">searchCosts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880778"><span class="hs-identifier hs-type">opts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621681880783"><span class="hs-identifier hs-type">genAddSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#searchGenProjectionsLocal"><span class="hs-identifier hs-var">searchGenProjectionsLocal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880778"><span class="hs-identifier hs-type">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-972"></span><span>  </span><span id="local-6989586621681880784"><span class="annot"><a href="#local-6989586621681880784"><span class="hs-identifier hs-var">recCalls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681880783"><span class="hs-identifier hs-type">genAddSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#searchGenProjectionsRec"><span class="hs-identifier hs-var">searchGenProjectionsRec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880778"><span class="hs-identifier hs-type">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">maybeToList</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintThisFn"><span class="hs-identifier hs-var">hintThisFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880779"><span class="hs-identifier hs-type">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-973"></span><span>  </span><span id="local-6989586621681880785"><span class="annot"><a href="#local-6989586621681880785"><span class="hs-identifier hs-var">letVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#getOpenComponent"><span class="hs-identifier hs-type">getOpenComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintLetVars"><span class="hs-identifier hs-var">hintLetVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880779"><span class="hs-identifier hs-type">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-974"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621681880783"><span class="hs-identifier hs-type">genAddSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#searchGenProjectionsLet"><span class="hs-identifier hs-var">searchGenProjectionsLet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880778"><span class="hs-identifier hs-type">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span>  </span><span id="local-6989586621681880786"><span class="annot"><a href="#local-6989586621681880786"><span class="hs-identifier hs-var">fns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681880783"><span class="hs-identifier hs-type">genAddSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#searchGenProjectionsExternal"><span class="hs-identifier hs-var">searchGenProjectionsExternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880778"><span class="hs-identifier hs-type">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintFns"><span class="hs-identifier hs-var">hintFns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880779"><span class="hs-identifier hs-type">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-976"></span><span>  </span><span id="local-6989586621681880787"><span class="annot"><a href="#local-6989586621681880787"><span class="hs-identifier hs-var">axioms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681880783"><span class="hs-identifier hs-type">genAddSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#searchGenProjectionsExternal"><span class="hs-identifier hs-var">searchGenProjectionsExternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880778"><span class="hs-identifier hs-type">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintAxioms"><span class="hs-identifier hs-var">hintAxioms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880779"><span class="hs-identifier hs-type">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-977"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621681880781"><span class="hs-identifier hs-type">localVars</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621681880785"><span class="hs-identifier hs-type">letVars</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621681880784"><span class="hs-identifier hs-type">recCalls</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621681880786"><span class="hs-identifier hs-type">fns</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621681880787"><span class="hs-identifier hs-type">axioms</span></a></span><span>
</span><span id="line-978"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-979"></span><span>    </span><span class="annot"><a href="#local-6989586621681880783"><span class="hs-identifier hs-type">genAddSource</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-980"></span><span>    </span><span id="local-6989586621681880783"><span class="annot"><span class="annottext">genAddSource :: Bool
-&gt; [Component]
-&gt; ReaderT SearchOptions (TCMT IO) [(Component, [Component])]
</span><a href="#local-6989586621681880783"><span class="hs-identifier hs-var hs-var">genAddSource</span></a></span></span><span> </span><span id="local-6989586621681880788"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681880788"><span class="hs-identifier hs-var">genProj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Component
 -&gt; ReaderT SearchOptions (TCMT IO) (Component, [Component]))
-&gt; [Component]
-&gt; ReaderT SearchOptions (TCMT IO) [(Component, [Component])]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681880789"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880789"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880789"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Component] -&gt; (Component, [Component]))
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
-&gt; ReaderT SearchOptions (TCMT IO) (Component, [Component])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Component -&gt; ReaderT SearchOptions (TCMT IO) [Component]
</span><a href="Agda.Mimer.Mimer.html#genComponentsFrom"><span class="hs-identifier hs-var">genComponentsFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681880788"><span class="hs-identifier hs-var">genProj</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880789"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-981"></span><span>
</span><span id="line-982"></span><span>
</span><span id="line-983"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#genComponentsFrom"><span class="hs-identifier hs-type">genComponentsFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Apply record elimination</span></span><span>
</span><span id="line-984"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span>
</span><span id="line-985"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-986"></span><span id="genComponentsFrom"><span class="annot"><span class="annottext">genComponentsFrom :: Bool -&gt; Component -&gt; ReaderT SearchOptions (TCMT IO) [Component]
</span><a href="Agda.Mimer.Mimer.html#genComponentsFrom"><span class="hs-identifier hs-var hs-var">genComponentsFrom</span></a></span></span><span> </span><span id="local-6989586621681880790"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681880790"><span class="hs-identifier hs-var">appRecElims</span></a></span></span><span> </span><span id="local-6989586621681880791"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880791"><span class="hs-identifier hs-var">origComp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-987"></span><span>  </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.components&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Generating components from original component&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; VerboseLevel -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compId"><span class="hs-identifier hs-var">compId</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880791"><span class="hs-identifier hs-var">origComp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Maybe Name -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Maybe Name
</span><a href="Agda.Mimer.Mimer.html#compName"><span class="hs-identifier hs-var">compName</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880791"><span class="hs-identifier hs-var">origComp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-988"></span><span>  </span><span id="local-6989586621681880792"><span class="annot"><a href="#local-6989586621681880792"><span class="hs-identifier hs-var">comps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Component -&gt; Bool
</span><a href="Agda.Mimer.Mimer.html#compRec"><span class="hs-identifier hs-var">compRec</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880791"><span class="hs-identifier hs-var">origComp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Component -&gt; ReaderT SearchOptions (TCMT IO) Component)
-&gt; [Component] -&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe VerboseLevel
-&gt; Component -&gt; ReaderT SearchOptions (TCMT IO) Component
</span><a href="Agda.Mimer.Mimer.html#applyToMetasG"><span class="hs-identifier hs-var">applyToMetasG</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe VerboseLevel
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Component] -&gt; ReaderT SearchOptions (TCMT IO) [Component])
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Component -&gt; ReaderT SearchOptions (TCMT IO) [Component]
</span><a href="Agda.Mimer.Mimer.html#genRecCalls"><span class="hs-identifier hs-var">genRecCalls</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880791"><span class="hs-identifier hs-var">origComp</span></a></span><span>
</span><span id="line-989"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; [Component] -&gt; [Component]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Component -&gt; [Component])
-&gt; ReaderT SearchOptions (TCMT IO) Component
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe VerboseLevel
-&gt; Component -&gt; ReaderT SearchOptions (TCMT IO) Component
</span><a href="Agda.Mimer.Mimer.html#applyToMetasG"><span class="hs-identifier hs-var">applyToMetasG</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe VerboseLevel
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880791"><span class="hs-identifier hs-var">origComp</span></a></span><span>
</span><span id="line-990"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621681880790"><span class="hs-identifier hs-type">appRecElims</span></a></span><span>
</span><span id="line-991"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">concat</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880796"><span class="hs-identifier hs-type">applyProjections</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.empty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880792"><span class="hs-identifier hs-type">comps</span></a></span><span>
</span><span id="line-992"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621681880792"><span class="hs-identifier hs-type">comps</span></a></span><span>
</span><span id="line-993"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-994"></span><span>  </span><span class="annot"><a href="#local-6989586621681880796"><span class="hs-identifier hs-type">applyProjections</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-995"></span><span>  </span><span id="local-6989586621681880796"><span class="annot"><span class="annottext">applyProjections :: Set QName
-&gt; Component -&gt; ReaderT SearchOptions (TCMT IO) [Component]
</span><a href="#local-6989586621681880796"><span class="hs-identifier hs-var hs-var">applyProjections</span></a></span></span><span> </span><span id="local-6989586621681880798"><span class="annot"><span class="annottext">Set QName
</span><a href="#local-6989586621681880798"><span class="hs-identifier hs-var">seenRecords</span></a></span></span><span> </span><span id="local-6989586621681880799"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880799"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-996"></span><span>    </span><span id="local-6989586621681880800"><span class="annot"><a href="#local-6989586621681880800"><span class="hs-identifier hs-var">projComps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; SM (Maybe (QName, Args, [QName], Bool))
</span><a href="Agda.Mimer.Mimer.html#getRecordInfo"><span class="hs-identifier hs-var">getRecordInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Type
</span><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880799"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SM (Maybe (QName, Args, [QName], Bool))
-&gt; (Maybe (QName, Args, [QName], Bool)
    -&gt; ReaderT SearchOptions (TCMT IO) [Component])
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall a b.
ReaderT SearchOptions (TCMT IO) a
-&gt; (a -&gt; ReaderT SearchOptions (TCMT IO) b)
-&gt; ReaderT SearchOptions (TCMT IO) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-997"></span><span>      </span><span class="annot"><span class="annottext">Maybe (QName, Args, [QName], Bool)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Component] -&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-998"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880802"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880802"><span class="hs-identifier hs-var">recordName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880803"><span class="annot"><span class="annottext">Args
</span><a href="#local-6989586621681880803"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880804"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681880804"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880805"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681880805"><span class="hs-identifier hs-var">isRecursive</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-999"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Set QName -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880802"><span class="hs-identifier hs-var">recordName</span></a></span><span> </span><span class="annot"><span class="annottext">Set QName
</span><a href="#local-6989586621681880798"><span class="hs-identifier hs-var">seenRecords</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1000"></span><span>              </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.components&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1001"></span><span>                </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Skipping projection because recursive record already seen:&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880802"><span class="hs-identifier hs-var">recordName</span></a></span><span>
</span><span id="line-1002"></span><span>              </span><span class="annot"><span class="annottext">[Component] -&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1003"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1004"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880807"><span class="annot"><span class="annottext">seenRecords' :: Set QName
</span><a href="#local-6989586621681880807"><span class="hs-identifier hs-var hs-var hs-var">seenRecords'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681880805"><span class="hs-identifier hs-var">isRecursive</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Set QName -&gt; Set QName
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880802"><span class="hs-identifier hs-var">recordName</span></a></span><span> </span><span class="annot"><span class="annottext">Set QName
</span><a href="#local-6989586621681880798"><span class="hs-identifier hs-var">seenRecords</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Set QName
</span><a href="#local-6989586621681880798"><span class="hs-identifier hs-var">seenRecords</span></a></span><span>
</span><span id="line-1005"></span><span>              </span><span id="local-6989586621681880809"><span class="annot"><a href="#local-6989586621681880809"><span class="hs-identifier hs-var">comps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT SearchOptions (TCMT IO) Component)
-&gt; [QName] -&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Args
-&gt; Component -&gt; QName -&gt; ReaderT SearchOptions (TCMT IO) Component
</span><a href="Agda.Mimer.Mimer.html#applyProj"><span class="hs-identifier hs-var">applyProj</span></a></span><span> </span><span class="annot"><span class="annottext">Args
</span><a href="#local-6989586621681880803"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880799"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT SearchOptions (TCMT IO) Component)
-&gt; (Component -&gt; ReaderT SearchOptions (TCMT IO) Component)
-&gt; QName
-&gt; ReaderT SearchOptions (TCMT IO) Component
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe VerboseLevel
-&gt; Component -&gt; ReaderT SearchOptions (TCMT IO) Component
</span><a href="Agda.Mimer.Mimer.html#applyToMetasG"><span class="hs-identifier hs-var">applyToMetasG</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe VerboseLevel
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681880804"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-1006"></span><span>              </span><span class="annot"><a href="Agda.Mimer.Mimer.html#concatMapM"><span class="hs-identifier hs-type">concatMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880796"><span class="hs-identifier hs-type">applyProjections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880807"><span class="hs-identifier hs-type">seenRecords'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880809"><span class="hs-identifier hs-type">comps</span></a></span><span>
</span><span id="line-1007"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621681880799"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621681880800"><span class="hs-identifier hs-type">projComps</span></a></span><span>
</span><span id="line-1008"></span><span>
</span><span id="line-1009"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#getRecordInfo"><span class="hs-identifier hs-type">getRecordInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1010"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>     </span><span class="hs-comment">-- Record name</span><span>
</span><span id="line-1011"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Args"><span class="hs-identifier hs-type">Args</span></a></span><span>      </span><span class="hs-comment">-- Record parameters converted to (hidden) arguments</span><span>
</span><span id="line-1012"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Field names</span><span>
</span><span id="line-1013"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>      </span><span class="hs-comment">-- Is recursive?</span><span>
</span><span id="line-1014"></span><span>               </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1015"></span><span id="getRecordInfo"><span class="annot"><span class="annottext">getRecordInfo :: Type -&gt; SM (Maybe (QName, Args, [QName], Bool))
</span><a href="Agda.Mimer.Mimer.html#getRecordInfo"><span class="hs-identifier hs-var hs-var">getRecordInfo</span></a></span></span><span> </span><span id="local-6989586621681880811"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880811"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Term
forall t a. Type'' t a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880811"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1016"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621681880812"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880812"><span class="hs-identifier hs-var">qname</span></a></span></span><span> </span><span id="local-6989586621681880813"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681880813"><span class="hs-identifier hs-var">elims</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT SearchOptions (TCMT IO) (Maybe RecordData)
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; m (Maybe RecordData)
</span><a href="Agda.TypeChecking.Records.html#isRecord"><span class="hs-identifier hs-var">isRecord</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880812"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) (Maybe RecordData)
-&gt; (Maybe RecordData -&gt; SM (Maybe (QName, Args, [QName], Bool)))
-&gt; SM (Maybe (QName, Args, [QName], Bool))
forall a b.
ReaderT SearchOptions (TCMT IO) a
-&gt; (a -&gt; ReaderT SearchOptions (TCMT IO) b)
-&gt; ReaderT SearchOptions (TCMT IO) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1017"></span><span>    </span><span class="annot"><span class="annottext">Maybe RecordData
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (QName, Args, [QName], Bool)
-&gt; SM (Maybe (QName, Args, [QName], Bool))
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (QName, Args, [QName], Bool)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1018"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681880814"><span class="annot"><span class="annottext">RecordData
</span><a href="#local-6989586621681880814"><span class="hs-identifier hs-var">defn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1019"></span><span>      </span><span id="local-6989586621681880815"><span class="annot"><a href="#local-6989586621681880815"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT SearchOptions (TCMT IO) [QName]
forall (tcm :: * -&gt; *).
(HasConstInfo tcm, MonadTCM tcm) =&gt;
QName -&gt; tcm [QName]
</span><a href="Agda.Mimer.Mimer.html#getRecordFields"><span class="hs-identifier hs-var">getRecordFields</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880812"><span class="hs-identifier hs-var">qname</span></a></span><span>
</span><span id="line-1020"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880812"><span class="hs-identifier hs-type">qname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#argsFromElims"><span class="hs-identifier hs-type">argsFromElims</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880813"><span class="hs-identifier hs-type">elims</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681880815"><span class="hs-identifier hs-type">fields</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recRecursive_"><span class="hs-identifier hs-type">recRecursive_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880814"><span class="hs-identifier hs-type">defn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1021"></span><span>  </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (QName, Args, [QName], Bool)
-&gt; SM (Maybe (QName, Args, [QName], Bool))
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (QName, Args, [QName], Bool)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1022"></span><span>
</span><span id="line-1023"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#applyProj"><span class="hs-identifier hs-type">applyProj</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Args"><span class="hs-identifier hs-type">Args</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span>
</span><span id="line-1024"></span><span id="applyProj"><span class="annot"><span class="annottext">applyProj :: Args
-&gt; Component -&gt; QName -&gt; ReaderT SearchOptions (TCMT IO) Component
</span><a href="Agda.Mimer.Mimer.html#applyProj"><span class="hs-identifier hs-var hs-var">applyProj</span></a></span></span><span> </span><span id="local-6989586621681880818"><span class="annot"><span class="annottext">Args
</span><a href="#local-6989586621681880818"><span class="hs-identifier hs-var">recordArgs</span></a></span></span><span> </span><span id="local-6989586621681880819"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880819"><span class="hs-identifier hs-var">comp'</span></a></span></span><span> </span><span id="local-6989586621681880820"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880820"><span class="hs-identifier hs-var">qname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1025"></span><span>  </span><span id="local-6989586621681880821"><span class="annot"><a href="#local-6989586621681880821"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; VerboseLevel) -&gt; SM VerboseLevel
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costProj"><span class="hs-identifier hs-var">costProj</span></a></span><span> </span><span class="annot"><span class="annottext">(Costs -&gt; VerboseLevel)
-&gt; (SearchOptions -&gt; Costs) -&gt; SearchOptions -&gt; VerboseLevel
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; Costs
</span><a href="Agda.Mimer.Mimer.html#searchCosts"><span class="hs-identifier hs-var">searchCosts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1026"></span><span>  </span><span class="hs-comment">-- Andreas, 2025-03-31, issue #7662: hack to prevent postfix printing of &#9837;</span><span>
</span><span id="line-1027"></span><span>  </span><span id="local-6989586621681880822"><span class="annot"><a href="#local-6989586621681880822"><span class="hs-identifier hs-var">projOrigin</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#ProjSystem"><span class="hs-identifier hs-type">ProjSystem</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681880824"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880824"><span class="hs-identifier hs-var">flat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880820"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880824"><span class="hs-identifier hs-var">flat</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="Agda.Syntax.Common.html#ProjPrefix"><span class="hs-identifier hs-var">ProjPrefix</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="Agda.Syntax.Common.html#ProjSystem"><span class="hs-identifier hs-var">ProjSystem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1028"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">asks</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#searchBuiltinFlat"><span class="hs-identifier hs-var">searchBuiltinFlat</span></a></span><span>
</span><span id="line-1029"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880826"><span class="annot"><a href="#local-6989586621681880826"><span class="hs-identifier hs-var hs-var">newTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Elims -&gt; Term
forall t. Apply t =&gt; t -&gt; Elims -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#applyE"><span class="hs-identifier hs-var">applyE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880819"><span class="hs-identifier hs-var">comp'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProjOrigin -&gt; QName -&gt; Elim' Term
forall a. ProjOrigin -&gt; QName -&gt; Elim' a
</span><a href="Agda.Syntax.Internal.Elim.html#Proj"><span class="hs-identifier hs-var">Proj</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="#local-6989586621681880822"><span class="hs-identifier hs-var">projOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681880820"><span class="hs-identifier hs-var">qname</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1030"></span><span>  </span><span id="local-6989586621681880828"><span class="annot"><a href="#local-6989586621681880828"><span class="hs-identifier hs-var">projType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-type">getConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880820"><span class="hs-identifier hs-type">qname</span></a></span><span>
</span><span id="line-1031"></span><span>  </span><span id="local-6989586621681880829"><span class="annot"><a href="#local-6989586621681880829"><span class="hs-identifier hs-var">projTypeWithArgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#piApplyM"><span class="hs-identifier hs-type">piApplyM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880828"><span class="hs-identifier hs-type">projType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880818"><span class="hs-identifier hs-type">recordArgs</span></a></span><span>
</span><span id="line-1032"></span><span>  </span><span id="local-6989586621681880830"><span class="annot"><a href="#local-6989586621681880830"><span class="hs-identifier hs-var">newType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#piApplyM"><span class="hs-identifier hs-type">piApplyM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880829"><span class="hs-identifier hs-type">projTypeWithArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880819"><span class="hs-identifier hs-type">comp'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1033"></span><span>  </span><span class="annot"><a href="Agda.Mimer.Mimer.html#newComponentQ"><span class="hs-identifier hs-type">newComponentQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#compMetas"><span class="hs-identifier hs-var">compMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880819"><span class="hs-identifier hs-type">comp'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var">compCost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880819"><span class="hs-identifier hs-type">comp'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621681880821"><span class="hs-identifier hs-type">cost</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880820"><span class="hs-identifier hs-type">qname</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="#local-6989586621681880826"><span class="hs-identifier hs-type">newTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880830"><span class="hs-identifier hs-type">newType</span></a></span><span>
</span><span id="line-1034"></span><span>
</span><span id="line-1035"></span><span>
</span><span id="line-1036"></span><span class="hs-comment">-- TODO: currently reducing twice</span><span>
</span><span id="line-1037"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#applyToMetasG"><span class="hs-identifier hs-type">applyToMetasG</span></a></span><span>
</span><span id="line-1038"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Max number of arguments to apply.</span></span><span>
</span><span id="line-1039"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span>
</span><span id="line-1040"></span><span id="applyToMetasG"><span class="annot"><span class="annottext">applyToMetasG :: Maybe VerboseLevel
-&gt; Component -&gt; ReaderT SearchOptions (TCMT IO) Component
</span><a href="Agda.Mimer.Mimer.html#applyToMetasG"><span class="hs-identifier hs-var hs-var">applyToMetasG</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681880831"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880831"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681880832"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880832"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880831"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Component -&gt; ReaderT SearchOptions (TCMT IO) Component
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880832"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-1041"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#applyToMetasG"><span class="hs-identifier hs-var">applyToMetasG</span></a></span><span> </span><span id="local-6989586621681880834"><span class="annot"><span class="annottext">Maybe VerboseLevel
</span><a href="#local-6989586621681880834"><span class="hs-identifier hs-var">maxArgs</span></a></span></span><span> </span><span id="local-6989586621681880835"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880835"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1042"></span><span>  </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.component&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">25</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Applying component to metas&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; VerboseLevel -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compId"><span class="hs-identifier hs-var">compId</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880835"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Term -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880835"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1043"></span><span>  </span><span id="local-6989586621681880836"><span class="annot"><a href="#local-6989586621681880836"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Telescope
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m Telescope
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-var">getContextTelescope</span></a></span><span>
</span><span id="line-1044"></span><span>  </span><span id="local-6989586621681880837"><span class="annot"><a href="#local-6989586621681880837"><span class="hs-identifier hs-var">compTyp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#reduce"><span class="hs-identifier hs-type">reduce</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880835"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-1045"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880837"><span class="hs-identifier hs-type">compTyp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1046"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span id="local-6989586621681880839"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880839"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621681880840"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681880840"><span class="hs-identifier hs-var">abs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1047"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880841"><span class="annot"><span class="annottext">domainType :: Type
</span><a href="#local-6989586621681880841"><span class="hs-identifier hs-var hs-var hs-var">domainType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880839"><span class="hs-identifier hs-var">dom</span></a></span><span>
</span><span id="line-1048"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681880842"><span class="annot"><a href="#local-6989586621681880842"><span class="hs-identifier hs-var">metaId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880843"><span class="annot"><a href="#local-6989586621681880843"><span class="hs-identifier hs-var">metaTerm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; SM (MetaId, Term)
</span><a href="Agda.Mimer.Mimer.html#createMeta"><span class="hs-identifier hs-var">createMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880841"><span class="hs-identifier hs-var">domainType</span></a></span><span>
</span><span id="line-1049"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.component&quot;</span></span><span> </span><span class="annot"><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;New arg meta&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880843"><span class="hs-identifier hs-type">metaTerm</span></a></span><span>
</span><span id="line-1050"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880845"><span class="annot"><a href="#local-6989586621681880845"><span class="hs-identifier hs-var hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Origin -&gt; Arg Term -&gt; Arg Term
forall a. LensOrigin a =&gt; Origin -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setOrigin"><span class="hs-identifier hs-var">setOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#Inserted"><span class="hs-identifier hs-var">Inserted</span></a></span><span> </span><span class="annot"><span class="annottext">(Arg Term -&gt; Arg Term) -&gt; Arg Term -&gt; Arg Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880843"><span class="hs-identifier hs-var">metaTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Arg Type -&gt; Arg Term
forall a b. a -&gt; Arg b -&gt; Arg a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Arg Type
forall t a. Dom' t a -&gt; Arg a
</span><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-var">argFromDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880839"><span class="hs-identifier hs-var">dom</span></a></span><span>
</span><span id="line-1051"></span><span>      </span><span id="local-6989586621681880848"><span class="annot"><a href="#local-6989586621681880848"><span class="hs-identifier hs-var">newType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#reduce"><span class="hs-identifier hs-type">reduce</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#piApplyM"><span class="hs-identifier hs-type">piApplyM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880835"><span class="hs-identifier hs-type">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880843"><span class="hs-identifier hs-type">metaTerm</span></a></span><span>
</span><span id="line-1052"></span><span>      </span><span class="hs-comment">-- Constructor parameters are not included in the term</span><span>
</span><span id="line-1053"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880849"><span class="annot"><a href="#local-6989586621681880849"><span class="hs-identifier hs-var hs-var">skip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Component -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compPars"><span class="hs-identifier hs-var">compPars</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880835"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-1054"></span><span>          </span><span id="local-6989586621681880850"><span class="annot"><a href="#local-6989586621681880850"><span class="hs-identifier hs-var hs-var">newTerm</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880849"><span class="hs-identifier hs-var">skip</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880835"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-1055"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Args -&gt; Term
forall t. Apply t =&gt; t -&gt; Args -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880835"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Arg Term
</span><a href="#local-6989586621681880845"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1056"></span><span>      </span><span id="local-6989586621681880851"><span class="annot"><a href="#local-6989586621681880851"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">asks</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#getHiding"><span class="hs-identifier hs-type">getHiding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880845"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Hidden"><span class="hs-identifier hs-type">Hidden</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#costNewHiddenMeta"><span class="hs-identifier hs-var">costNewHiddenMeta</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#costNewMeta"><span class="hs-identifier hs-var">costNewMeta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#searchCosts"><span class="hs-identifier hs-var">searchCosts</span></a></span><span>
</span><span id="line-1057"></span><span>      </span><span class="annot"><a href="Agda.Mimer.Mimer.html#applyToMetasG"><span class="hs-identifier hs-type">applyToMetasG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#predNat"><span class="hs-identifier hs-type">predNat</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621681880834"><span class="hs-identifier hs-type">maxArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1058"></span><span>                    </span><span class="annot"><a href="#local-6989586621681880835"><span class="hs-identifier hs-type">comp</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880850"><span class="hs-identifier hs-type">newTerm</span></a></span><span>
</span><span id="line-1059"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880848"><span class="hs-identifier hs-type">newType</span></a></span><span>
</span><span id="line-1060"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compPars"><span class="hs-identifier hs-var">compPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#predNat"><span class="hs-identifier hs-type">predNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880849"><span class="hs-identifier hs-type">skip</span></a></span><span>
</span><span id="line-1061"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compMetas"><span class="hs-identifier hs-var">compMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880842"><span class="hs-identifier hs-type">metaId</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compMetas"><span class="hs-identifier hs-var">compMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880835"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-1062"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var">compCost</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880851"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var">compCost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880835"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-1063"></span><span>                        </span><span class="hs-special">}</span><span>
</span><span id="line-1064"></span><span>    </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1065"></span><span>      </span><span class="hs-comment">-- Set the type to the reduced version</span><span>
</span><span id="line-1066"></span><span>      </span><span class="annot"><span class="annottext">Component -&gt; ReaderT SearchOptions (TCMT IO) Component
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880835"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681880837"><span class="hs-identifier hs-type">compTyp</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1067"></span><span>
</span><span id="line-1068"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#createMeta"><span class="hs-identifier hs-type">createMeta</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1069"></span><span id="createMeta"><span class="annot"><span class="annottext">createMeta :: Type -&gt; SM (MetaId, Term)
</span><a href="Agda.Mimer.Mimer.html#createMeta"><span class="hs-identifier hs-var hs-var">createMeta</span></a></span></span><span> </span><span id="local-6989586621681880853"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880853"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1070"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681880854"><span class="annot"><a href="#local-6989586621681880854"><span class="hs-identifier hs-var">metaId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880855"><span class="annot"><a href="#local-6989586621681880855"><span class="hs-identifier hs-var">metaTerm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RunMetaOccursCheck -&gt; Comparison -&gt; Type -&gt; SM (MetaId, Term)
forall (m :: * -&gt; *).
MonadMetaSolver m =&gt;
RunMetaOccursCheck -&gt; Comparison -&gt; Type -&gt; m (MetaId, Term)
</span><a href="Agda.TypeChecking.MetaVars.html#newValueMeta"><span class="hs-identifier hs-var">newValueMeta</span></a></span><span> </span><span class="annot"><span class="annottext">RunMetaOccursCheck
</span><a href="Agda.TypeChecking.Monad.Base.html#DontRunMetaOccursCheck"><span class="hs-identifier hs-var">DontRunMetaOccursCheck</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="Agda.TypeChecking.Monad.Base.Types.html#CmpLeq"><span class="hs-identifier hs-var">CmpLeq</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880853"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-1071"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#verboseS"><span class="hs-identifier hs-type">verboseS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.stats&quot;</span></span><span> </span><span class="annot"><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#updateStat"><span class="hs-identifier hs-type">updateStat</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#incMetasCreated"><span class="hs-identifier hs-type">incMetasCreated</span></a></span><span>
</span><span id="line-1072"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.components&quot;</span></span><span> </span><span class="annot"><span class="hs-number">80</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1073"></span><span>    </span><span class="annot"><span class="hs-string">&quot;Created meta-variable (type in context):&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880855"><span class="hs-identifier hs-type">metaTerm</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html#getMetaTypeInContext"><span class="hs-identifier hs-type">getMetaTypeInContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880854"><span class="hs-identifier hs-type">metaId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1074"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880854"><span class="hs-identifier hs-type">metaId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681880855"><span class="hs-identifier hs-type">metaTerm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1075"></span><span>
</span><span id="line-1076"></span><span>
</span><span id="line-1077"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#partitionStepResult"><span class="hs-identifier hs-type">partitionStepResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerResult"><span class="hs-identifier hs-type">MimerResult</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1078"></span><span id="partitionStepResult"><span class="annot"><span class="annottext">partitionStepResult :: [SearchStepResult]
-&gt; ReaderT SearchOptions (TCMT IO) ([SearchBranch], [MimerResult])
</span><a href="Agda.Mimer.Mimer.html#partitionStepResult"><span class="hs-identifier hs-var hs-var">partitionStepResult</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([SearchBranch], [MimerResult])
-&gt; ReaderT SearchOptions (TCMT IO) ([SearchBranch], [MimerResult])
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1079"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#partitionStepResult"><span class="hs-identifier hs-var">partitionStepResult</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880858"><span class="annot"><span class="annottext">SearchStepResult
</span><a href="#local-6989586621681880858"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681880859"><span class="annot"><span class="annottext">[SearchStepResult]
</span><a href="#local-6989586621681880859"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1080"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880860"><span class="annot"><span class="annottext">rest :: ReaderT SearchOptions (TCMT IO) ([SearchBranch], [MimerResult])
</span><a href="#local-6989586621681880860"><span class="hs-identifier hs-var hs-var hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SearchStepResult]
-&gt; ReaderT SearchOptions (TCMT IO) ([SearchBranch], [MimerResult])
</span><a href="Agda.Mimer.Mimer.html#partitionStepResult"><span class="hs-identifier hs-var">partitionStepResult</span></a></span><span> </span><span class="annot"><span class="annottext">[SearchStepResult]
</span><a href="#local-6989586621681880859"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1081"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681880861"><span class="annot"><a href="#local-6989586621681880861"><span class="hs-identifier hs-var">brs'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681880862"><span class="annot"><a href="#local-6989586621681880862"><span class="hs-identifier hs-var">sols</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) ([SearchBranch], [MimerResult])
</span><a href="#local-6989586621681880860"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1082"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681880858"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1083"></span><span>    </span><span class="annot"><span class="annottext">SearchStepResult
</span><a href="Agda.Mimer.Mimer.html#NoSolution"><span class="hs-identifier hs-var">NoSolution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) ([SearchBranch], [MimerResult])
</span><a href="#local-6989586621681880860"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1084"></span><span>    </span><span class="annot"><a href="Agda.Mimer.Mimer.html#OpenBranch"><span class="hs-identifier hs-type">OpenBranch</span></a></span><span> </span><span id="local-6989586621681880863"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880863"><span class="hs-identifier hs-var">br</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([SearchBranch], [MimerResult])
-&gt; ReaderT SearchOptions (TCMT IO) ([SearchBranch], [MimerResult])
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880863"><span class="hs-identifier hs-var">br</span></a></span><span class="annot"><span class="annottext">SearchBranch -&gt; [SearchBranch] -&gt; [SearchBranch]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[SearchBranch]
</span><a href="#local-6989586621681880861"><span class="hs-identifier hs-var">brs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MimerResult]
</span><a href="#local-6989586621681880862"><span class="hs-identifier hs-var">sols</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1085"></span><span>    </span><span class="annot"><a href="Agda.Mimer.Mimer.html#ResultExpr"><span class="hs-identifier hs-type">ResultExpr</span></a></span><span> </span><span id="local-6989586621681880864"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681880864"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1086"></span><span>      </span><span id="local-6989586621681880865"><span class="annot"><a href="#local-6989586621681880865"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; ArgName
forall a. Doc a -&gt; ArgName
</span><span class="hs-identifier hs-var">P.render</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; ArgName)
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ArgName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Expr -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681880864"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1087"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880861"><span class="hs-identifier hs-type">brs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerExpr"><span class="hs-identifier hs-type">MimerExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880865"><span class="hs-identifier hs-type">str</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621681880862"><span class="hs-identifier hs-type">sols</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1088"></span><span>    </span><span class="annot"><a href="Agda.Mimer.Mimer.html#ResultClauses"><span class="hs-identifier hs-type">ResultClauses</span></a></span><span> </span><span id="local-6989586621681880866"><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621681880866"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1089"></span><span>      </span><span id="local-6989586621681880867"><span class="annot"><a href="#local-6989586621681880867"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName -&gt; QName
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">QName
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe QName -&gt; QName)
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe QName)
-&gt; ReaderT SearchOptions (TCMT IO) QName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; Maybe QName)
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe QName)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; Maybe QName
</span><a href="Agda.Mimer.Mimer.html#searchFnName"><span class="hs-identifier hs-var">searchFnName</span></a></span><span>
</span><span id="line-1090"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880861"><span class="hs-identifier hs-type">brs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerClauses"><span class="hs-identifier hs-type">MimerClauses</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880867"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880866"><span class="hs-identifier hs-type">cls</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621681880862"><span class="hs-identifier hs-type">sols</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1091"></span><span>
</span><span id="line-1092"></span><span>
</span><span id="line-1093"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#topInstantiationDoc"><span class="hs-identifier hs-type">topInstantiationDoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-1094"></span><span id="topInstantiationDoc"><span class="annot"><span class="annottext">topInstantiationDoc :: ReaderT SearchOptions (TCMT IO) Doc
</span><a href="Agda.Mimer.Mimer.html#topInstantiationDoc"><span class="hs-identifier hs-var hs-var">topInstantiationDoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; MetaId) -&gt; ReaderT SearchOptions (TCMT IO) MetaId
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#searchTopMeta"><span class="hs-identifier hs-var">searchTopMeta</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) MetaId
-&gt; (MetaId -&gt; ReaderT SearchOptions (TCMT IO) (Maybe Expr))
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe Expr)
forall a b.
ReaderT SearchOptions (TCMT IO) a
-&gt; (a -&gt; ReaderT SearchOptions (TCMT IO) b)
-&gt; ReaderT SearchOptions (TCMT IO) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; ReaderT SearchOptions (TCMT IO) (Maybe Expr)
forall (tcm :: * -&gt; *).
(MonadTCM tcm, PureTCM tcm, MonadDebug tcm,
 MonadInteractionPoints tcm, MonadFresh NameId tcm) =&gt;
MetaId -&gt; tcm (Maybe Expr)
</span><a href="Agda.Mimer.Mimer.html#getMetaInstantiation"><span class="hs-identifier hs-var">getMetaInstantiation</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) (Maybe Expr)
-&gt; (Maybe Expr -&gt; ReaderT SearchOptions (TCMT IO) Doc)
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a b.
ReaderT SearchOptions (TCMT IO) a
-&gt; (a -&gt; ReaderT SearchOptions (TCMT IO) b)
-&gt; ReaderT SearchOptions (TCMT IO) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; (Expr -&gt; ReaderT SearchOptions (TCMT IO) Doc)
-&gt; Maybe Expr
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;(nothing)&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Expr -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span>
</span><span id="line-1095"></span><span>
</span><span id="line-1096"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#prettyGoalInst"><span class="hs-identifier hs-type">prettyGoalInst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-1097"></span><span id="prettyGoalInst"><span class="annot"><span class="annottext">prettyGoalInst :: Goal -&gt; ReaderT SearchOptions (TCMT IO) Doc
</span><a href="Agda.Mimer.Mimer.html#prettyGoalInst"><span class="hs-identifier hs-var hs-var">prettyGoalInst</span></a></span></span><span> </span><span id="local-6989586621681880870"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880870"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Goal
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a. Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#inGoalEnv"><span class="hs-identifier hs-var">inGoalEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880870"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Doc
 -&gt; ReaderT SearchOptions (TCMT IO) Doc)
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1098"></span><span>  </span><span id="local-6989586621681880871"><span class="annot"><a href="#local-6989586621681880871"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Arg Term -&gt; Elim' Term) -&gt; Args -&gt; Elims
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Arg Term -&gt; Elim' Term
forall a. Arg a -&gt; Elim' a
</span><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-var">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">(Args -&gt; Elims)
-&gt; ReaderT SearchOptions (TCMT IO) Args
-&gt; ReaderT SearchOptions (TCMT IO) Elims
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Args
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m Args
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextArgs"><span class="hs-identifier hs-var">getContextArgs</span></a></span><span>
</span><span id="line-1099"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#instantiate"><span class="hs-identifier hs-type">instantiate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880870"><span class="hs-identifier hs-type">goal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880871"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1100"></span><span>
</span><span id="line-1101"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#branchInstantiationDocCost"><span class="hs-identifier hs-type">branchInstantiationDocCost</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-1102"></span><span id="branchInstantiationDocCost"><span class="annot"><span class="annottext">branchInstantiationDocCost :: SearchBranch -&gt; ReaderT SearchOptions (TCMT IO) Doc
</span><a href="Agda.Mimer.Mimer.html#branchInstantiationDocCost"><span class="hs-identifier hs-var hs-var">branchInstantiationDocCost</span></a></span></span><span> </span><span id="local-6989586621681880873"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880873"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; ReaderT SearchOptions (TCMT IO) Doc
</span><a href="Agda.Mimer.Mimer.html#branchInstantiationDoc"><span class="hs-identifier hs-var">branchInstantiationDoc</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880873"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Functor m =&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;cost:&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SearchBranch -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#sbCost"><span class="hs-identifier hs-var">sbCost</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880873"><span class="hs-identifier hs-var">branch</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1103"></span><span>
</span><span id="line-1104"></span><span class="annot"><span class="hs-comment">-- | For debug</span></span><span>
</span><span id="line-1105"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#branchInstantiationDoc"><span class="hs-identifier hs-type">branchInstantiationDoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-1106"></span><span id="branchInstantiationDoc"><span class="annot"><span class="annottext">branchInstantiationDoc :: SearchBranch -&gt; ReaderT SearchOptions (TCMT IO) Doc
</span><a href="Agda.Mimer.Mimer.html#branchInstantiationDoc"><span class="hs-identifier hs-var hs-var">branchInstantiationDoc</span></a></span></span><span> </span><span id="local-6989586621681880875"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880875"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a. SearchBranch -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchState"><span class="hs-identifier hs-var">withBranchState</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880875"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><a href="Agda.Mimer.Mimer.html#topInstantiationDoc"><span class="hs-identifier hs-var">topInstantiationDoc</span></a></span><span>
</span><span id="line-1107"></span><span>
</span><span id="line-1108"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#refine"><span class="hs-identifier hs-type">refine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1109"></span><span id="refine"><span class="annot"><span class="annottext">refine :: SearchBranch -&gt; SM [SearchStepResult]
</span><a href="Agda.Mimer.Mimer.html#refine"><span class="hs-identifier hs-var hs-var">refine</span></a></span></span><span> </span><span id="local-6989586621681880876"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880876"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a. SearchBranch -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchState"><span class="hs-identifier hs-var">withBranchState</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880876"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">(SM [SearchStepResult] -&gt; SM [SearchStepResult])
-&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1110"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880877"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880877"><span class="hs-identifier hs-var">goal1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880878"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880878"><span class="hs-identifier hs-var">branch1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; (Goal, SearchBranch)
</span><a href="Agda.Mimer.Mimer.html#nextGoal"><span class="hs-identifier hs-var">nextGoal</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880876"><span class="hs-identifier hs-var">branch</span></a></span><span>
</span><span id="line-1111"></span><span>
</span><span id="line-1112"></span><span>  </span><span class="annot"><span class="annottext">SearchBranch
-&gt; Goal -&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a. SearchBranch -&gt; Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-var">withBranchAndGoal</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880878"><span class="hs-identifier hs-var">branch1</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880877"><span class="hs-identifier hs-var">goal1</span></a></span><span> </span><span class="annot"><span class="annottext">(SM [SearchStepResult] -&gt; SM [SearchStepResult])
-&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1113"></span><span>    </span><span id="local-6989586621681880879"><span class="annot"><a href="#local-6989586621681880879"><span class="hs-identifier hs-var">goalType1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Phase]
-&gt; ReaderT SearchOptions (TCMT IO) Type
-&gt; ReaderT SearchOptions (TCMT IO) Type
forall a. NFData a =&gt; [Phase] -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#bench"><span class="hs-identifier hs-var">bench</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Phase
</span><a href="Agda.Benchmarking.html#Reduce"><span class="hs-identifier hs-var">Bench.Reduce</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Type
 -&gt; ReaderT SearchOptions (TCMT IO) Type)
-&gt; ReaderT SearchOptions (TCMT IO) Type
-&gt; ReaderT SearchOptions (TCMT IO) Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ReaderT SearchOptions (TCMT IO) Type
forall a (m :: * -&gt; *). (Reduce a, MonadReduce m) =&gt; a -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#reduce"><span class="hs-identifier hs-var">reduce</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; ReaderT SearchOptions (TCMT IO) Type)
-&gt; ReaderT SearchOptions (TCMT IO) Type
-&gt; ReaderT SearchOptions (TCMT IO) Type
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; ReaderT SearchOptions (TCMT IO) Type
forall (m :: * -&gt; *).
(HasBuiltins m, HasCallStack, MonadDebug m, MonadReduce m,
 MonadTCEnv m, ReadTCState m) =&gt;
MetaId -&gt; m Type
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#getMetaTypeInContext"><span class="hs-identifier hs-var">getMetaTypeInContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Goal -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880877"><span class="hs-identifier hs-var">goal1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1114"></span><span>
</span><span id="line-1115"></span><span>    </span><span class="annot"><a href="Agda.Mimer.Mimer.html#mimerTrace"><span class="hs-identifier hs-type">mimerTrace</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span>
</span><span id="line-1116"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Refining goal&quot;</span></span><span>
</span><span id="line-1117"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880877"><span class="hs-identifier hs-type">goal1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880879"><span class="hs-identifier hs-type">goalType1</span></a></span><span>
</span><span id="line-1118"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;in context&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-type">inTopContext</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-type">getContextTelescope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1119"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-1120"></span><span>
</span><span id="line-1121"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.refine&quot;</span></span><span> </span><span class="annot"><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Goal type:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880879"><span class="hs-identifier hs-type">goalType1</span></a></span><span>
</span><span id="line-1122"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.refine&quot;</span></span><span> </span><span class="annot"><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Goal context:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-type">getContextTelescope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1123"></span><span>
</span><span id="line-1124"></span><span>    </span><span class="hs-comment">-- Lambda-abstract as far as possible</span><span>
</span><span id="line-1125"></span><span>    </span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryLamAbs"><span class="hs-identifier hs-type">tryLamAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880877"><span class="hs-identifier hs-type">goal1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880879"><span class="hs-identifier hs-type">goalType1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880878"><span class="hs-identifier hs-type">branch1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1126"></span><span>      </span><span class="hs-comment">-- Absurd lambda</span><span>
</span><span id="line-1127"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681880882"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880882"><span class="hs-identifier hs-var">branch2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1128"></span><span>        </span><span class="annot"><span class="annottext">VerboseLevel
-&gt; VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#mimerTrace"><span class="hs-identifier hs-var">mimerTrace</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Doc
 -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ReaderT SearchOptions (TCMT IO) Doc]
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-1129"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;Absurd bambda refinement&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Doc
 -&gt; ReaderT SearchOptions (TCMT IO) Doc)
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Goal -&gt; ReaderT SearchOptions (TCMT IO) Doc
</span><a href="Agda.Mimer.Mimer.html#prettyGoalInst"><span class="hs-identifier hs-var">prettyGoalInst</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880877"><span class="hs-identifier hs-var">goal1</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1130"></span><span>        </span><span id="local-6989586621681880883"><span class="annot"><a href="#local-6989586621681880883"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Arg Term -&gt; Elim' Term) -&gt; Args -&gt; Elims
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Arg Term -&gt; Elim' Term
forall a. Arg a -&gt; Elim' a
</span><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-var">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">(Args -&gt; Elims)
-&gt; ReaderT SearchOptions (TCMT IO) Args
-&gt; ReaderT SearchOptions (TCMT IO) Elims
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Args
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m Args
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextArgs"><span class="hs-identifier hs-var">getContextArgs</span></a></span><span>
</span><span id="line-1131"></span><span>        </span><span id="local-6989586621681880884"><span class="annot"><a href="#local-6989586621681880884"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.InternalToAbstract.html#blankNotInScope"><span class="hs-identifier hs-type">blankNotInScope</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Translation.InternalToAbstract.html#reify"><span class="hs-identifier hs-type">reify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880877"><span class="hs-identifier hs-type">goal1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880883"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1132"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#ResultExpr"><span class="hs-identifier hs-type">ResultExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880884"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1133"></span><span>      </span><span class="hs-comment">-- Normal abstraction</span><span>
</span><span id="line-1134"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681880885"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880885"><span class="hs-identifier hs-var">goal2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880886"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880886"><span class="hs-identifier hs-var">goalType2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880887"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880887"><span class="hs-identifier hs-var">branch2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SearchBranch
-&gt; Goal -&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a. SearchBranch -&gt; Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-var">withBranchAndGoal</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880887"><span class="hs-identifier hs-var">branch2</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880885"><span class="hs-identifier hs-var">goal2</span></a></span><span> </span><span class="annot"><span class="annottext">(SM [SearchStepResult] -&gt; SM [SearchStepResult])
-&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1135"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681880888"><span class="annot"><a href="#local-6989586621681880888"><span class="hs-identifier hs-var">branch3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880889"><span class="annot"><a href="#local-6989586621681880889"><span class="hs-identifier hs-var">components</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Goal
-&gt; SearchBranch -&gt; SM (SearchBranch, [(Component, [Component])])
</span><a href="Agda.Mimer.Mimer.html#prepareComponents"><span class="hs-identifier hs-var">prepareComponents</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880885"><span class="hs-identifier hs-var">goal2</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880887"><span class="hs-identifier hs-var">branch2</span></a></span><span>
</span><span id="line-1136"></span><span>        </span><span class="annot"><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-type">withBranchAndGoal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880888"><span class="hs-identifier hs-type">branch3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880885"><span class="hs-identifier hs-type">goal2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1137"></span><span>
</span><span id="line-1138"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880885"><span class="hs-identifier hs-type">goal2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880877"><span class="hs-identifier hs-type">goal1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1139"></span><span>            </span><span class="annot"><a href="Agda.Mimer.Mimer.html#mimerTrace"><span class="hs-identifier hs-type">mimerTrace</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span>
</span><span id="line-1140"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Lambda refinement&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#prettyGoalInst"><span class="hs-identifier hs-type">prettyGoalInst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880877"><span class="hs-identifier hs-type">goal1</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1141"></span><span>            </span><span class="annot"><a href="Agda.Mimer.Mimer.html#mimerTrace"><span class="hs-identifier hs-type">mimerTrace</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span>
</span><span id="line-1142"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Refining goal&quot;</span></span><span>
</span><span id="line-1143"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880885"><span class="hs-identifier hs-type">goal2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880886"><span class="hs-identifier hs-type">goalType2</span></a></span><span>
</span><span id="line-1144"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;in context&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-type">inTopContext</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-type">getContextTelescope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1145"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-1146"></span><span>
</span><span id="line-1147"></span><span>          </span><span class="annot"><a href="Agda.Mimer.Mimer.html#mimerTrace"><span class="hs-identifier hs-type">mimerTrace</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-1148"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Components:&quot;</span></span><span>
</span><span id="line-1149"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">concatMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">snd</span></span><span> </span><span class="annot"><a href="#local-6989586621681880889"><span class="hs-identifier hs-type">components</span></a></span><span>
</span><span id="line-1150"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1151"></span><span>
</span><span id="line-1152"></span><span>          </span><span id="local-6989586621681880890"><span class="annot"><a href="#local-6989586621681880890"><span class="hs-identifier hs-var">results1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryComponents"><span class="hs-identifier hs-type">tryComponents</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880885"><span class="hs-identifier hs-type">goal2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880886"><span class="hs-identifier hs-type">goalType2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880888"><span class="hs-identifier hs-type">branch3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880889"><span class="hs-identifier hs-type">components</span></a></span><span>
</span><span id="line-1153"></span><span>          </span><span id="local-6989586621681880891"><span class="annot"><a href="#local-6989586621681880891"><span class="hs-identifier hs-var">results2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryDataRecord"><span class="hs-identifier hs-type">tryDataRecord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880885"><span class="hs-identifier hs-type">goal2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880886"><span class="hs-identifier hs-type">goalType2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880888"><span class="hs-identifier hs-type">branch3</span></a></span><span>
</span><span id="line-1154"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621681880890"><span class="hs-identifier hs-type">results1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621681880891"><span class="hs-identifier hs-type">results2</span></a></span><span>
</span><span id="line-1155"></span><span>
</span><span id="line-1156"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryFns"><span class="hs-identifier hs-type">tryFns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1157"></span><span id="tryFns"><span class="annot"><span class="annottext">tryFns :: Goal -&gt; Type -&gt; SearchBranch -&gt; SM [SearchStepResult]
</span><a href="Agda.Mimer.Mimer.html#tryFns"><span class="hs-identifier hs-var hs-var">tryFns</span></a></span></span><span> </span><span id="local-6989586621681880894"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880894"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span id="local-6989586621681880895"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880895"><span class="hs-identifier hs-var">goalType</span></a></span></span><span> </span><span id="local-6989586621681880896"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880896"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch
-&gt; Goal -&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a. SearchBranch -&gt; Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-var">withBranchAndGoal</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880896"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880894"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">(SM [SearchStepResult] -&gt; SM [SearchStepResult])
-&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1158"></span><span>  </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.refine.fn&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Trying functions&quot;</span></span><span>
</span><span id="line-1159"></span><span>  </span><span id="local-6989586621681880897"><span class="annot"><a href="#local-6989586621681880897"><span class="hs-identifier hs-var">fns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; [Component])
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintFns"><span class="hs-identifier hs-var">hintFns</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseComponents -&gt; [Component])
-&gt; (SearchOptions -&gt; BaseComponents)
-&gt; SearchOptions
-&gt; [Component]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; BaseComponents
</span><a href="Agda.Mimer.Mimer.html#searchBaseComponents"><span class="hs-identifier hs-var">searchBaseComponents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1160"></span><span>  </span><span id="local-6989586621681880898"><span class="annot"><a href="#local-6989586621681880898"><span class="hs-identifier hs-var">newBranches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryRefineAddMetas"><span class="hs-identifier hs-type">tryRefineAddMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880894"><span class="hs-identifier hs-type">goal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880895"><span class="hs-identifier hs-type">goalType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880896"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880897"><span class="hs-identifier hs-type">fns</span></a></span><span>
</span><span id="line-1161"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#checkSolved"><span class="hs-identifier hs-type">checkSolved</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880898"><span class="hs-identifier hs-type">newBranches</span></a></span><span>
</span><span id="line-1162"></span><span>
</span><span id="line-1163"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryProjs"><span class="hs-identifier hs-type">tryProjs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1164"></span><span id="tryProjs"><span class="annot"><span class="annottext">tryProjs :: Goal -&gt; Type -&gt; SearchBranch -&gt; SM [SearchStepResult]
</span><a href="Agda.Mimer.Mimer.html#tryProjs"><span class="hs-identifier hs-var hs-var">tryProjs</span></a></span></span><span> </span><span id="local-6989586621681880901"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880901"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span id="local-6989586621681880902"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880902"><span class="hs-identifier hs-var">goalType</span></a></span></span><span> </span><span id="local-6989586621681880903"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880903"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch
-&gt; Goal -&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a. SearchBranch -&gt; Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-var">withBranchAndGoal</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880903"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880901"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">(SM [SearchStepResult] -&gt; SM [SearchStepResult])
-&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1165"></span><span>  </span><span id="local-6989586621681880904"><span class="annot"><a href="#local-6989586621681880904"><span class="hs-identifier hs-var">projs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; [Component])
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintProjections"><span class="hs-identifier hs-var">hintProjections</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseComponents -&gt; [Component])
-&gt; (SearchOptions -&gt; BaseComponents)
-&gt; SearchOptions
-&gt; [Component]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; BaseComponents
</span><a href="Agda.Mimer.Mimer.html#searchBaseComponents"><span class="hs-identifier hs-var">searchBaseComponents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1166"></span><span>  </span><span id="local-6989586621681880905"><span class="annot"><a href="#local-6989586621681880905"><span class="hs-identifier hs-var">newBranches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryRefineAddMetas"><span class="hs-identifier hs-type">tryRefineAddMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880901"><span class="hs-identifier hs-type">goal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880902"><span class="hs-identifier hs-type">goalType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880903"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880904"><span class="hs-identifier hs-type">projs</span></a></span><span>
</span><span id="line-1167"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#checkSolved"><span class="hs-identifier hs-type">checkSolved</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880905"><span class="hs-identifier hs-type">newBranches</span></a></span><span>
</span><span id="line-1168"></span><span>
</span><span id="line-1169"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryAxioms"><span class="hs-identifier hs-type">tryAxioms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1170"></span><span id="tryAxioms"><span class="annot"><span class="annottext">tryAxioms :: Goal -&gt; Type -&gt; SearchBranch -&gt; SM [SearchStepResult]
</span><a href="Agda.Mimer.Mimer.html#tryAxioms"><span class="hs-identifier hs-var hs-var">tryAxioms</span></a></span></span><span> </span><span id="local-6989586621681880907"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880907"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span id="local-6989586621681880908"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880908"><span class="hs-identifier hs-var">goalType</span></a></span></span><span> </span><span id="local-6989586621681880909"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880909"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch
-&gt; Goal -&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a. SearchBranch -&gt; Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-var">withBranchAndGoal</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880909"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880907"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">(SM [SearchStepResult] -&gt; SM [SearchStepResult])
-&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1171"></span><span>  </span><span id="local-6989586621681880910"><span class="annot"><a href="#local-6989586621681880910"><span class="hs-identifier hs-var">axioms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; [Component])
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintAxioms"><span class="hs-identifier hs-var">hintAxioms</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseComponents -&gt; [Component])
-&gt; (SearchOptions -&gt; BaseComponents)
-&gt; SearchOptions
-&gt; [Component]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; BaseComponents
</span><a href="Agda.Mimer.Mimer.html#searchBaseComponents"><span class="hs-identifier hs-var">searchBaseComponents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1172"></span><span>  </span><span id="local-6989586621681880911"><span class="annot"><a href="#local-6989586621681880911"><span class="hs-identifier hs-var">newBranches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryRefineAddMetas"><span class="hs-identifier hs-type">tryRefineAddMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880907"><span class="hs-identifier hs-type">goal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880908"><span class="hs-identifier hs-type">goalType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880909"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880910"><span class="hs-identifier hs-type">axioms</span></a></span><span>
</span><span id="line-1173"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#checkSolved"><span class="hs-identifier hs-type">checkSolved</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880911"><span class="hs-identifier hs-type">newBranches</span></a></span><span>
</span><span id="line-1174"></span><span>
</span><span id="line-1175"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryLet"><span class="hs-identifier hs-type">tryLet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1176"></span><span id="tryLet"><span class="annot"><span class="annottext">tryLet :: Goal -&gt; Type -&gt; SearchBranch -&gt; SM [SearchStepResult]
</span><a href="Agda.Mimer.Mimer.html#tryLet"><span class="hs-identifier hs-var hs-var">tryLet</span></a></span></span><span> </span><span id="local-6989586621681880913"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880913"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span id="local-6989586621681880914"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880914"><span class="hs-identifier hs-var">goalType</span></a></span></span><span> </span><span id="local-6989586621681880915"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880915"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch
-&gt; Goal -&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a. SearchBranch -&gt; Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-var">withBranchAndGoal</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880915"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880913"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">(SM [SearchStepResult] -&gt; SM [SearchStepResult])
-&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1177"></span><span>  </span><span id="local-6989586621681880916"><span class="annot"><a href="#local-6989586621681880916"><span class="hs-identifier hs-var">letVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; [Open Component])
-&gt; ReaderT SearchOptions (TCMT IO) [Open Component]
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Open Component]
</span><a href="Agda.Mimer.Mimer.html#hintLetVars"><span class="hs-identifier hs-var">hintLetVars</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseComponents -&gt; [Open Component])
-&gt; (SearchOptions -&gt; BaseComponents)
-&gt; SearchOptions
-&gt; [Open Component]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; BaseComponents
</span><a href="Agda.Mimer.Mimer.html#searchBaseComponents"><span class="hs-identifier hs-var">searchBaseComponents</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) [Open Component]
-&gt; ([Open Component]
    -&gt; ReaderT SearchOptions (TCMT IO) [Component])
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall a b.
ReaderT SearchOptions (TCMT IO) a
-&gt; (a -&gt; ReaderT SearchOptions (TCMT IO) b)
-&gt; ReaderT SearchOptions (TCMT IO) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Open Component -&gt; ReaderT SearchOptions (TCMT IO) Component)
-&gt; [Open Component] -&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Open Component -&gt; ReaderT SearchOptions (TCMT IO) Component
forall (tcm :: * -&gt; *).
(MonadTCM tcm, MonadDebug tcm) =&gt;
Open Component -&gt; tcm Component
</span><a href="Agda.Mimer.Mimer.html#getOpenComponent"><span class="hs-identifier hs-var">getOpenComponent</span></a></span><span>
</span><span id="line-1178"></span><span>  </span><span id="local-6989586621681880917"><span class="annot"><a href="#local-6989586621681880917"><span class="hs-identifier hs-var">newBranches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryRefineAddMetas"><span class="hs-identifier hs-type">tryRefineAddMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880913"><span class="hs-identifier hs-type">goal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880914"><span class="hs-identifier hs-type">goalType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880915"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880916"><span class="hs-identifier hs-type">letVars</span></a></span><span>
</span><span id="line-1179"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#checkSolved"><span class="hs-identifier hs-type">checkSolved</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880917"><span class="hs-identifier hs-type">newBranches</span></a></span><span>
</span><span id="line-1180"></span><span>
</span><span id="line-1181"></span><span class="annot"><span class="hs-comment">-- | Returns @Right@ for normal lambda abstraction and @Left@ for absurd lambda.</span></span><span>
</span><span id="line-1182"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryLamAbs"><span class="hs-identifier hs-type">tryLamAbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1183"></span><span id="tryLamAbs"><span class="annot"><span class="annottext">tryLamAbs :: Goal
-&gt; Type
-&gt; SearchBranch
-&gt; SM (Either SearchBranch (Goal, Type, SearchBranch))
</span><a href="Agda.Mimer.Mimer.html#tryLamAbs"><span class="hs-identifier hs-var hs-var">tryLamAbs</span></a></span></span><span> </span><span id="local-6989586621681880918"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880918"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span id="local-6989586621681880919"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880919"><span class="hs-identifier hs-var">goalType</span></a></span></span><span> </span><span id="local-6989586621681880920"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880920"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1184"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Term
forall t a. Type'' t a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880919"><span class="hs-identifier hs-var">goalType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1185"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span id="local-6989586621681880921"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880921"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621681880922"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681880922"><span class="hs-identifier hs-var">abs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ReaderT SearchOptions (TCMT IO) Bool
forall (tcm :: * -&gt; *). MonadTCM tcm =&gt; Type -&gt; tcm Bool
</span><a href="Agda.TypeChecking.Empty.html#isEmptyType"><span class="hs-identifier hs-var">isEmptyType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880921"><span class="hs-identifier hs-var">dom</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Bool
-&gt; (Bool -&gt; SM (Either SearchBranch (Goal, Type, SearchBranch)))
-&gt; SM (Either SearchBranch (Goal, Type, SearchBranch))
forall a b.
ReaderT SearchOptions (TCMT IO) a
-&gt; (a -&gt; ReaderT SearchOptions (TCMT IO) b)
-&gt; ReaderT SearchOptions (TCMT IO) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1186"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1187"></span><span>        </span><span id="local-6989586621681880923"><span class="annot"><a href="#local-6989586621681880923"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM QName -&gt; ReaderT SearchOptions (TCMT IO) QName
forall a. TCM a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM QName -&gt; ReaderT SearchOptions (TCMT IO) QName)
-&gt; TCM QName -&gt; ReaderT SearchOptions (TCMT IO) QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Dom Type -&gt; Abs Type -&gt; TCM QName
</span><a href="Agda.TypeChecking.Rules.Term.html#makeAbsurdLambda"><span class="hs-identifier hs-var">makeAbsurdLambda</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880921"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681880922"><span class="hs-identifier hs-var">abs</span></a></span><span>
</span><span id="line-1188"></span><span>        </span><span id="local-6989586621681880924"><span class="annot"><a href="#local-6989586621681880924"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContextArgs"><span class="hs-identifier hs-type">getContextArgs</span></a></span><span>
</span><span id="line-1189"></span><span>        </span><span id="local-6989586621681880925"><span class="annot"><a href="#local-6989586621681880925"><span class="hs-identifier hs-var">newMetaIds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#assignMeta"><span class="hs-identifier hs-type">assignMeta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880918"><span class="hs-identifier hs-type">goal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880923"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880924"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880919"><span class="hs-identifier hs-type">goalType</span></a></span><span>
</span><span id="line-1190"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#updateBranch"><span class="hs-identifier hs-type">updateBranch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880925"><span class="hs-identifier hs-type">newMetaIds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880920"><span class="hs-identifier hs-type">branch</span></a></span><span>
</span><span id="line-1191"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1192"></span><span>        </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.lam&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Trying lambda abstraction for pi type&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880919"><span class="hs-identifier hs-var">goalType</span></a></span><span>
</span><span id="line-1193"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880927"><span class="annot"><span class="annottext">abs' :: Abs Type
</span><a href="#local-6989586621681880927"><span class="hs-identifier hs-var hs-var hs-var">abs'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; Bool
forall a. IsNoName a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var">isNoName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Type -&gt; ArgName
forall a. Abs a -&gt; ArgName
</span><a href="Agda.Syntax.Internal.html#absName"><span class="hs-identifier hs-var">absName</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681880922"><span class="hs-identifier hs-var">abs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681880922"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#absName"><span class="hs-identifier hs-var">absName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;z&quot;</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1194"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681880922"><span class="hs-identifier hs-var">abs</span></a></span><span>
</span><span id="line-1195"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681880930"><span class="annot"><a href="#local-6989586621681880930"><span class="hs-identifier hs-var">metaId'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880931"><span class="annot"><a href="#local-6989586621681880931"><span class="hs-identifier hs-var">bodyType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880932"><span class="annot"><a href="#local-6989586621681880932"><span class="hs-identifier hs-var">metaTerm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880933"><span class="annot"><a href="#local-6989586621681880933"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dom Type
-&gt; Abs Type
-&gt; (Type
    -&gt; ReaderT SearchOptions (TCMT IO) (MetaId, Type, Term, TCEnv))
-&gt; ReaderT SearchOptions (TCMT IO) (MetaId, Type, Term, TCEnv)
forall a (m :: * -&gt; *) b.
(Subst a, MonadAddContext m) =&gt;
Dom Type -&gt; Abs a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="Agda.TypeChecking.Monad.Context.html#underAbstractionAbs"><span class="hs-identifier hs-var">underAbstractionAbs</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880921"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681880927"><span class="hs-identifier hs-var">abs'</span></a></span><span> </span><span class="annot"><span class="annottext">((Type
  -&gt; ReaderT SearchOptions (TCMT IO) (MetaId, Type, Term, TCEnv))
 -&gt; ReaderT SearchOptions (TCMT IO) (MetaId, Type, Term, TCEnv))
-&gt; (Type
    -&gt; ReaderT SearchOptions (TCMT IO) (MetaId, Type, Term, TCEnv))
-&gt; ReaderT SearchOptions (TCMT IO) (MetaId, Type, Term, TCEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681880935"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880935"><span class="hs-identifier hs-var">bodyType</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1196"></span><span>          </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.lam&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;  bodyType = &quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880935"><span class="hs-identifier hs-var">bodyType</span></a></span><span>
</span><span id="line-1197"></span><span>          </span><span id="local-6989586621681880936"><span class="annot"><a href="#local-6989586621681880936"><span class="hs-identifier hs-var">bodyType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Phase]
-&gt; ReaderT SearchOptions (TCMT IO) Type
-&gt; ReaderT SearchOptions (TCMT IO) Type
forall a. NFData a =&gt; [Phase] -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#bench"><span class="hs-identifier hs-var">bench</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Phase
</span><a href="Agda.Benchmarking.html#Reduce"><span class="hs-identifier hs-var">Bench.Reduce</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Type
 -&gt; ReaderT SearchOptions (TCMT IO) Type)
-&gt; ReaderT SearchOptions (TCMT IO) Type
-&gt; ReaderT SearchOptions (TCMT IO) Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ReaderT SearchOptions (TCMT IO) Type
forall a (m :: * -&gt; *). (Reduce a, MonadReduce m) =&gt; a -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#reduce"><span class="hs-identifier hs-var">reduce</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681880935"><span class="hs-identifier hs-var">bodyType</span></a></span><span> </span><span class="hs-comment">-- TODO: Good place to reduce?</span><span>
</span><span id="line-1198"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.lam&quot;</span></span><span> </span><span class="annot"><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;  bodyType (reduced) = &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880936"><span class="hs-identifier hs-type">bodyType</span></a></span><span>
</span><span id="line-1199"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621681880937"><span class="annot"><a href="#local-6989586621681880937"><span class="hs-identifier hs-var">metaId'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880938"><span class="annot"><a href="#local-6989586621681880938"><span class="hs-identifier hs-var">metaTerm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#bench"><span class="hs-identifier hs-type">bench</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Benchmarking.html#Free"><span class="hs-identifier hs-type">Bench.Free</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.MetaVars.html#newValueMeta"><span class="hs-identifier hs-type">newValueMeta</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DontRunMetaOccursCheck"><span class="hs-identifier hs-type">DontRunMetaOccursCheck</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.Types.html#CmpLeq"><span class="hs-identifier hs-type">CmpLeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880936"><span class="hs-identifier hs-type">bodyType</span></a></span><span>
</span><span id="line-1200"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.lam&quot;</span></span><span> </span><span class="annot"><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;  metaId' = &quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880937"><span class="hs-identifier hs-type">metaId'</span></a></span><span>
</span><span id="line-1201"></span><span>          </span><span id="local-6989586621681880940"><span class="annot"><a href="#local-6989586621681880940"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#askTC"><span class="hs-identifier hs-type">askTC</span></a></span><span>
</span><span id="line-1202"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880937"><span class="hs-identifier hs-type">metaId'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681880936"><span class="hs-identifier hs-type">bodyType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681880938"><span class="hs-identifier hs-type">metaTerm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681880940"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1203"></span><span>
</span><span id="line-1204"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880941"><span class="annot"><a href="#local-6989586621681880941"><span class="hs-identifier hs-var hs-var">argInf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; ArgInfo
forall t e. Dom' t e -&gt; ArgInfo
</span><a href="Agda.Syntax.Internal.html#domInfo"><span class="hs-identifier hs-var">domInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681880921"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="hs-comment">-- TODO: is this the correct arg info?</span><span>
</span><span id="line-1205"></span><span>            </span><span id="local-6989586621681880943"><span class="annot"><a href="#local-6989586621681880943"><span class="hs-identifier hs-var hs-var">newAbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; Term -&gt; Abs Term
forall a. ArgName -&gt; a -&gt; Abs a
</span><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-var">Abs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Type -&gt; ArgName
forall a. Abs a -&gt; ArgName
</span><a href="Agda.Syntax.Internal.html#absName"><span class="hs-identifier hs-var">absName</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681880927"><span class="hs-identifier hs-var">abs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880932"><span class="hs-identifier hs-var">metaTerm</span></a></span><span>
</span><span id="line-1206"></span><span>            </span><span class="hs-comment">-- look at mkLam</span><span>
</span><span id="line-1207"></span><span>            </span><span id="local-6989586621681880945"><span class="annot"><a href="#local-6989586621681880945"><span class="hs-identifier hs-var hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Abs Term -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681880941"><span class="hs-identifier hs-var">argInf</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Term
</span><a href="#local-6989586621681880943"><span class="hs-identifier hs-var">newAbs</span></a></span><span>
</span><span id="line-1208"></span><span>
</span><span id="line-1209"></span><span>        </span><span id="local-6989586621681880947"><span class="annot"><a href="#local-6989586621681880947"><span class="hs-identifier hs-var">newMetaIds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#assignMeta"><span class="hs-identifier hs-type">assignMeta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880918"><span class="hs-identifier hs-type">goal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880945"><span class="hs-identifier hs-type">term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880919"><span class="hs-identifier hs-type">goalType</span></a></span><span>
</span><span id="line-1210"></span><span>
</span><span id="line-1211"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Env.html#withEnv"><span class="hs-identifier hs-type">withEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880933"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1212"></span><span>          </span><span id="local-6989586621681880949"><span class="annot"><a href="#local-6989586621681880949"><span class="hs-identifier hs-var">branch'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#updateBranch"><span class="hs-identifier hs-type">updateBranch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880947"><span class="hs-identifier hs-type">newMetaIds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880920"><span class="hs-identifier hs-type">branch</span></a></span><span>
</span><span id="line-1213"></span><span>          </span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryLamAbs"><span class="hs-identifier hs-type">tryLamAbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880930"><span class="hs-identifier hs-type">metaId'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880931"><span class="hs-identifier hs-type">bodyType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880949"><span class="hs-identifier hs-type">branch'</span></a></span><span>
</span><span id="line-1214"></span><span>    </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SM (Either SearchBranch (Goal, Type, SearchBranch))
</span><a href="#local-6989586621681880950"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-1215"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1216"></span><span>    </span><span id="local-6989586621681880950"><span class="annot"><span class="annottext">done :: SM (Either SearchBranch (Goal, Type, SearchBranch))
</span><a href="#local-6989586621681880950"><span class="hs-identifier hs-var hs-var">done</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1217"></span><span>      </span><span id="local-6989586621681880951"><span class="annot"><a href="#local-6989586621681880951"><span class="hs-identifier hs-var">branch'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MetaId] -&gt; SearchBranch -&gt; SM SearchBranch
</span><a href="Agda.Mimer.Mimer.html#updateBranch"><span class="hs-identifier hs-var">updateBranch</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681880920"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="hs-comment">-- TODO: Is this necessary?</span><span>
</span><span id="line-1218"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880918"><span class="hs-identifier hs-type">goal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681880919"><span class="hs-identifier hs-type">goalType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681880951"><span class="hs-identifier hs-type">branch'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1219"></span><span>
</span><span id="line-1220"></span><span>
</span><span id="line-1221"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#genRecCalls"><span class="hs-identifier hs-type">genRecCalls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1222"></span><span id="genRecCalls"><span class="annot"><span class="annottext">genRecCalls :: Component -&gt; ReaderT SearchOptions (TCMT IO) [Component]
</span><a href="Agda.Mimer.Mimer.html#genRecCalls"><span class="hs-identifier hs-var hs-var">genRecCalls</span></a></span></span><span> </span><span id="local-6989586621681880952"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880952"><span class="hs-identifier hs-var">thisFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1223"></span><span>  </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.components.open&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Generating recursive calls for component&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; VerboseLevel -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compId"><span class="hs-identifier hs-var">compId</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880952"><span class="hs-identifier hs-var">thisFn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Maybe Name -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Maybe Name
</span><a href="Agda.Mimer.Mimer.html#compName"><span class="hs-identifier hs-var">compName</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880952"><span class="hs-identifier hs-var">thisFn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1224"></span><span>  </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.components.open&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;  checkpoint =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointId -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; CheckpointId -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckpointId -&gt; TCMT IO Doc)
-&gt; TCMT IO CheckpointId -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' TCEnv CheckpointId -&gt; TCMT IO CheckpointId
forall (m :: * -&gt; *) a. MonadTCEnv m =&gt; Lens' TCEnv a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#viewTC"><span class="hs-identifier hs-var">viewTC</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckpointId -&gt; f CheckpointId) -&gt; TCEnv -&gt; f TCEnv
Lens' TCEnv CheckpointId
</span><a href="Agda.TypeChecking.Monad.Base.html#eCurrentCheckpoint"><span class="hs-identifier hs-var">eCurrentCheckpoint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1225"></span><span>  </span><span class="hs-comment">-- TODO: Make sure there are no pruning problems</span><span>
</span><span id="line-1226"></span><span>  </span><span class="annot"><span class="annottext">(SearchOptions -&gt; Open [(Term, NoSubst Term VerboseLevel)])
-&gt; ReaderT
     SearchOptions (TCMT IO) (Open [(Term, NoSubst Term VerboseLevel)])
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; Open [(Term, NoSubst Term VerboseLevel)]
</span><a href="Agda.Mimer.Mimer.html#hintRecVars"><span class="hs-identifier hs-var">hintRecVars</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseComponents -&gt; Open [(Term, NoSubst Term VerboseLevel)])
-&gt; (SearchOptions -&gt; BaseComponents)
-&gt; SearchOptions
-&gt; Open [(Term, NoSubst Term VerboseLevel)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; BaseComponents
</span><a href="Agda.Mimer.Mimer.html#searchBaseComponents"><span class="hs-identifier hs-var">searchBaseComponents</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReaderT
  SearchOptions (TCMT IO) (Open [(Term, NoSubst Term VerboseLevel)])
-&gt; (Open [(Term, NoSubst Term VerboseLevel)]
    -&gt; ReaderT
         SearchOptions (TCMT IO) [(Term, NoSubst Term VerboseLevel)])
-&gt; ReaderT
     SearchOptions (TCMT IO) [(Term, NoSubst Term VerboseLevel)]
forall a b.
ReaderT SearchOptions (TCMT IO) a
-&gt; (a -&gt; ReaderT SearchOptions (TCMT IO) b)
-&gt; ReaderT SearchOptions (TCMT IO) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Open [(Term, NoSubst Term VerboseLevel)]
-&gt; ReaderT
     SearchOptions (TCMT IO) [(Term, NoSubst Term VerboseLevel)]
forall a (m :: * -&gt; *).
(TermSubst a, MonadTCEnv m) =&gt;
Open a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Open.html#getOpen"><span class="hs-identifier hs-var">getOpen</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) [(Term, NoSubst Term VerboseLevel)]
-&gt; ([(Term, NoSubst Term VerboseLevel)]
    -&gt; ReaderT SearchOptions (TCMT IO) [Component])
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall a b.
ReaderT SearchOptions (TCMT IO) a
-&gt; (a -&gt; ReaderT SearchOptions (TCMT IO) b)
-&gt; ReaderT SearchOptions (TCMT IO) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1227"></span><span>    </span><span class="hs-comment">-- No candidate arguments for a recursive call</span><span>
</span><span id="line-1228"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Component] -&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1229"></span><span>    </span><span id="local-6989586621681880955"><span class="annot"><span class="annottext">[(Term, NoSubst Term VerboseLevel)]
</span><a href="#local-6989586621681880955"><span class="hs-identifier hs-var">recCandTerms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1230"></span><span>      </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Costs"><span class="hs-identifier hs-type">Costs</span></a></span><span class="hs-special">{</span><span id="local-6989586621681880956"><span id="local-6989586621681880957"><span id="local-6989586621681880958"><span id="local-6989586621681880959"><span id="local-6989586621681880960"><span id="local-6989586621681880961"><span id="local-6989586621681880962"><span id="local-6989586621681880963"><span id="local-6989586621681880964"><span id="local-6989586621681880965"><span id="local-6989586621681880966"><span id="local-6989586621681880967"><span id="local-6989586621681880968"><span id="local-6989586621681880969"><span class="annot"><a href="Agda.Mimer.Mimer.html#costLocal"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; Costs) -&gt; ReaderT SearchOptions (TCMT IO) Costs
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; Costs
</span><a href="Agda.Mimer.Mimer.html#searchCosts"><span class="hs-identifier hs-var">searchCosts</span></a></span><span>
</span><span id="line-1231"></span><span>      </span><span id="local-6989586621681880970"><span class="annot"><a href="#local-6989586621681880970"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#localVarCount"><span class="hs-identifier hs-type">localVarCount</span></a></span><span>
</span><span id="line-1232"></span><span>      </span><span id="local-6989586621681880971"><span class="annot"><a href="#local-6989586621681880971"><span class="hs-identifier hs-var">localVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#getLocalVars"><span class="hs-identifier hs-type">getLocalVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880970"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880956"><span class="hs-identifier hs-type">costLocal</span></a></span><span>
</span><span id="line-1233"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880972"><span class="annot"><a href="#local-6989586621681880972"><span class="hs-identifier hs-var hs-var">recCands</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880973"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880974"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681880973"><span class="annot"><span class="annottext">t :: Component
</span><a href="#local-6989586621681880973"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621681880975"><span class="annot"><span class="annottext">v :: Term
</span><a href="#local-6989586621681880975"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Component]
</span><a href="#local-6989586621681880971"><span class="hs-identifier hs-var">localVars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#NoSubst"><span class="hs-identifier hs-type">NoSubst</span></a></span><span> </span><span id="local-6989586621681880974"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880974"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (NoSubst Term VerboseLevel) -&gt; [NoSubst Term VerboseLevel]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (NoSubst Term VerboseLevel) -&gt; [NoSubst Term VerboseLevel])
-&gt; Maybe (NoSubst Term VerboseLevel) -&gt; [NoSubst Term VerboseLevel]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term
-&gt; [(Term, NoSubst Term VerboseLevel)]
-&gt; Maybe (NoSubst Term VerboseLevel)
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681880975"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[(Term, NoSubst Term VerboseLevel)]
</span><a href="#local-6989586621681880955"><span class="hs-identifier hs-var">recCandTerms</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1234"></span><span>
</span><span id="line-1235"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880977"><span class="annot"><a href="#local-6989586621681880977"><span class="hs-identifier hs-var hs-var">newRecCall</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1236"></span><span>            </span><span class="hs-comment">-- Apply the recursive call to new metas</span><span>
</span><span id="line-1237"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621681880978"><span class="annot"><a href="#local-6989586621681880978"><span class="hs-identifier hs-var">thisFnTerm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880979"><span class="annot"><a href="#local-6989586621681880979"><span class="hs-identifier hs-var">thisFnType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880980"><span class="annot"><a href="#local-6989586621681880980"><span class="hs-identifier hs-var">newMetas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Term -&gt; Type -&gt; SM (Term, Type, [MetaId])
</span><a href="Agda.Mimer.Mimer.html#applyToMetas"><span class="hs-identifier hs-var">applyToMetas</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880952"><span class="hs-identifier hs-var">thisFn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Type
</span><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880952"><span class="hs-identifier hs-var">thisFn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1238"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681880982"><span class="annot"><a href="#local-6989586621681880982"><span class="hs-identifier hs-var hs-var">argGoals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MetaId -&gt; Goal) -&gt; [MetaId] -&gt; [Goal]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Goal
</span><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-var">Goal</span></a></span><span> </span><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621681880980"><span class="hs-identifier hs-var">newMetas</span></a></span><span>
</span><span id="line-1239"></span><span>            </span><span id="local-6989586621681880983"><span class="annot"><a href="#local-6989586621681880983"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#newComponent"><span class="hs-identifier hs-type">newComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880980"><span class="hs-identifier hs-type">newMetas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var">compCost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880952"><span class="hs-identifier hs-type">thisFn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#compName"><span class="hs-identifier hs-var">compName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880952"><span class="hs-identifier hs-type">thisFn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="#local-6989586621681880978"><span class="hs-identifier hs-type">thisFnTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880979"><span class="hs-identifier hs-type">thisFnType</span></a></span><span>
</span><span id="line-1240"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681880983"><span class="hs-identifier hs-type">comp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">zip</span></span><span> </span><span class="annot"><a href="#local-6989586621681880982"><span class="hs-identifier hs-type">argGoals</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1241"></span><span>
</span><span id="line-1242"></span><span>          </span><span class="hs-comment">-- go :: Component -- ^ Recursive call function applied to meta-variables</span><span>
</span><span id="line-1243"></span><span>          </span><span class="hs-comment">--   -&gt; [(Goal, Int)] -- ^ Remaining parameters to try to fill</span><span>
</span><span id="line-1244"></span><span>          </span><span class="hs-comment">--   -&gt; [(Component, Int)] -- ^ Remaining argument candidates for the current parameter</span><span>
</span><span id="line-1245"></span><span>          </span><span class="hs-comment">--   -&gt; SM [Component]</span><span>
</span><span id="line-1246"></span><span>          </span><span id="local-6989586621681880984"><span class="annot"><a href="#local-6989586621681880984"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681880985"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880985"><span class="hs-identifier hs-var">_thisFn</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621681880986"><span class="annot"><span class="annottext">[(Component, VerboseLevel)]
</span><a href="#local-6989586621681880986"><span class="hs-identifier hs-var">_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Component] -&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1247"></span><span>          </span><span class="annot"><a href="#local-6989586621681880984"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681880987"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880987"><span class="hs-identifier hs-var">thisFn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Goal, VerboseLevel)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681880988"><span class="annot"><span class="annottext">[(Goal, VerboseLevel)]
</span><a href="#local-6989586621681880988"><span class="hs-identifier hs-var">goals</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Component
-&gt; [(Goal, VerboseLevel)]
-&gt; [(Component, VerboseLevel)]
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
</span><a href="#local-6989586621681880984"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880987"><span class="hs-identifier hs-var">thisFn</span></a></span><span> </span><span class="annot"><span class="annottext">[(Goal, VerboseLevel)]
</span><a href="#local-6989586621681880988"><span class="hs-identifier hs-var">goals</span></a></span><span> </span><span class="annot"><span class="annottext">[(Component, VerboseLevel)]
</span><a href="#local-6989586621681880972"><span class="hs-identifier hs-var">recCands</span></a></span><span>
</span><span id="line-1248"></span><span>          </span><span class="annot"><a href="#local-6989586621681880984"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681880989"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880989"><span class="hs-identifier hs-var">thisFn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681880990"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880990"><span class="hs-identifier hs-var">goal</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880991"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880991"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681880992"><span class="annot"><span class="annottext">[(Goal, VerboseLevel)]
</span><a href="#local-6989586621681880992"><span class="hs-identifier hs-var">goals</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681880993"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880993"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681880994"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880994"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681880995"><span class="annot"><span class="annottext">[(Component, VerboseLevel)]
</span><a href="#local-6989586621681880995"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880991"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880994"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1249"></span><span>            </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#reportSMDoc"><span class="hs-identifier hs-var">reportSMDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.components.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">80</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Doc
 -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ReaderT SearchOptions (TCMT IO) Doc]
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span>
</span><span id="line-1250"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;Trying to generate recursive call&quot;</span></span><span>
</span><span id="line-1251"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Term -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880989"><span class="hs-identifier hs-var">thisFn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1252"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;with&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Term -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880993"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1253"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;for&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; MetaId -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Goal -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880990"><span class="hs-identifier hs-var">goal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1254"></span><span>            </span><span id="local-6989586621681880997"><span class="annot"><a href="#local-6989586621681880997"><span class="hs-identifier hs-var">goalType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; ReaderT SearchOptions (TCMT IO) Type
forall (m :: * -&gt; *).
(HasBuiltins m, HasCallStack, MonadDebug m, MonadReduce m,
 MonadTCEnv m, ReadTCState m) =&gt;
MetaId -&gt; m Type
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#getMetaTypeInContext"><span class="hs-identifier hs-var">getMetaTypeInContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Goal -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880990"><span class="hs-identifier hs-var">goal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1255"></span><span>            </span><span id="local-6989586621681880998"><span class="annot"><a href="#local-6989586621681880998"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#getTC"><span class="hs-identifier hs-type">getTC</span></a></span><span>
</span><span id="line-1256"></span><span>            </span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryRefineWith%27"><span class="hs-identifier hs-type">tryRefineWith'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880990"><span class="hs-identifier hs-type">goal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880997"><span class="hs-identifier hs-type">goalType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880993"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1257"></span><span>              </span><span class="annot"><span class="annottext">Maybe ([MetaId], [MetaId])
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1258"></span><span>                </span><span class="annot"><span class="annottext">TCState -&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *). MonadTCState m =&gt; TCState -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#putTC"><span class="hs-identifier hs-var">putTC</span></a></span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681880998"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-1259"></span><span>                </span><span class="annot"><span class="annottext">Component
-&gt; [(Goal, VerboseLevel)]
-&gt; [(Component, VerboseLevel)]
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
</span><a href="#local-6989586621681880984"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880989"><span class="hs-identifier hs-var">thisFn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681880990"><span class="hs-identifier hs-var">goal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880991"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Goal, VerboseLevel)
-&gt; [(Goal, VerboseLevel)] -&gt; [(Goal, VerboseLevel)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Goal, VerboseLevel)]
</span><a href="#local-6989586621681880992"><span class="hs-identifier hs-var">goals</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Component, VerboseLevel)]
</span><a href="#local-6989586621681880995"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1260"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681881000"><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621681881000"><span class="hs-identifier hs-var">newMetas1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881001"><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621681881001"><span class="hs-identifier hs-var">newMetas2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1261"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881002"><span class="annot"><span class="annottext">newComp :: Component
</span><a href="#local-6989586621681881002"><span class="hs-identifier hs-var hs-var hs-var">newComp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681880989"><span class="hs-identifier hs-var">thisFn</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#compMetas"><span class="hs-identifier hs-var">compMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681881000"><span class="hs-identifier hs-type">newMetas1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621681881001"><span class="hs-identifier hs-type">newMetas2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#compMetas"><span class="hs-identifier hs-var">compMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880989"><span class="hs-identifier hs-type">thisFn</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">\\</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880990"><span class="hs-identifier hs-type">goal</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-1262"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621681881003"><span class="annot"><a href="#local-6989586621681881003"><span class="hs-identifier hs-var">thisFn'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881004"><span class="annot"><a href="#local-6989586621681881004"><span class="hs-identifier hs-var">goals'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) (Component, [(Goal, VerboseLevel)])
</span><a href="#local-6989586621681880977"><span class="hs-identifier hs-var">newRecCall</span></a></span><span>
</span><span id="line-1263"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">newComp</span></span><span class="annot"><span class="hs-glyph">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621681880984"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881003"><span class="hs-identifier hs-type">thisFn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">length</span></span><span> </span><span class="annot"><a href="#local-6989586621681881004"><span class="hs-identifier hs-type">goals'</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">length</span></span><span> </span><span class="annot"><a href="#local-6989586621681880992"><span class="hs-identifier hs-type">goals</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681881004"><span class="hs-identifier hs-type">goals'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681880995"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-1264"></span><span>          </span><span class="annot"><a href="#local-6989586621681880984"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681881005"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881005"><span class="hs-identifier hs-var">thisFn</span></a></span></span><span> </span><span id="local-6989586621681881006"><span class="annot"><span class="annottext">[(Goal, VerboseLevel)]
</span><a href="#local-6989586621681881006"><span class="hs-identifier hs-var">goals</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Component, VerboseLevel)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681881007"><span class="annot"><span class="annottext">[(Component, VerboseLevel)]
</span><a href="#local-6989586621681881007"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Component
-&gt; [(Goal, VerboseLevel)]
-&gt; [(Component, VerboseLevel)]
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
</span><a href="#local-6989586621681880984"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881005"><span class="hs-identifier hs-var">thisFn</span></a></span><span> </span><span class="annot"><span class="annottext">[(Goal, VerboseLevel)]
</span><a href="#local-6989586621681881006"><span class="hs-identifier hs-var">goals</span></a></span><span> </span><span class="annot"><span class="annottext">[(Component, VerboseLevel)]
</span><a href="#local-6989586621681881007"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1265"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681881008"><span class="annot"><a href="#local-6989586621681881008"><span class="hs-identifier hs-var">thisFn'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881009"><span class="annot"><a href="#local-6989586621681881009"><span class="hs-identifier hs-var">argGoals</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681880977"><span class="hs-identifier hs-type">newRecCall</span></a></span><span>
</span><span id="line-1266"></span><span>      </span><span id="local-6989586621681881010"><span class="annot"><a href="#local-6989586621681881010"><span class="hs-identifier hs-var">comps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681880984"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881008"><span class="hs-identifier hs-type">thisFn'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881009"><span class="hs-identifier hs-type">argGoals</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681880972"><span class="hs-identifier hs-type">recCands</span></a></span><span>
</span><span id="line-1267"></span><span>      </span><span class="hs-comment">-- Compute costs for the calls:</span><span>
</span><span id="line-1268"></span><span>      </span><span class="hs-comment">--  - costNewMeta/costNewHiddenMeta for each unsolved argument</span><span>
</span><span id="line-1269"></span><span>      </span><span class="hs-comment">--  - zero for solved arguments</span><span>
</span><span id="line-1270"></span><span>      </span><span class="hs-comment">--  - costLocal for the parameter we recurse on</span><span>
</span><span id="line-1271"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881011"><span class="annot"><a href="#local-6989586621681881011"><span class="hs-identifier hs-var hs-var">callCost</span></a></span></span><span> </span><span id="local-6989586621681881012"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881012"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880956"><span class="hs-identifier hs-var">costLocal</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; VerboseLevel)
-&gt; ([VerboseLevel] -&gt; VerboseLevel)
-&gt; [VerboseLevel]
-&gt; VerboseLevel
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[VerboseLevel] -&gt; VerboseLevel
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([VerboseLevel] -&gt; VerboseLevel)
-&gt; ReaderT SearchOptions (TCMT IO) [VerboseLevel]
-&gt; SM VerboseLevel
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; ReaderT SearchOptions (TCMT IO) [VerboseLevel]
</span><a href="#local-6989586621681881013"><span class="hs-identifier hs-var">argCosts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881012"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1272"></span><span>          </span><span id="local-6989586621681881013"><span class="annot"><a href="#local-6989586621681881013"><span class="hs-identifier hs-var hs-var">argCosts</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681881014"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681881014"><span class="hs-identifier hs-var">elims</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Elim' Term -&gt; SM VerboseLevel)
-&gt; Elims -&gt; ReaderT SearchOptions (TCMT IO) [VerboseLevel]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Elim' Term -&gt; SM VerboseLevel
</span><a href="#local-6989586621681881015"><span class="hs-identifier hs-var">argCost</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681881014"><span class="hs-identifier hs-var">elims</span></a></span><span>
</span><span id="line-1273"></span><span>          </span><span class="annot"><a href="#local-6989586621681881013"><span class="hs-identifier hs-var">argCosts</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) [VerboseLevel]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1274"></span><span>          </span><span id="local-6989586621681881015"><span class="annot"><a href="#local-6989586621681881015"><span class="hs-identifier hs-var hs-var">argCost</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span id="local-6989586621681881016"><span class="annot"><span class="annottext">Arg Term
</span><a href="#local-6989586621681881016"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arg Term -&gt; ReaderT SearchOptions (TCMT IO) (Arg Term)
forall a (m :: * -&gt; *). (Instantiate a, MonadReduce m) =&gt; a -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#instantiate"><span class="hs-identifier hs-var">instantiate</span></a></span><span> </span><span class="annot"><span class="annottext">Arg Term
</span><a href="#local-6989586621681881016"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) (Arg Term)
-&gt; (Arg Term -&gt; VerboseLevel) -&gt; SM VerboseLevel
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span>
</span><span id="line-1275"></span><span>            </span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span id="local-6989586621681881018"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681881018"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Bool
forall a. LensHiding a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#visible"><span class="hs-identifier hs-var">visible</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681881018"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880967"><span class="hs-identifier hs-var">costNewMeta</span></a></span><span>
</span><span id="line-1276"></span><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681880968"><span class="hs-identifier hs-var">costNewHiddenMeta</span></a></span><span>
</span><span id="line-1277"></span><span>            </span><span class="annot"><span class="annottext">Arg Term
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1278"></span><span>          </span><span class="annot"><a href="#local-6989586621681881015"><span class="hs-identifier hs-var">argCost</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Proj"><span class="hs-identifier hs-type">Proj</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; SM VerboseLevel
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1279"></span><span>          </span><span class="annot"><a href="#local-6989586621681881015"><span class="hs-identifier hs-var">argCost</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#IApply"><span class="hs-identifier hs-type">IApply</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; SM VerboseLevel
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1280"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681881020"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881020"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; Component -&gt; Component
</span><a href="Agda.Mimer.Mimer.html#addCost"><span class="hs-operator hs-var">`addCost`</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881020"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Component)
-&gt; SM VerboseLevel -&gt; ReaderT SearchOptions (TCMT IO) Component
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Component -&gt; SM VerboseLevel
</span><a href="#local-6989586621681881011"><span class="hs-identifier hs-var">callCost</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881020"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681881010"><span class="hs-identifier hs-type">comps</span></a></span><span>
</span><span id="line-1281"></span><span>
</span><span id="line-1282"></span><span>
</span><span id="line-1283"></span><span class="hs-comment">-- TODO: Factor out `checkSolved`</span><span>
</span><span id="line-1284"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryDataRecord"><span class="hs-identifier hs-type">tryDataRecord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1285"></span><span id="tryDataRecord"><span class="annot"><span class="annottext">tryDataRecord :: Goal -&gt; Type -&gt; SearchBranch -&gt; SM [SearchStepResult]
</span><a href="Agda.Mimer.Mimer.html#tryDataRecord"><span class="hs-identifier hs-var hs-var">tryDataRecord</span></a></span></span><span> </span><span id="local-6989586621681881021"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681881021"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span id="local-6989586621681881022"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881022"><span class="hs-identifier hs-var">goalType</span></a></span></span><span> </span><span id="local-6989586621681881023"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881023"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch
-&gt; Goal -&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a. SearchBranch -&gt; Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-var">withBranchAndGoal</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881023"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681881021"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">(SM [SearchStepResult] -&gt; SM [SearchStepResult])
-&gt; SM [SearchStepResult] -&gt; SM [SearchStepResult]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1286"></span><span>  </span><span class="hs-comment">-- TODO: There is a `isRecord` function, which performs a similar case</span><span>
</span><span id="line-1287"></span><span>  </span><span class="hs-comment">-- analysis as here, but it does not work for data types.</span><span>
</span><span id="line-1288"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Term
forall t a. Type'' t a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881022"><span class="hs-identifier hs-var">goalType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1289"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621681881024"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681881024"><span class="hs-identifier hs-var">qname</span></a></span></span><span> </span><span id="local-6989586621681881025"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681881025"><span class="hs-identifier hs-var">elims</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; Defn)
-&gt; ReaderT SearchOptions (TCMT IO) Definition
-&gt; ReaderT SearchOptions (TCMT IO) Defn
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT SearchOptions (TCMT IO) Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681881024"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Defn
-&gt; (Defn -&gt; SM [SearchStepResult]) -&gt; SM [SearchStepResult]
forall a b.
ReaderT SearchOptions (TCMT IO) a
-&gt; (a -&gt; ReaderT SearchOptions (TCMT IO) b)
-&gt; ReaderT SearchOptions (TCMT IO) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1290"></span><span>      </span><span id="local-6989586621681881026"><span class="annot"><span class="annottext">recordDefn :: Defn
</span><a href="#local-6989586621681881026"><span class="hs-identifier hs-var">recordDefn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1291"></span><span>        </span><span class="annot"><span class="annottext">Defn -&gt; SM [SearchStepResult]
</span><a href="#local-6989586621681881027"><span class="hs-identifier hs-var">tryRecord</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681881026"><span class="hs-identifier hs-var">recordDefn</span></a></span><span>
</span><span id="line-1292"></span><span>      </span><span id="local-6989586621681881028"><span class="annot"><span class="annottext">dataDefn :: Defn
</span><a href="#local-6989586621681881028"><span class="hs-identifier hs-var">dataDefn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1293"></span><span>        </span><span class="annot"><span class="annottext">Defn -&gt; SM [SearchStepResult]
</span><a href="#local-6989586621681881029"><span class="hs-identifier hs-var">tryData</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681881028"><span class="hs-identifier hs-var">dataDefn</span></a></span><span>
</span><span id="line-1294"></span><span>      </span><span id="local-6989586621681881030"><span class="annot"><span class="annottext">primitive :: Defn
</span><a href="#local-6989586621681881030"><span class="hs-identifier hs-var">primitive</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1295"></span><span>        </span><span class="annot"><span class="annottext">[SearchStepResult] -&gt; SM [SearchStepResult]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1296"></span><span>      </span><span class="hs-comment">-- TODO: Better way of checking that type is Level</span><span>
</span><span id="line-1297"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-1298"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; ArgName
forall a. Pretty a =&gt; a -&gt; ArgName
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">P.prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681881024"><span class="hs-identifier hs-var">qname</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;Agda.Primitive.Level&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1299"></span><span>            </span><span class="annot"><a href="#local-6989586621681881032"><span class="hs-identifier hs-type">tryLevel</span></a></span><span>
</span><span id="line-1300"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1301"></span><span>        </span><span class="annot"><span class="annottext">[SearchStepResult] -&gt; SM [SearchStepResult]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1302"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DataOrRecSig"><span class="hs-identifier hs-type">DataOrRecSig</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1303"></span><span>        </span><span class="annot"><span class="annottext">[SearchStepResult] -&gt; SM [SearchStepResult]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1304"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#GeneralizableVar"><span class="hs-identifier hs-type">GeneralizableVar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1305"></span><span>        </span><span class="annot"><span class="annottext">[SearchStepResult] -&gt; SM [SearchStepResult]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1306"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#AbstractDefn"><span class="hs-identifier hs-type">AbstractDefn</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1307"></span><span>        </span><span class="annot"><span class="annottext">[SearchStepResult] -&gt; SM [SearchStepResult]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1308"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1309"></span><span>        </span><span class="annot"><span class="annottext">[SearchStepResult] -&gt; SM [SearchStepResult]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1310"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1311"></span><span>        </span><span class="annot"><span class="annottext">[SearchStepResult] -&gt; SM [SearchStepResult]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1312"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PrimitiveSort"><span class="hs-identifier hs-type">PrimitiveSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1313"></span><span>        </span><span class="annot"><span class="annottext">[SearchStepResult] -&gt; SM [SearchStepResult]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1314"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621681881035"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681881035"><span class="hs-identifier hs-var">level</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1315"></span><span>      </span><span class="annot"><span class="annottext">Level -&gt; SM [SearchStepResult]
</span><a href="#local-6989586621681881036"><span class="hs-identifier hs-var">trySet</span></a></span><span> </span><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681881035"><span class="hs-identifier hs-var">level</span></a></span><span>
</span><span id="line-1316"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span id="local-6989586621681881037"><span class="annot"><span class="annottext">Sort' Term
</span><a href="#local-6989586621681881037"><span class="hs-identifier hs-var">sort</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1317"></span><span>      </span><span class="annot"><span class="annottext">[SearchStepResult] -&gt; SM [SearchStepResult]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1318"></span><span>    </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SearchStepResult] -&gt; SM [SearchStepResult]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1319"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1320"></span><span>      </span><span class="hs-comment">-- TODO: Alternatively, the constructor can be accessed via `getRecordConstructor`</span><span>
</span><span id="line-1321"></span><span>      </span><span class="hs-comment">-- TODO: There might be a neater way of applying the constructor to new metas</span><span>
</span><span id="line-1322"></span><span>    </span><span class="annot"><a href="#local-6989586621681881027"><span class="hs-identifier hs-type">tryRecord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1323"></span><span>    </span><span id="local-6989586621681881027"><span class="annot"><span class="annottext">tryRecord :: Defn -&gt; SM [SearchStepResult]
</span><a href="#local-6989586621681881027"><span class="hs-identifier hs-var hs-var">tryRecord</span></a></span></span><span> </span><span id="local-6989586621681881038"><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681881038"><span class="hs-identifier hs-var">recordDefn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1324"></span><span>      </span><span id="local-6989586621681881039"><span class="annot"><a href="#local-6989586621681881039"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; VerboseLevel) -&gt; SM VerboseLevel
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costRecordCon"><span class="hs-identifier hs-var">costRecordCon</span></a></span><span> </span><span class="annot"><span class="annottext">(Costs -&gt; VerboseLevel)
-&gt; (SearchOptions -&gt; Costs) -&gt; SearchOptions -&gt; VerboseLevel
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; Costs
</span><a href="Agda.Mimer.Mimer.html#searchCosts"><span class="hs-identifier hs-var">searchCosts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO: Use lenses for this?</span><span>
</span><span id="line-1325"></span><span>      </span><span id="local-6989586621681881040"><span class="annot"><a href="#local-6989586621681881040"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#qnameToComponent"><span class="hs-identifier hs-type">qnameToComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881039"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recConHead"><span class="hs-identifier hs-var">recConHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881038"><span class="hs-identifier hs-type">recordDefn</span></a></span><span>
</span><span id="line-1326"></span><span>      </span><span class="hs-comment">-- NOTE: at most 1</span><span>
</span><span id="line-1327"></span><span>      </span><span id="local-6989586621681881043"><span class="annot"><a href="#local-6989586621681881043"><span class="hs-identifier hs-var">newBranches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">maybeToList</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryRefineAddMetas"><span class="hs-identifier hs-type">tryRefineAddMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881021"><span class="hs-identifier hs-type">goal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881022"><span class="hs-identifier hs-type">goalType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881023"><span class="hs-identifier hs-type">branch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881040"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-1328"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#checkSolved"><span class="hs-identifier hs-type">checkSolved</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881043"><span class="hs-identifier hs-type">newBranches</span></a></span><span>
</span><span id="line-1329"></span><span>
</span><span id="line-1330"></span><span>    </span><span class="annot"><a href="#local-6989586621681881029"><span class="hs-identifier hs-type">tryData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1331"></span><span>    </span><span id="local-6989586621681881029"><span class="annot"><span class="annottext">tryData :: Defn -&gt; SM [SearchStepResult]
</span><a href="#local-6989586621681881029"><span class="hs-identifier hs-var hs-var">tryData</span></a></span></span><span> </span><span id="local-6989586621681881044"><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681881044"><span class="hs-identifier hs-var">dataDefn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1332"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881045"><span class="annot"><span class="annottext">constructors :: [QName]
</span><a href="#local-6989586621681881045"><span class="hs-identifier hs-var hs-var hs-var">constructors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defn -&gt; [QName]
</span><a href="Agda.TypeChecking.Monad.Base.html#dataCons"><span class="hs-identifier hs-var">dataCons</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681881044"><span class="hs-identifier hs-var">dataDefn</span></a></span><span>
</span><span id="line-1333"></span><span>      </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.try&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="annot"><span class="annottext">([TCMT IO Doc] -&gt; TCMT IO Doc) -&gt; [TCMT IO Doc] -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;tryData&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; [TCMT IO Doc] -&gt; [TCMT IO Doc]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; TCMT IO Doc) -&gt; [QName] -&gt; [TCMT IO Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681881045"><span class="hs-identifier hs-var">constructors</span></a></span><span>
</span><span id="line-1334"></span><span>      </span><span id="local-6989586621681881047"><span class="annot"><a href="#local-6989586621681881047"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; VerboseLevel) -&gt; SM VerboseLevel
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costDataCon"><span class="hs-identifier hs-var">costDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">(Costs -&gt; VerboseLevel)
-&gt; (SearchOptions -&gt; Costs) -&gt; SearchOptions -&gt; VerboseLevel
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; Costs
</span><a href="Agda.Mimer.Mimer.html#searchCosts"><span class="hs-identifier hs-var">searchCosts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1335"></span><span>      </span><span id="local-6989586621681881048"><span class="annot"><a href="#local-6989586621681881048"><span class="hs-identifier hs-var">comps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#qnameToComponent"><span class="hs-identifier hs-type">qnameToComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881047"><span class="hs-identifier hs-type">cost</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681881045"><span class="hs-identifier hs-type">constructors</span></a></span><span>
</span><span id="line-1336"></span><span>      </span><span id="local-6989586621681881049"><span class="annot"><a href="#local-6989586621681881049"><span class="hs-identifier hs-var">newBranches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryRefineAddMetas"><span class="hs-identifier hs-type">tryRefineAddMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881021"><span class="hs-identifier hs-type">goal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881022"><span class="hs-identifier hs-type">goalType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881023"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681881048"><span class="hs-identifier hs-type">comps</span></a></span><span>
</span><span id="line-1337"></span><span>      </span><span class="hs-comment">-- TODO: Reduce overlap between e.g. tryLocals, this and tryRecord</span><span>
</span><span id="line-1338"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#checkSolved"><span class="hs-identifier hs-type">checkSolved</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><a href="#local-6989586621681881049"><span class="hs-identifier hs-type">newBranches</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1339"></span><span>
</span><span id="line-1340"></span><span>    </span><span class="annot"><a href="#local-6989586621681881032"><span class="hs-identifier hs-type">tryLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1341"></span><span>    </span><span id="local-6989586621681881032"><span class="annot"><span class="annottext">tryLevel :: SM [SearchStepResult]
</span><a href="#local-6989586621681881032"><span class="hs-identifier hs-var hs-var">tryLevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1342"></span><span>      </span><span id="local-6989586621681881050"><span class="annot"><a href="#local-6989586621681881050"><span class="hs-identifier hs-var">levelHints</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; [Component])
-&gt; ReaderT SearchOptions (TCMT IO) [Component]
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintLevel"><span class="hs-identifier hs-var">hintLevel</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseComponents -&gt; [Component])
-&gt; (SearchOptions -&gt; BaseComponents)
-&gt; SearchOptions
-&gt; [Component]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; BaseComponents
</span><a href="Agda.Mimer.Mimer.html#searchBaseComponents"><span class="hs-identifier hs-var">searchBaseComponents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1343"></span><span>      </span><span id="local-6989586621681881051"><span class="annot"><a href="#local-6989586621681881051"><span class="hs-identifier hs-var">newBranches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryRefineAddMetas"><span class="hs-identifier hs-type">tryRefineAddMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881021"><span class="hs-identifier hs-type">goal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881022"><span class="hs-identifier hs-type">goalType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881023"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681881050"><span class="hs-identifier hs-type">levelHints</span></a></span><span>
</span><span id="line-1344"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#checkSolved"><span class="hs-identifier hs-type">checkSolved</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881051"><span class="hs-identifier hs-type">newBranches</span></a></span><span>
</span><span id="line-1345"></span><span>
</span><span id="line-1346"></span><span>    </span><span class="hs-comment">-- TODO: Add an extra filtering on the sort</span><span>
</span><span id="line-1347"></span><span>    </span><span class="annot"><a href="#local-6989586621681881036"><span class="hs-identifier hs-type">trySet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1348"></span><span>    </span><span id="local-6989586621681881036"><span class="annot"><span class="annottext">trySet :: Level -&gt; SM [SearchStepResult]
</span><a href="#local-6989586621681881036"><span class="hs-identifier hs-var hs-var">trySet</span></a></span></span><span> </span><span id="local-6989586621681881052"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681881052"><span class="hs-identifier hs-var">level</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1349"></span><span>      </span><span id="local-6989586621681881053"><span class="annot"><a href="#local-6989586621681881053"><span class="hs-identifier hs-var">reducedLevel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Level -&gt; ReaderT SearchOptions (TCMT IO) Level
forall a (m :: * -&gt; *). (Reduce a, MonadReduce m) =&gt; a -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#reduce"><span class="hs-identifier hs-var">reduce</span></a></span><span> </span><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681881052"><span class="hs-identifier hs-var">level</span></a></span><span>
</span><span id="line-1350"></span><span>      </span><span id="local-6989586621681881054"><span class="annot"><a href="#local-6989586621681881054"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#costSet"><span class="hs-identifier hs-var">costSet</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#searchCosts"><span class="hs-identifier hs-var">searchCosts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1351"></span><span>      </span><span id="local-6989586621681881055"><span class="annot"><a href="#local-6989586621681881055"><span class="hs-identifier hs-var">setCandidates</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681881053"><span class="hs-identifier hs-type">reducedLevel</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1352"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Max"><span class="hs-identifier hs-type">Max</span></a></span><span> </span><span id="local-6989586621681881057"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681881057"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1353"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681881057"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1354"></span><span>              </span><span id="local-6989586621681881058"><span class="annot"><a href="#local-6989586621681881058"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MetaId]
-&gt; VerboseLevel
-&gt; Maybe Name
-&gt; VerboseLevel
-&gt; Term
-&gt; Type
-&gt; ReaderT SearchOptions (TCMT IO) Component
forall (m :: * -&gt; *).
MonadFresh VerboseLevel m =&gt;
[MetaId]
-&gt; VerboseLevel
-&gt; Maybe Name
-&gt; VerboseLevel
-&gt; Term
-&gt; Type
-&gt; m Component
</span><a href="Agda.Mimer.Mimer.html#newComponent"><span class="hs-identifier hs-var">newComponent</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881054"><span class="hs-identifier hs-var">cost</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sort' Term -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-var">Sort</span></a></span><span> </span><span class="annot"><span class="annottext">(Sort' Term -&gt; Term) -&gt; Sort' Term -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Level -&gt; Sort' Term
forall t. Level' t -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">(Level -&gt; Sort' Term) -&gt; Level -&gt; Sort' Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [PlusLevel' Term] -&gt; Level
forall t. Integer -&gt; [PlusLevel' t] -&gt; Level' t
</span><a href="Agda.Syntax.Internal.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681881057"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881022"><span class="hs-identifier hs-var">goalType</span></a></span><span>
</span><span id="line-1355"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681881023"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681881058"><span class="hs-identifier hs-type">comp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1356"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(SearchBranch, Component)]
-&gt; ReaderT SearchOptions (TCMT IO) [(SearchBranch, Component)]
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1357"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Max"><span class="hs-identifier hs-type">Max</span></a></span><span> </span><span id="local-6989586621681881059"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681881059"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681881060"><span class="annot"><span class="annottext">[PlusLevel' Term]
</span><a href="#local-6989586621681881060"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1358"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621681881061"><span class="annot"><a href="#local-6989586621681881061"><span class="hs-identifier hs-var">metaId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881062"><span class="annot"><a href="#local-6989586621681881062"><span class="hs-identifier hs-var">metaTerm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; SM (MetaId, Term)
</span><a href="Agda.Mimer.Mimer.html#createMeta"><span class="hs-identifier hs-var">createMeta</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; SM (MetaId, Term))
-&gt; ReaderT SearchOptions (TCMT IO) Type -&gt; SM (MetaId, Term)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Type
forall (m :: * -&gt; *). (HasBuiltins m, MonadTCError m) =&gt; m Type
</span><a href="Agda.TypeChecking.Level.html#levelType"><span class="hs-identifier hs-var">levelType</span></a></span><span>
</span><span id="line-1359"></span><span>              </span><span id="local-6989586621681881063"><span class="annot"><a href="#local-6989586621681881063"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#newComponent"><span class="hs-identifier hs-type">newComponent</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681881061"><span class="hs-identifier hs-type">metaId</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621681881054"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Max"><span class="hs-identifier hs-type">Max</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">max</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681881059"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Internal.html#Plus"><span class="hs-identifier hs-type">Plus</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="#local-6989586621681881062"><span class="hs-identifier hs-type">metaTerm</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681881022"><span class="hs-identifier hs-type">goalType</span></a></span><span>
</span><span id="line-1360"></span><span>              </span><span id="local-6989586621681881066"><span class="annot"><a href="#local-6989586621681881066"><span class="hs-identifier hs-var">branch'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#updateBranch"><span class="hs-identifier hs-type">updateBranch</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681881061"><span class="hs-identifier hs-type">metaId</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621681881023"><span class="hs-identifier hs-type">branch</span></a></span><span>
</span><span id="line-1361"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681881066"><span class="hs-identifier hs-type">branch'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681881063"><span class="hs-identifier hs-type">comp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1362"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.refine.set&quot;</span></span><span> </span><span class="annot"><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1363"></span><span>        </span><span class="annot"><span class="hs-string">&quot;Trying&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">snd</span></span><span> </span><span class="annot"><a href="#local-6989586621681881055"><span class="hs-identifier hs-type">setCandidates</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;for&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881022"><span class="hs-identifier hs-type">goalType</span></a></span><span>
</span><span id="line-1364"></span><span>      </span><span id="local-6989586621681881067"><span class="annot"><a href="#local-6989586621681881067"><span class="hs-identifier hs-var">newBranches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681881068"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881068"><span class="hs-identifier hs-var">br</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681881069"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881069"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Goal
-&gt; Type
-&gt; SearchBranch
-&gt; Component
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
</span><a href="Agda.Mimer.Mimer.html#tryRefineWith"><span class="hs-identifier hs-var">tryRefineWith</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681881021"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881022"><span class="hs-identifier hs-var">goalType</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881068"><span class="hs-identifier hs-var">br</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881069"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681881055"><span class="hs-identifier hs-type">setCandidates</span></a></span><span>
</span><span id="line-1365"></span><span>      </span><span id="local-6989586621681881070"><span class="annot"><a href="#local-6989586621681881070"><span class="hs-identifier hs-var">components</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">asks</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#searchBaseComponents"><span class="hs-identifier hs-var">searchBaseComponents</span></a></span><span>
</span><span id="line-1366"></span><span>      </span><span id="local-6989586621681881071"><span class="annot"><a href="#local-6989586621681881071"><span class="hs-identifier hs-var">newBranches'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryRefineAddMetas"><span class="hs-identifier hs-type">tryRefineAddMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881021"><span class="hs-identifier hs-type">goal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881022"><span class="hs-identifier hs-type">goalType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881023"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1367"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">$</span></span><span> </span><span class="annot"><span class="hs-identifier">components</span></span><span class="hs-special">)</span><span>
</span><span id="line-1368"></span><span>                       </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintDataTypes"><span class="hs-identifier hs-var">hintDataTypes</span></a></span><span>
</span><span id="line-1369"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintRecordTypes"><span class="hs-identifier hs-var">hintRecordTypes</span></a></span><span>
</span><span id="line-1370"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#hintAxioms"><span class="hs-identifier hs-var">hintAxioms</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1371"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#checkSolved"><span class="hs-identifier hs-type">checkSolved</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681881067"><span class="hs-identifier hs-type">newBranches</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621681881071"><span class="hs-identifier hs-type">newBranches'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1372"></span><span>
</span><span id="line-1373"></span><span class="hs-comment">-- | Type should already be reduced here</span><span>
</span><span id="line-1374"></span><span class="hs-comment">-- NOTE: Does not reset the state!</span><span>
</span><span id="line-1375"></span><span class="hs-comment">-- TODO: Make sure the type is always reduced</span><span>
</span><span id="line-1376"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryRefineWith"><span class="hs-identifier hs-type">tryRefineWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1377"></span><span id="tryRefineWith"><span class="annot"><span class="annottext">tryRefineWith :: Goal
-&gt; Type
-&gt; SearchBranch
-&gt; Component
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
</span><a href="Agda.Mimer.Mimer.html#tryRefineWith"><span class="hs-identifier hs-var hs-var">tryRefineWith</span></a></span></span><span> </span><span id="local-6989586621681881072"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681881072"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span id="local-6989586621681881073"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881073"><span class="hs-identifier hs-var">goalType</span></a></span></span><span> </span><span id="local-6989586621681881074"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881074"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span id="local-6989586621681881075"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881075"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch
-&gt; Goal
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
forall a. SearchBranch -&gt; Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-var">withBranchAndGoal</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881074"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681881072"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
 -&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch))
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1378"></span><span>
</span><span id="line-1379"></span><span>  </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr, LocalMetaStores)
forall (m :: * -&gt; *) a.
ReadTCState m =&gt;
m a -&gt; m (a, LocalMetaStores)
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#metasCreatedBy"><span class="hs-identifier hs-var">metasCreatedBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
</span><a href="Agda.Mimer.Mimer.html#dumbUnifierErr"><span class="hs-identifier hs-var">dumbUnifierErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Type
</span><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881075"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881073"><span class="hs-identifier hs-var">goalType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) (Maybe TCErr, LocalMetaStores)
-&gt; ((Maybe TCErr, LocalMetaStores)
    -&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch))
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
forall a b.
ReaderT SearchOptions (TCMT IO) a
-&gt; (a -&gt; ReaderT SearchOptions (TCMT IO) b)
-&gt; ReaderT SearchOptions (TCMT IO) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1380"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe TCErr
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881078"><span class="annot"><span class="annottext">LocalMetaStores
</span><a href="#local-6989586621681881078"><span class="hs-identifier hs-var">newMetaStore</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1381"></span><span>      </span><span class="annot"><span class="annottext">(MimerStats -&gt; MimerStats) -&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#updateStat"><span class="hs-identifier hs-var">updateStat</span></a></span><span> </span><span class="annot"><span class="annottext">MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incRefineSuccess"><span class="hs-identifier hs-var">incRefineSuccess</span></a></span><span>
</span><span id="line-1382"></span><span>      </span><span class="hs-comment">-- TODO: Why is newMetaIds not used here?</span><span>
</span><span id="line-1383"></span><span>      </span><span id="local-6989586621681881079"><span class="annot"><a href="#local-6989586621681881079"><span class="hs-identifier hs-var">newMetaIds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Term -&gt; Type -&gt; SM [MetaId]
</span><a href="Agda.Mimer.Mimer.html#assignMeta"><span class="hs-identifier hs-var">assignMeta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Goal -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681881072"><span class="hs-identifier hs-var">goal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881075"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881073"><span class="hs-identifier hs-var">goalType</span></a></span><span>
</span><span id="line-1384"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881080"><span class="annot"><a href="#local-6989586621681881080"><span class="hs-identifier hs-var hs-var">newMetaIds'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map MetaId MetaVariable -&gt; [MetaId]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalMetaStores -&gt; Map MetaId MetaVariable
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#openMetas"><span class="hs-identifier hs-var">openMetas</span></a></span><span> </span><span class="annot"><span class="annottext">LocalMetaStores
</span><a href="#local-6989586621681881078"><span class="hs-identifier hs-var">newMetaStore</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1385"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.refine&quot;</span></span><span> </span><span class="annot"><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1386"></span><span>        </span><span class="annot"><span class="hs-string">&quot;Refine: assignMeta created new metas:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881079"><span class="hs-identifier hs-type">newMetaIds</span></a></span><span>
</span><span id="line-1387"></span><span>
</span><span id="line-1388"></span><span>      </span><span class="annot"><a href="Agda.Mimer.Mimer.html#reportSMDoc"><span class="hs-identifier hs-type">reportSMDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.refine&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Refinement succeeded&quot;</span></span><span>
</span><span id="line-1389"></span><span>
</span><span id="line-1390"></span><span>      </span><span class="annot"><a href="Agda.Mimer.Mimer.html#mimerTrace"><span class="hs-identifier hs-type">mimerTrace</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span>
</span><span id="line-1391"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Found refinement&quot;</span></span><span>
</span><span id="line-1392"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881075"><span class="hs-identifier hs-type">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1393"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881075"><span class="hs-identifier hs-type">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1394"></span><span>      </span><span class="hs-comment">-- Take the metas stored in the component and add them as sub-goals</span><span>
</span><span id="line-1395"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#updateBranchCost"><span class="hs-identifier hs-type">updateBranchCost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881075"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681881080"><span class="hs-identifier hs-type">newMetaIds'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#compMetas"><span class="hs-identifier hs-var">compMetas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881075"><span class="hs-identifier hs-type">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681881074"><span class="hs-identifier hs-type">branch</span></a></span><span>
</span><span id="line-1396"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681881084"><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681881084"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LocalMetaStores
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1397"></span><span>      </span><span class="annot"><span class="annottext">(MimerStats -&gt; MimerStats) -&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#updateStat"><span class="hs-identifier hs-var">updateStat</span></a></span><span> </span><span class="annot"><span class="annottext">MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incRefineFail"><span class="hs-identifier hs-var">incRefineFail</span></a></span><span>
</span><span id="line-1398"></span><span>      </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#reportSMDoc"><span class="hs-identifier hs-var">reportSMDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.refine&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Doc
 -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;Refinement failed&quot;</span></span><span>
</span><span id="line-1399"></span><span>
</span><span id="line-1400"></span><span>      </span><span class="annot"><span class="annottext">VerboseLevel
-&gt; VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#mimerTrace"><span class="hs-identifier hs-var">mimerTrace</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Doc
 -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ReaderT SearchOptions (TCMT IO) Doc]
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-1401"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;Failed refinement&quot;</span></span><span>
</span><span id="line-1402"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Doc
 -&gt; ReaderT SearchOptions (TCMT IO) Doc)
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ReaderT SearchOptions (TCMT IO) Doc]
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Term -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Term -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881075"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1403"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Type
</span><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881075"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1404"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Doc
 -&gt; ReaderT SearchOptions (TCMT IO) Doc)
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCErr -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; TCErr -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681881084"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1405"></span><span>      </span><span class="annot"><span class="annottext">Maybe SearchBranch
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe SearchBranch
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1406"></span><span>
</span><span id="line-1407"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryRefineWith%27"><span class="hs-identifier hs-type">tryRefineWith'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1408"></span><span id="tryRefineWith%27"><span class="annot"><span class="annottext">tryRefineWith' :: Goal -&gt; Type -&gt; Component -&gt; SM (Maybe ([MetaId], [MetaId]))
</span><a href="Agda.Mimer.Mimer.html#tryRefineWith%27"><span class="hs-identifier hs-var hs-var">tryRefineWith'</span></a></span></span><span> </span><span id="local-6989586621681881085"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681881085"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span id="local-6989586621681881086"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881086"><span class="hs-identifier hs-var">goalType</span></a></span></span><span> </span><span id="local-6989586621681881087"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881087"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1409"></span><span>  </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Bool
-&gt; ReaderT SearchOptions (TCMT IO) (Bool, LocalMetaStores)
forall (m :: * -&gt; *) a.
ReadTCState m =&gt;
m a -&gt; m (a, LocalMetaStores)
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#metasCreatedBy"><span class="hs-identifier hs-var">metasCreatedBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; ReaderT SearchOptions (TCMT IO) Bool
</span><a href="Agda.Mimer.Mimer.html#dumbUnifier"><span class="hs-identifier hs-var">dumbUnifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Type
</span><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881087"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881086"><span class="hs-identifier hs-var">goalType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) (Bool, LocalMetaStores)
-&gt; ((Bool, LocalMetaStores) -&gt; SM (Maybe ([MetaId], [MetaId])))
-&gt; SM (Maybe ([MetaId], [MetaId]))
forall a b.
ReaderT SearchOptions (TCMT IO) a
-&gt; (a -&gt; ReaderT SearchOptions (TCMT IO) b)
-&gt; ReaderT SearchOptions (TCMT IO) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1410"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881089"><span class="annot"><span class="annottext">LocalMetaStores
</span><a href="#local-6989586621681881089"><span class="hs-identifier hs-var">newMetaStore</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1411"></span><span>      </span><span id="local-6989586621681881090"><span class="annot"><a href="#local-6989586621681881090"><span class="hs-identifier hs-var">newMetaIds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Term -&gt; Type -&gt; SM [MetaId]
</span><a href="Agda.Mimer.Mimer.html#assignMeta"><span class="hs-identifier hs-var">assignMeta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Goal -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681881085"><span class="hs-identifier hs-var">goal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881087"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881086"><span class="hs-identifier hs-var">goalType</span></a></span><span>
</span><span id="line-1412"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881091"><span class="annot"><a href="#local-6989586621681881091"><span class="hs-identifier hs-var hs-var">newMetaIds'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map MetaId MetaVariable -&gt; [MetaId]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalMetaStores -&gt; Map MetaId MetaVariable
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#openMetas"><span class="hs-identifier hs-var">openMetas</span></a></span><span> </span><span class="annot"><span class="annottext">LocalMetaStores
</span><a href="#local-6989586621681881089"><span class="hs-identifier hs-var">newMetaStore</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1413"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681881090"><span class="hs-identifier hs-type">newMetaIds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681881091"><span class="hs-identifier hs-type">newMetaIds'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1414"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LocalMetaStores
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ([MetaId], [MetaId]) -&gt; SM (Maybe ([MetaId], [MetaId]))
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe ([MetaId], [MetaId])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1415"></span><span>
</span><span id="line-1416"></span><span class="hs-comment">-- TODO: Make policy for when state should be put</span><span>
</span><span id="line-1417"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryRefineAddMetas"><span class="hs-identifier hs-type">tryRefineAddMetas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1418"></span><span id="tryRefineAddMetas"><span class="annot"><span class="annottext">tryRefineAddMetas :: Goal
-&gt; Type
-&gt; SearchBranch
-&gt; Component
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
</span><a href="Agda.Mimer.Mimer.html#tryRefineAddMetas"><span class="hs-identifier hs-var hs-var">tryRefineAddMetas</span></a></span></span><span> </span><span id="local-6989586621681881092"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681881092"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span id="local-6989586621681881093"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881093"><span class="hs-identifier hs-var">goalType</span></a></span></span><span> </span><span id="local-6989586621681881094"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881094"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span id="local-6989586621681881095"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881095"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch
-&gt; Goal
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
forall a. SearchBranch -&gt; Goal -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchAndGoal"><span class="hs-identifier hs-var">withBranchAndGoal</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881094"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681881092"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
 -&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch))
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe SearchBranch)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1419"></span><span>  </span><span class="hs-comment">-- Apply the hint to new metas (generating @c@, @c ?@, @c ? ?@, etc.)</span><span>
</span><span id="line-1420"></span><span>  </span><span class="hs-comment">-- TODO: Where is the best place to reduce the hint type?</span><span>
</span><span id="line-1421"></span><span>  </span><span id="local-6989586621681881096"><span class="annot"><a href="#local-6989586621681881096"><span class="hs-identifier hs-var">comp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe VerboseLevel
-&gt; Component -&gt; ReaderT SearchOptions (TCMT IO) Component
</span><a href="Agda.Mimer.Mimer.html#applyToMetasG"><span class="hs-identifier hs-var">applyToMetasG</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe VerboseLevel
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881095"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-1422"></span><span>  </span><span id="local-6989586621681881097"><span class="annot"><a href="#local-6989586621681881097"><span class="hs-identifier hs-var">branch'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#updateBranch"><span class="hs-identifier hs-type">updateBranch</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621681881094"><span class="hs-identifier hs-type">branch</span></a></span><span>
</span><span id="line-1423"></span><span>  </span><span class="annot"><a href="Agda.Mimer.Mimer.html#tryRefineWith"><span class="hs-identifier hs-type">tryRefineWith</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881092"><span class="hs-identifier hs-type">goal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881093"><span class="hs-identifier hs-type">goalType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881097"><span class="hs-identifier hs-type">branch'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881096"><span class="hs-identifier hs-type">comp'</span></a></span><span>
</span><span id="line-1424"></span><span>
</span><span id="line-1425"></span><span class="hs-comment">-- TODO: Make sure the type is reduced the first time this is called</span><span>
</span><span id="line-1426"></span><span class="hs-comment">-- TODO: Rewrite with Component?</span><span>
</span><span id="line-1427"></span><span class="hs-comment">-- NOTE: The new metas are in left-to-right order -- the opposite of the</span><span>
</span><span id="line-1428"></span><span class="hs-comment">-- order they should be solved in.</span><span>
</span><span id="line-1429"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#applyToMetas"><span class="hs-identifier hs-type">applyToMetas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1430"></span><span id="applyToMetas"><span class="annot"><span class="annottext">applyToMetas :: VerboseLevel -&gt; Term -&gt; Type -&gt; SM (Term, Type, [MetaId])
</span><a href="Agda.Mimer.Mimer.html#applyToMetas"><span class="hs-identifier hs-var hs-var">applyToMetas</span></a></span></span><span> </span><span id="local-6989586621681881098"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881098"><span class="hs-identifier hs-var">skip</span></a></span></span><span> </span><span id="local-6989586621681881099"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681881099"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621681881100"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881100"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1431"></span><span>  </span><span id="local-6989586621681881101"><span class="annot"><a href="#local-6989586621681881101"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Telescope
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m Telescope
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-var">getContextTelescope</span></a></span><span>
</span><span id="line-1432"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881100"><span class="hs-identifier hs-type">typ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1433"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span id="local-6989586621681881102"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681881102"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621681881103"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681881103"><span class="hs-identifier hs-var">abs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1434"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881104"><span class="annot"><span class="annottext">domainType :: Type
</span><a href="#local-6989586621681881104"><span class="hs-identifier hs-var hs-var hs-var">domainType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681881102"><span class="hs-identifier hs-var">dom</span></a></span><span>
</span><span id="line-1435"></span><span>      </span><span class="hs-comment">-- TODO: What exactly does the occur check do?</span><span>
</span><span id="line-1436"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681881105"><span class="annot"><a href="#local-6989586621681881105"><span class="hs-identifier hs-var">metaId'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881106"><span class="annot"><a href="#local-6989586621681881106"><span class="hs-identifier hs-var">metaTerm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Phase] -&gt; SM (MetaId, Term) -&gt; SM (MetaId, Term)
forall a. NFData a =&gt; [Phase] -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#bench"><span class="hs-identifier hs-var">bench</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Phase
</span><a href="Agda.Benchmarking.html#Free"><span class="hs-identifier hs-var">Bench.Free</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(SM (MetaId, Term) -&gt; SM (MetaId, Term))
-&gt; SM (MetaId, Term) -&gt; SM (MetaId, Term)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RunMetaOccursCheck -&gt; Comparison -&gt; Type -&gt; SM (MetaId, Term)
forall (m :: * -&gt; *).
MonadMetaSolver m =&gt;
RunMetaOccursCheck -&gt; Comparison -&gt; Type -&gt; m (MetaId, Term)
</span><a href="Agda.TypeChecking.MetaVars.html#newValueMeta"><span class="hs-identifier hs-var">newValueMeta</span></a></span><span> </span><span class="annot"><span class="annottext">RunMetaOccursCheck
</span><a href="Agda.TypeChecking.Monad.Base.html#DontRunMetaOccursCheck"><span class="hs-identifier hs-var">DontRunMetaOccursCheck</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="Agda.TypeChecking.Monad.Base.Types.html#CmpLeq"><span class="hs-identifier hs-var">CmpLeq</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881104"><span class="hs-identifier hs-var">domainType</span></a></span><span>
</span><span id="line-1437"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881107"><span class="annot"><a href="#local-6989586621681881107"><span class="hs-identifier hs-var hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Origin -&gt; Arg Term -&gt; Arg Term
forall a. LensOrigin a =&gt; Origin -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setOrigin"><span class="hs-identifier hs-var">setOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#Inserted"><span class="hs-identifier hs-var">Inserted</span></a></span><span> </span><span class="annot"><span class="annottext">(Arg Term -&gt; Arg Term) -&gt; Arg Term -&gt; Arg Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681881106"><span class="hs-identifier hs-var">metaTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Arg Type -&gt; Arg Term
forall a b. a -&gt; Arg b -&gt; Arg a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Arg Type
forall t a. Dom' t a -&gt; Arg a
</span><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-var">argFromDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681881102"><span class="hs-identifier hs-var">dom</span></a></span><span>
</span><span id="line-1438"></span><span>      </span><span id="local-6989586621681881108"><span class="annot"><a href="#local-6989586621681881108"><span class="hs-identifier hs-var">newType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#bench"><span class="hs-identifier hs-type">bench</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Benchmarking.html#Reduce"><span class="hs-identifier hs-type">Bench.Reduce</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#reduce"><span class="hs-identifier hs-type">reduce</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#piApplyM"><span class="hs-identifier hs-type">piApplyM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881100"><span class="hs-identifier hs-type">typ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881106"><span class="hs-identifier hs-type">metaTerm</span></a></span><span> </span><span class="hs-comment">-- TODO: Is this the best place to reduce?</span><span>
</span><span id="line-1439"></span><span>      </span><span class="hs-comment">-- For records, the parameters are not included in the term</span><span>
</span><span id="line-1440"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881109"><span class="annot"><a href="#local-6989586621681881109"><span class="hs-identifier hs-var hs-var">newTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881098"><span class="hs-identifier hs-var">skip</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681881099"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Args -&gt; Term
forall t. Apply t =&gt; t -&gt; Args -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681881099"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Arg Term
</span><a href="#local-6989586621681881107"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1441"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681881110"><span class="annot"><a href="#local-6989586621681881110"><span class="hs-identifier hs-var">term'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881111"><span class="annot"><a href="#local-6989586621681881111"><span class="hs-identifier hs-var">typ'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881112"><span class="annot"><a href="#local-6989586621681881112"><span class="hs-identifier hs-var">metas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#applyToMetas"><span class="hs-identifier hs-type">applyToMetas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#predNat"><span class="hs-identifier hs-type">predNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881098"><span class="hs-identifier hs-type">skip</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681881109"><span class="hs-identifier hs-type">newTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881108"><span class="hs-identifier hs-type">newType</span></a></span><span>
</span><span id="line-1442"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681881110"><span class="hs-identifier hs-type">term'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681881111"><span class="hs-identifier hs-type">typ'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681881105"><span class="hs-identifier hs-type">metaId'</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621681881112"><span class="hs-identifier hs-type">metas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1443"></span><span>    </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term, Type, [MetaId]) -&gt; SM (Term, Type, [MetaId])
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681881099"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881100"><span class="hs-identifier hs-var">typ</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1444"></span><span>
</span><span id="line-1445"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#normaliseSolution"><span class="hs-identifier hs-type">normaliseSolution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span>
</span><span id="line-1446"></span><span id="normaliseSolution"><span class="annot"><span class="annottext">normaliseSolution :: Term -&gt; ReaderT SearchOptions (TCMT IO) Term
</span><a href="Agda.Mimer.Mimer.html#normaliseSolution"><span class="hs-identifier hs-var hs-var">normaliseSolution</span></a></span></span><span> </span><span id="local-6989586621681881114"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681881114"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1447"></span><span>  </span><span id="local-6989586621681881115"><span class="annot"><a href="#local-6989586621681881115"><span class="hs-identifier hs-var">norm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; Rewrite)
-&gt; ReaderT SearchOptions (TCMT IO) Rewrite
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; Rewrite
</span><a href="Agda.Mimer.Mimer.html#searchRewrite"><span class="hs-identifier hs-var">searchRewrite</span></a></span><span>
</span><span id="line-1448"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Interaction.BasicOps.html#normalForm"><span class="hs-identifier hs-type">normalForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881115"><span class="hs-identifier hs-type">norm</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html#instantiateFull"><span class="hs-identifier hs-type">instantiateFull</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881114"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-1449"></span><span>
</span><span id="line-1450"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#checkSolved"><span class="hs-identifier hs-type">checkSolved</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchStepResult"><span class="hs-identifier hs-type">SearchStepResult</span></a></span><span>
</span><span id="line-1451"></span><span id="checkSolved"><span class="annot"><span class="annottext">checkSolved :: SearchBranch -&gt; ReaderT SearchOptions (TCMT IO) SearchStepResult
</span><a href="Agda.Mimer.Mimer.html#checkSolved"><span class="hs-identifier hs-var hs-var">checkSolved</span></a></span></span><span> </span><span id="local-6989586621681881116"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881116"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1452"></span><span>  </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Checking if branch is solved&quot;</span></span><span>
</span><span id="line-1453"></span><span>  </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;  remaining subgoals: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[MetaId] -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; [MetaId] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Goal -&gt; MetaId) -&gt; [Goal] -&gt; [MetaId]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Goal -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">([Goal] -&gt; [MetaId]) -&gt; [Goal] -&gt; [MetaId]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; [Goal]
</span><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881116"><span class="hs-identifier hs-var">branch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1454"></span><span>  </span><span id="local-6989586621681881117"><span class="annot"><a href="#local-6989586621681881117"><span class="hs-identifier hs-var">topMetaId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; MetaId) -&gt; ReaderT SearchOptions (TCMT IO) MetaId
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#searchTopMeta"><span class="hs-identifier hs-var">searchTopMeta</span></a></span><span>
</span><span id="line-1455"></span><span>  </span><span id="local-6989586621681881118"><span class="annot"><a href="#local-6989586621681881118"><span class="hs-identifier hs-var">topMeta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html#lookupLocalMeta"><span class="hs-identifier hs-type">lookupLocalMeta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881117"><span class="hs-identifier hs-type">topMetaId</span></a></span><span>
</span><span id="line-1456"></span><span>  </span><span id="local-6989586621681881119"><span class="annot"><a href="#local-6989586621681881119"><span class="hs-identifier hs-var">ii</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">asks</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#searchInteractionId"><span class="hs-identifier hs-var">searchInteractionId</span></a></span><span>
</span><span id="line-1457"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html#withInteractionId"><span class="hs-identifier hs-type">withInteractionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881119"><span class="hs-identifier hs-type">ii</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#withBranchState"><span class="hs-identifier hs-type">withBranchState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881116"><span class="hs-identifier hs-type">branch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1458"></span><span>    </span><span id="local-6989586621681881120"><span class="annot"><a href="#local-6989586621681881120"><span class="hs-identifier hs-var">metaArgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html#getMetaContextArgs"><span class="hs-identifier hs-type">getMetaContextArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881118"><span class="hs-identifier hs-type">topMeta</span></a></span><span>
</span><span id="line-1459"></span><span>    </span><span id="local-6989586621681881121"><span class="annot"><a href="#local-6989586621681881121"><span class="hs-identifier hs-var">inst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#normaliseSolution"><span class="hs-identifier hs-type">normaliseSolution</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#apply"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881117"><span class="hs-identifier hs-type">topMetaId</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681881120"><span class="hs-identifier hs-type">metaArgs</span></a></span><span>
</span><span id="line-1460"></span><span>    </span><span class="hs-comment">-- Issue #7639: The subgoals as generated by `applyToMetasG` (and other functions)</span><span>
</span><span id="line-1461"></span><span>    </span><span class="hs-comment">-- are already stored in the `sbGoals` field of the branch.</span><span>
</span><span id="line-1462"></span><span>    </span><span class="hs-comment">-- Here we just prune the subgoals that are already solved by unification.</span><span>
</span><span id="line-1463"></span><span>    </span><span id="local-6989586621681881122"><span class="annot"><a href="#local-6989586621681881122"><span class="hs-identifier hs-var">goals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">isNothing</span></span><span> </span><span class="annot"><a href="Agda.Utils.Functor.html#%3C.%3E"><span class="hs-operator hs-type">&lt;.&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#getMetaInstantiation"><span class="hs-identifier hs-type">getMetaInstantiation</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881116"><span class="hs-identifier hs-type">branch</span></a></span><span>
</span><span id="line-1464"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681881122"><span class="hs-identifier hs-type">goals</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1465"></span><span>      </span><span class="hs-comment">-- Issue #378: Blank out variables that are not in scope.</span><span>
</span><span id="line-1466"></span><span>      </span><span class="hs-comment">-- This might leave unsolved metas but is probably better</span><span>
</span><span id="line-1467"></span><span>      </span><span class="hs-comment">-- than generating out-of-scope variables.</span><span>
</span><span id="line-1468"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; SearchStepResult
</span><a href="Agda.Mimer.Mimer.html#ResultExpr"><span class="hs-identifier hs-var">ResultExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; SearchStepResult)
-&gt; ReaderT SearchOptions (TCMT IO) Expr
-&gt; ReaderT SearchOptions (TCMT IO) SearchStepResult
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; ReaderT SearchOptions (TCMT IO) Expr
forall (m :: * -&gt; *) a.
(MonadTCEnv m, MonadDebug m, BlankVars a) =&gt;
a -&gt; m a
</span><a href="Agda.Syntax.Translation.InternalToAbstract.html#blankNotInScope"><span class="hs-identifier hs-var">blankNotInScope</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; ReaderT SearchOptions (TCMT IO) Expr)
-&gt; ReaderT SearchOptions (TCMT IO) Expr
-&gt; ReaderT SearchOptions (TCMT IO) Expr
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; ReaderT SearchOptions (TCMT IO) (ReifiesTo Term)
forall i (m :: * -&gt; *).
(Reify i, MonadReify m) =&gt;
i -&gt; m (ReifiesTo i)
forall (m :: * -&gt; *). MonadReify m =&gt; Term -&gt; m (ReifiesTo Term)
</span><a href="Agda.Syntax.Translation.InternalToAbstract.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681881121"><span class="hs-identifier hs-var">inst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1469"></span><span>      </span><span class="annot"><span class="annottext">[Goal]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1470"></span><span>        </span><span class="annot"><span class="annottext">SearchStepResult
-&gt; ReaderT SearchOptions (TCMT IO) SearchStepResult
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SearchStepResult
 -&gt; ReaderT SearchOptions (TCMT IO) SearchStepResult)
-&gt; SearchStepResult
-&gt; ReaderT SearchOptions (TCMT IO) SearchStepResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; SearchStepResult
</span><a href="Agda.Mimer.Mimer.html#OpenBranch"><span class="hs-identifier hs-var">OpenBranch</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881116"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681881122"><span class="hs-identifier hs-type">goals</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1471"></span><span>
</span><span id="line-1472"></span><span id="local-6989586621681877500"><span class="annot"><a href="Agda.Mimer.Mimer.html#setAt"><span class="hs-identifier hs-type">setAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877500"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681877500"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681877500"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1473"></span><span id="setAt"><span class="annot"><span class="annottext">setAt :: forall a. VerboseLevel -&gt; a -&gt; [a] -&gt; [a]
</span><a href="Agda.Mimer.Mimer.html#setAt"><span class="hs-identifier hs-var hs-var">setAt</span></a></span></span><span> </span><span id="local-6989586621681881126"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881126"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681881127"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681881127"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681881128"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681881128"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; [a] -&gt; ([a], [a])
forall a. VerboseLevel -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881126"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681881128"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1474"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681881130"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681881130"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881131"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681881131"><span class="hs-identifier hs-var">_r</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681881132"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681881132"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681881130"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681881127"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681881132"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1475"></span><span>  </span><span class="annot"><span class="annottext">([a], [a])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; [a]
forall a. HasCallStack =&gt; ArgName -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;setAt: index out of bounds&quot;</span></span><span>
</span><span id="line-1476"></span><span>
</span><span id="line-1477"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#updateBranch%27"><span class="hs-identifier hs-type">updateBranch'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span>
</span><span id="line-1478"></span><span id="updateBranch%27"><span class="annot"><span class="annottext">updateBranch' :: Maybe Component -&gt; [MetaId] -&gt; SearchBranch -&gt; SM SearchBranch
</span><a href="Agda.Mimer.Mimer.html#updateBranch%27"><span class="hs-identifier hs-var hs-var">updateBranch'</span></a></span></span><span> </span><span id="local-6989586621681881134"><span class="annot"><span class="annottext">Maybe Component
</span><a href="#local-6989586621681881134"><span class="hs-identifier hs-var">mComp</span></a></span></span><span> </span><span id="local-6989586621681881135"><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621681881135"><span class="hs-identifier hs-var">newMetaIds</span></a></span></span><span> </span><span id="local-6989586621681881136"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881136"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1479"></span><span>  </span><span id="local-6989586621681881137"><span class="annot"><a href="#local-6989586621681881137"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) TCState
forall (m :: * -&gt; *). MonadTCState m =&gt; m TCState
</span><a href="Agda.TypeChecking.Monad.Base.html#getTC"><span class="hs-identifier hs-var">getTC</span></a></span><span>
</span><span id="line-1480"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881138"><span class="annot"><a href="#local-6989586621681881138"><span class="hs-identifier hs-var hs-var">compsUsed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; Map Name VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#sbComponentsUsed"><span class="hs-identifier hs-var">sbComponentsUsed</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881136"><span class="hs-identifier hs-var">branch</span></a></span><span>
</span><span id="line-1481"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681881139"><span class="annot"><a href="#local-6989586621681881139"><span class="hs-identifier hs-var">deltaCost</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881140"><span class="annot"><a href="#local-6989586621681881140"><span class="hs-identifier hs-var">compsUsed'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681881134"><span class="hs-identifier hs-type">mComp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1482"></span><span>        </span><span class="annot"><span class="annottext">Maybe Component
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(VerboseLevel, Map Name VerboseLevel)
-&gt; ReaderT
     SearchOptions (TCMT IO) (VerboseLevel, Map Name VerboseLevel)
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map Name VerboseLevel
</span><a href="#local-6989586621681881138"><span class="hs-identifier hs-var">compsUsed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1483"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681881141"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881141"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1484"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Component -&gt; Maybe Name
</span><a href="Agda.Mimer.Mimer.html#compName"><span class="hs-identifier hs-var">compName</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881141"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1485"></span><span>            </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(VerboseLevel, Map Name VerboseLevel)
-&gt; ReaderT
     SearchOptions (TCMT IO) (VerboseLevel, Map Name VerboseLevel)
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var">compCost</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881141"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map Name VerboseLevel
</span><a href="#local-6989586621681881138"><span class="hs-identifier hs-var">compsUsed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1486"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681881142"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681881142"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map Name VerboseLevel
</span><a href="#local-6989586621681881138"><span class="hs-identifier hs-var">compsUsed</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name VerboseLevel -&gt; Name -&gt; Maybe VerboseLevel
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; Maybe a
</span><span class="hs-operator hs-var">Map.!?</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681881142"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1487"></span><span>              </span><span class="annot"><span class="annottext">Maybe VerboseLevel
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(VerboseLevel, Map Name VerboseLevel)
-&gt; ReaderT
     SearchOptions (TCMT IO) (VerboseLevel, Map Name VerboseLevel)
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var">compCost</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881141"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; VerboseLevel -&gt; Map Name VerboseLevel -&gt; Map Name VerboseLevel
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681881142"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Map Name VerboseLevel
</span><a href="#local-6989586621681881138"><span class="hs-identifier hs-var">compsUsed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1488"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681881144"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881144"><span class="hs-identifier hs-var">uses</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1489"></span><span>                </span><span id="local-6989586621681881145"><span class="annot"><a href="#local-6989586621681881145"><span class="hs-identifier hs-var">reuseCost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; VerboseLevel -&gt; VerboseLevel)
-&gt; ReaderT SearchOptions (TCMT IO) (VerboseLevel -&gt; VerboseLevel)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costCompReuse"><span class="hs-identifier hs-var">costCompReuse</span></a></span><span> </span><span class="annot"><span class="annottext">(Costs -&gt; VerboseLevel -&gt; VerboseLevel)
-&gt; (SearchOptions -&gt; Costs)
-&gt; SearchOptions
-&gt; VerboseLevel
-&gt; VerboseLevel
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; Costs
</span><a href="Agda.Mimer.Mimer.html#searchCosts"><span class="hs-identifier hs-var">searchCosts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1490"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var">compCost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881141"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621681881145"><span class="hs-identifier hs-type">reuseCost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881144"><span class="hs-identifier hs-type">uses</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.adjust</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">succ</span></span><span> </span><span class="annot"><a href="#local-6989586621681881142"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881138"><span class="hs-identifier hs-type">compsUsed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1491"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621681881136"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbTCState"><span class="hs-identifier hs-var">sbTCState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681881137"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-1492"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881135"><span class="hs-identifier hs-type">newMetaIds</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881136"><span class="hs-identifier hs-type">branch</span></a></span><span>
</span><span id="line-1493"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbCost"><span class="hs-identifier hs-var">sbCost</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbCost"><span class="hs-identifier hs-var">sbCost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881136"><span class="hs-identifier hs-type">branch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621681881139"><span class="hs-identifier hs-type">deltaCost</span></a></span><span>
</span><span id="line-1494"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbComponentsUsed"><span class="hs-identifier hs-var">sbComponentsUsed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681881140"><span class="hs-identifier hs-type">compsUsed'</span></a></span><span>
</span><span id="line-1495"></span><span>               </span><span class="hs-special">}</span><span>
</span><span id="line-1496"></span><span>
</span><span id="line-1497"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#updateBranch"><span class="hs-identifier hs-type">updateBranch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span>
</span><span id="line-1498"></span><span id="updateBranch"><span class="annot"><span class="annottext">updateBranch :: [MetaId] -&gt; SearchBranch -&gt; SM SearchBranch
</span><a href="Agda.Mimer.Mimer.html#updateBranch"><span class="hs-identifier hs-var hs-var">updateBranch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Component -&gt; [MetaId] -&gt; SearchBranch -&gt; SM SearchBranch
</span><a href="Agda.Mimer.Mimer.html#updateBranch%27"><span class="hs-identifier hs-var">updateBranch'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Component
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1499"></span><span>
</span><span id="line-1500"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#updateBranchCost"><span class="hs-identifier hs-type">updateBranchCost</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span>
</span><span id="line-1501"></span><span id="updateBranchCost"><span class="annot"><span class="annottext">updateBranchCost :: Component -&gt; [MetaId] -&gt; SearchBranch -&gt; SM SearchBranch
</span><a href="Agda.Mimer.Mimer.html#updateBranchCost"><span class="hs-identifier hs-var hs-var">updateBranchCost</span></a></span></span><span> </span><span id="local-6989586621681881147"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881147"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Component -&gt; [MetaId] -&gt; SearchBranch -&gt; SM SearchBranch
</span><a href="Agda.Mimer.Mimer.html#updateBranch%27"><span class="hs-identifier hs-var">updateBranch'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Maybe Component
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881147"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1502"></span><span>
</span><span id="line-1503"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#assignMeta"><span class="hs-identifier hs-type">assignMeta</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1504"></span><span id="assignMeta"><span class="annot"><span class="annottext">assignMeta :: MetaId -&gt; Term -&gt; Type -&gt; SM [MetaId]
</span><a href="Agda.Mimer.Mimer.html#assignMeta"><span class="hs-identifier hs-var hs-var">assignMeta</span></a></span></span><span> </span><span id="local-6989586621681881148"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681881148"><span class="hs-identifier hs-var">metaId</span></a></span></span><span> </span><span id="local-6989586621681881149"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681881149"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621681881150"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881150"><span class="hs-identifier hs-var">metaType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Phase] -&gt; SM [MetaId] -&gt; SM [MetaId]
forall a. NFData a =&gt; [Phase] -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#bench"><span class="hs-identifier hs-var">bench</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Phase
</span><a href="Agda.Benchmarking.html#CheckRHS"><span class="hs-identifier hs-var">Bench.CheckRHS</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(SM [MetaId] -&gt; SM [MetaId]) -&gt; SM [MetaId] -&gt; SM [MetaId]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1505"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881152"><span class="annot"><a href="#local-6989586621681881152"><span class="hs-identifier hs-var">newMetaStore</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) ()
-&gt; ReaderT SearchOptions (TCMT IO) ((), LocalMetaStores)
forall (m :: * -&gt; *) a.
ReadTCState m =&gt;
m a -&gt; m (a, LocalMetaStores)
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#metasCreatedBy"><span class="hs-identifier hs-var">metasCreatedBy</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) ()
 -&gt; ReaderT SearchOptions (TCMT IO) ((), LocalMetaStores))
-&gt; ReaderT SearchOptions (TCMT IO) ()
-&gt; ReaderT SearchOptions (TCMT IO) ((), LocalMetaStores)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1506"></span><span>    </span><span id="local-6989586621681881153"><span class="annot"><a href="#local-6989586621681881153"><span class="hs-identifier hs-var">metaVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; ReaderT SearchOptions (TCMT IO) MetaVariable
forall (m :: * -&gt; *).
(HasCallStack, MonadDebug m, ReadTCState m) =&gt;
MetaId -&gt; m MetaVariable
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#lookupLocalMeta"><span class="hs-identifier hs-var">lookupLocalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681881148"><span class="hs-identifier hs-var">metaId</span></a></span><span>
</span><span id="line-1507"></span><span>    </span><span id="local-6989586621681881154"><span class="annot"><a href="#local-6989586621681881154"><span class="hs-identifier hs-var">metaArgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html#getMetaContextArgs"><span class="hs-identifier hs-type">getMetaContextArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881153"><span class="hs-identifier hs-type">metaVar</span></a></span><span>
</span><span id="line-1508"></span><span>
</span><span id="line-1509"></span><span>    </span><span class="annot"><a href="Agda.Mimer.Mimer.html#reportSMDoc"><span class="hs-identifier hs-type">reportSMDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mimer.assignMeta&quot;</span></span><span> </span><span class="annot"><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-1510"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;Assigning&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881149"><span class="hs-identifier hs-type">term</span></a></span><span>
</span><span id="line-1511"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;to&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881148"><span class="hs-identifier hs-type">metaId</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881150"><span class="hs-identifier hs-type">metaType</span></a></span><span>
</span><span id="line-1512"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;in context&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-type">getContextTelescope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1513"></span><span>                      </span><span class="hs-special">]</span><span>
</span><span id="line-1514"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-1515"></span><span>
</span><span id="line-1516"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.MetaVars.html#assignV"><span class="hs-identifier hs-type">assignV</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DirLeq"><span class="hs-identifier hs-type">DirLeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881148"><span class="hs-identifier hs-type">metaId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881154"><span class="hs-identifier hs-type">metaArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881149"><span class="hs-identifier hs-type">term</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#AsTermsOf"><span class="hs-identifier hs-type">AsTermsOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881150"><span class="hs-identifier hs-type">metaType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">`catchError`</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681881158"><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681881158"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1517"></span><span>      </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#reportSMDoc"><span class="hs-identifier hs-var">reportSMDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.assignMeta&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Doc
 -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ReaderT SearchOptions (TCMT IO) Doc]
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-1518"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;Got error from assignV:&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCErr -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; TCErr -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681881158"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-1519"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Doc
 -&gt; ReaderT SearchOptions (TCMT IO) Doc)
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ReaderT SearchOptions (TCMT IO) Doc]
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-1520"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;when trying to assign&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Term -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681881149"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-1521"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;to&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; MetaId -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681881148"><span class="hs-identifier hs-var">metaId</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881150"><span class="hs-identifier hs-var">metaType</span></a></span><span>
</span><span id="line-1522"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;in context&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (tcm :: * -&gt; *) a.
(MonadTCEnv tcm, ReadTCState tcm) =&gt;
tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-var">inTopContext</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Doc
 -&gt; ReaderT SearchOptions (TCMT IO) Doc)
-&gt; (Telescope -&gt; ReaderT SearchOptions (TCMT IO) Doc)
-&gt; Telescope
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; ReaderT SearchOptions (TCMT IO) Doc)
-&gt; ReaderT SearchOptions (TCMT IO) Telescope
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Telescope
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m Telescope
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-var">getContextTelescope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1523"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-1524"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-1525"></span><span>
</span><span id="line-1526"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881159"><span class="annot"><a href="#local-6989586621681881159"><span class="hs-identifier hs-var hs-var">newMetaIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map MetaId MetaVariable -&gt; [MetaId]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalMetaStores -&gt; Map MetaId MetaVariable
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#openMetas"><span class="hs-identifier hs-var">openMetas</span></a></span><span> </span><span class="annot"><span class="annottext">LocalMetaStores
</span><a href="#local-6989586621681881152"><span class="hs-identifier hs-var">newMetaStore</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1527"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621681881159"><span class="hs-identifier hs-type">newMetaIds</span></a></span><span>
</span><span id="line-1528"></span><span>
</span><span id="line-1529"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#dumbUnifier"><span class="hs-identifier hs-type">dumbUnifier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1530"></span><span id="dumbUnifier"><span class="annot"><span class="annottext">dumbUnifier :: Type -&gt; Type -&gt; ReaderT SearchOptions (TCMT IO) Bool
</span><a href="Agda.Mimer.Mimer.html#dumbUnifier"><span class="hs-identifier hs-var hs-var">dumbUnifier</span></a></span></span><span> </span><span id="local-6989586621681881160"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881160"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621681881161"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881161"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TCErr -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">(Maybe TCErr -&gt; Bool)
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
-&gt; ReaderT SearchOptions (TCMT IO) Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
</span><a href="Agda.Mimer.Mimer.html#dumbUnifierErr"><span class="hs-identifier hs-var">dumbUnifierErr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881160"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881161"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1531"></span><span>
</span><span id="line-1532"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#dumbUnifierErr"><span class="hs-identifier hs-type">dumbUnifierErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCErr"><span class="hs-identifier hs-type">TCErr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1533"></span><span id="dumbUnifierErr"><span class="annot"><span class="annottext">dumbUnifierErr :: Type -&gt; Type -&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
</span><a href="Agda.Mimer.Mimer.html#dumbUnifierErr"><span class="hs-identifier hs-var hs-var">dumbUnifierErr</span></a></span></span><span> </span><span id="local-6989586621681881162"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881162"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621681881163"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881163"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Phase]
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
forall a. NFData a =&gt; [Phase] -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#bench"><span class="hs-identifier hs-var">bench</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Phase
</span><a href="Agda.Benchmarking.html#UnifyIndices"><span class="hs-identifier hs-var">Bench.UnifyIndices</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
 -&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr))
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1534"></span><span>  </span><span class="annot"><span class="annottext">(MimerStats -&gt; MimerStats) -&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#updateStat"><span class="hs-identifier hs-var">updateStat</span></a></span><span> </span><span class="annot"><span class="annottext">MimerStats -&gt; MimerStats
</span><a href="Agda.Mimer.Mimer.html#incTypeEqChecks"><span class="hs-identifier hs-var">incTypeEqChecks</span></a></span><span>
</span><span id="line-1535"></span><span>  </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
forall (m :: * -&gt; *) a.
(MonadConstraint m, MonadWarning m, MonadError TCErr m,
 MonadFresh ProblemId m) =&gt;
m a -&gt; m a
</span><a href="Agda.TypeChecking.Constraints.html#noConstraints"><span class="hs-identifier hs-var">noConstraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe TCErr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe TCErr
-&gt; ReaderT SearchOptions (TCMT IO) ()
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
forall a b.
a
-&gt; ReaderT SearchOptions (TCMT IO) b
-&gt; ReaderT SearchOptions (TCMT IO) a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *). MonadConversion m =&gt; Type -&gt; Type -&gt; m ()
</span><a href="Agda.TypeChecking.Conversion.html#equalType"><span class="hs-identifier hs-var">equalType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881163"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881162"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
-&gt; (TCErr -&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr))
-&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
forall a.
ReaderT SearchOptions (TCMT IO) a
-&gt; (TCErr -&gt; ReaderT SearchOptions (TCMT IO) a)
-&gt; ReaderT SearchOptions (TCMT IO) a
forall e (m :: * -&gt; *) a.
MonadError e m =&gt;
m a -&gt; (e -&gt; m a) -&gt; m a
</span><span class="hs-operator hs-var">`catchError`</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681881165"><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681881165"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1536"></span><span>    </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.unify&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">80</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Unification failed with error:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCErr -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; TCErr -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681881165"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1537"></span><span>    </span><span class="annot"><span class="annottext">Maybe TCErr -&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
forall a. a -&gt; ReaderT SearchOptions (TCMT IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe TCErr -&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr))
-&gt; Maybe TCErr -&gt; ReaderT SearchOptions (TCMT IO) (Maybe TCErr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCErr -&gt; Maybe TCErr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681881165"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-1538"></span><span>
</span><span id="line-1539"></span><span class="hs-comment">-- Duplicate of a local definition in Agda.Interaction.BasicOps</span><span>
</span><span id="line-1540"></span><span id="local-6989586621681877516"><span id="local-6989586621681877517"><span class="annot"><a href="Agda.Mimer.Mimer.html#showTCM"><span class="hs-identifier hs-type">showTCM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#MonadPretty"><span class="hs-identifier hs-type">MonadPretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877516"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877517"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877517"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877516"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span>
</span><span id="line-1541"></span><span id="showTCM"><span class="annot"><span class="annottext">showTCM :: forall (tcm :: * -&gt; *) a.
(MonadPretty tcm, PrettyTCM a) =&gt;
a -&gt; tcm ArgName
</span><a href="Agda.Mimer.Mimer.html#showTCM"><span class="hs-identifier hs-var hs-var">showTCM</span></a></span></span><span> </span><span id="local-6989586621681881175"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681881175"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; ArgName
forall a. Doc a -&gt; ArgName
</span><span class="hs-identifier hs-var">P.render</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; ArgName) -&gt; tcm Doc -&gt; tcm ArgName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; tcm Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681881175"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1542"></span><span>
</span><span id="line-1543"></span><span id="local-6989586621681877395"><span class="annot"><a href="Agda.Mimer.Mimer.html#bench"><span class="hs-identifier hs-type">bench</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621681877395"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Benchmarking.html#Phase"><span class="hs-identifier hs-type">Bench.Phase</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877395"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877395"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1544"></span><span id="bench"><span class="annot"><span class="annottext">bench :: forall a. NFData a =&gt; [Phase] -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#bench"><span class="hs-identifier hs-var hs-var">bench</span></a></span></span><span> </span><span id="local-6989586621681881181"><span class="annot"><span class="annottext">[Phase]
</span><a href="#local-6989586621681881181"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621681881182"><span class="annot"><span class="annottext">SM a
</span><a href="#local-6989586621681881182"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Account (BenchPhase (ReaderT SearchOptions (TCMT IO)))
-&gt; SM a -&gt; SM a
forall (m :: * -&gt; *) c.
MonadBench m =&gt;
Account (BenchPhase m) -&gt; m c -&gt; m c
</span><a href="Agda.Utils.Benchmark.html#billTo"><span class="hs-identifier hs-var">billTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Phase
</span><a href="#local-6989586621681881183"><span class="hs-identifier hs-var">mimerAccount</span></a></span><span> </span><span class="annot"><span class="annottext">Phase -&gt; [Phase] -&gt; [Phase]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Phase]
</span><a href="#local-6989586621681881181"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SM a
</span><a href="#local-6989586621681881182"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-1545"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1546"></span><span>    </span><span class="hs-comment">-- Dummy account to avoid updating Bench. Doesn't matter since this is only used interactively</span><span>
</span><span id="line-1547"></span><span>    </span><span class="hs-comment">-- to debug Mimer performance.</span><span>
</span><span id="line-1548"></span><span>    </span><span id="local-6989586621681881183"><span class="annot"><span class="annottext">mimerAccount :: Phase
</span><a href="#local-6989586621681881183"><span class="hs-identifier hs-var hs-var">mimerAccount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="Agda.Benchmarking.html#Sort"><span class="hs-identifier hs-var">Bench.Sort</span></a></span><span>
</span><span id="line-1549"></span><span>
</span><span id="line-1550"></span><span class="hs-comment">-- Local variables:</span><span>
</span><span id="line-1551"></span><span class="hs-comment">-- getContext :: MonadTCEnv m =&gt; m [Dom (Name, Type)]</span><span>
</span><span id="line-1552"></span><span class="hs-comment">-- getContextArgs :: (Applicative m, MonadTCEnv m) =&gt; m Args</span><span>
</span><span id="line-1553"></span><span class="hs-comment">-- getContextTelescope :: (Applicative m, MonadTCEnv m) =&gt; m Telescope</span><span>
</span><span id="line-1554"></span><span class="hs-comment">-- getContextTerms :: (Applicative m, MonadTCEnv m) =&gt; m [Term]</span><span>
</span><span id="line-1555"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#getLocalVars"><span class="hs-identifier hs-type">getLocalVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Cost"><span class="hs-identifier hs-type">Cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1556"></span><span id="getLocalVars"><span class="annot"><span class="annottext">getLocalVars :: VerboseLevel -&gt; VerboseLevel -&gt; TCMT IO [Component]
</span><a href="Agda.Mimer.Mimer.html#getLocalVars"><span class="hs-identifier hs-var hs-var">getLocalVars</span></a></span></span><span> </span><span id="local-6989586621681881185"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881185"><span class="hs-identifier hs-var">localCxt</span></a></span></span><span> </span><span id="local-6989586621681881186"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881186"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1557"></span><span>  </span><span id="local-6989586621681881187"><span class="annot"><a href="#local-6989586621681881187"><span class="hs-identifier hs-var">typedTerms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCM [(Term, Dom Type)]
</span><a href="Agda.Mimer.Mimer.html#getLocalVarTerms"><span class="hs-identifier hs-var">getLocalVarTerms</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881185"><span class="hs-identifier hs-var">localCxt</span></a></span><span>
</span><span id="line-1558"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881193"><span class="annot"><a href="#local-6989586621681881193"><span class="hs-identifier hs-var hs-var">varZeroDiscount</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1559"></span><span>      </span><span class="annot"><a href="#local-6989586621681881193"><span class="hs-identifier hs-var">varZeroDiscount</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1560"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681881194"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681881194"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881195"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681881195"><span class="hs-identifier hs-var">domTyp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[MetaId]
-&gt; VerboseLevel
-&gt; Maybe Name
-&gt; VerboseLevel
-&gt; Term
-&gt; Type
-&gt; TCMT IO Component
forall (m :: * -&gt; *).
MonadFresh VerboseLevel m =&gt;
[MetaId]
-&gt; VerboseLevel
-&gt; Maybe Name
-&gt; VerboseLevel
-&gt; Term
-&gt; Type
-&gt; m Component
</span><a href="Agda.Mimer.Mimer.html#newComponent"><span class="hs-identifier hs-var">newComponent</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881186"><span class="hs-identifier hs-var">cost</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; VerboseLevel
forall {a}. Num a =&gt; Term -&gt; a
</span><a href="#local-6989586621681881193"><span class="hs-identifier hs-var">varZeroDiscount</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681881194"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="Agda.Mimer.Mimer.html#noName"><span class="hs-identifier hs-var">noName</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681881194"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681881195"><span class="hs-identifier hs-var">domTyp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681881187"><span class="hs-identifier hs-type">typedTerms</span></a></span><span>
</span><span id="line-1561"></span><span>
</span><span id="line-1562"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#getLocalVarTerms"><span class="hs-identifier hs-type">getLocalVarTerms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1563"></span><span id="getLocalVarTerms"><span class="annot"><span class="annottext">getLocalVarTerms :: VerboseLevel -&gt; TCM [(Term, Dom Type)]
</span><a href="Agda.Mimer.Mimer.html#getLocalVarTerms"><span class="hs-identifier hs-var hs-var">getLocalVarTerms</span></a></span></span><span> </span><span id="local-6989586621681881196"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881196"><span class="hs-identifier hs-var">localCxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1564"></span><span>  </span><span id="local-6989586621681881197"><span class="annot"><a href="#local-6989586621681881197"><span class="hs-identifier hs-var">contextTerms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO [Term]
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m [Term]
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextTerms"><span class="hs-identifier hs-var">getContextTerms</span></a></span><span>
</span><span id="line-1565"></span><span>  </span><span id="local-6989586621681881199"><span class="annot"><a href="#local-6989586621681881199"><span class="hs-identifier hs-var">contextTypes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html#flattenTel"><span class="hs-identifier hs-type">flattenTel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-type">getContextTelescope</span></a></span><span>
</span><span id="line-1566"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881200"><span class="annot"><a href="#local-6989586621681881200"><span class="hs-identifier hs-var hs-var">inScope</span></a></span></span><span> </span><span id="local-6989586621681881201"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881201"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dom' Term Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881201"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881196"><span class="hs-identifier hs-var">localCxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TCM Bool
forall a. a -&gt; TCMT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>   </span><span class="hs-comment">-- Ignore scope for variables we inserted ourselves</span><span>
</span><span id="line-1567"></span><span>      </span><span class="annot"><a href="#local-6989586621681881200"><span class="hs-identifier hs-var">inScope</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">unDom :: forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681881203"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681881203"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1568"></span><span>        </span><span id="local-6989586621681881204"><span class="annot"><a href="#local-6989586621681881204"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TCMT IO (ConOfAbs Name)
forall a (m :: * -&gt; *).
(ToConcrete a, MonadAbsToCon m) =&gt;
a -&gt; m (ConOfAbs a)
</span><a href="Agda.Syntax.Translation.AbstractToConcrete.html#abstractToConcrete_"><span class="hs-identifier hs-var">abstractToConcrete_</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681881203"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1569"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isInScope"><span class="hs-identifier hs-type">C.isInScope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881204"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#InScope"><span class="hs-identifier hs-type">C.InScope</span></a></span><span>
</span><span id="line-1570"></span><span>  </span><span id="local-6989586621681881207"><span class="annot"><a href="#local-6989586621681881207"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">uncurry</span></span><span> </span><span class="annot"><a href="#local-6989586621681881200"><span class="hs-identifier hs-type">inScope</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#getContextVars"><span class="hs-identifier hs-type">getContextVars</span></a></span><span>
</span><span id="line-1571"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621681881209"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881209"><span class="annot"><a href="#local-6989586621681881209"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">zip</span></span><span> </span><span class="annot"><a href="#local-6989586621681881207"><span class="hs-identifier hs-type">scope</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">zip</span></span><span> </span><span class="annot"><a href="#local-6989586621681881197"><span class="hs-identifier hs-type">contextTerms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881199"><span class="hs-identifier hs-type">contextTypes</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1572"></span><span>
</span><span id="line-1573"></span><span>
</span><span id="line-1574"></span><span>
</span><span id="line-1575"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#prettyBranch"><span class="hs-identifier hs-type">prettyBranch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-1576"></span><span id="prettyBranch"><span class="annot"><span class="annottext">prettyBranch :: SearchBranch -&gt; ReaderT SearchOptions (TCMT IO) ArgName
</span><a href="Agda.Mimer.Mimer.html#prettyBranch"><span class="hs-identifier hs-var hs-var">prettyBranch</span></a></span></span><span> </span><span id="local-6989586621681881211"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881211"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SearchBranch
-&gt; ReaderT SearchOptions (TCMT IO) ArgName
-&gt; ReaderT SearchOptions (TCMT IO) ArgName
forall a. SearchBranch -&gt; SM a -&gt; SM a
</span><a href="Agda.Mimer.Mimer.html#withBranchState"><span class="hs-identifier hs-var">withBranchState</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881211"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) ArgName
 -&gt; ReaderT SearchOptions (TCMT IO) ArgName)
-&gt; ReaderT SearchOptions (TCMT IO) ArgName
-&gt; ReaderT SearchOptions (TCMT IO) ArgName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1577"></span><span>    </span><span id="local-6989586621681881212"><span class="annot"><a href="#local-6989586621681881212"><span class="hs-identifier hs-var">metaId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; MetaId) -&gt; ReaderT SearchOptions (TCMT IO) MetaId
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#searchTopMeta"><span class="hs-identifier hs-var">searchTopMeta</span></a></span><span>
</span><span id="line-1578"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">P.render</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Branch&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#braces"><span class="hs-identifier hs-type">braces</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#punctuate"><span class="hs-identifier hs-type">punctuate</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;,&quot;</span></span><span>
</span><span id="line-1579"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;cost:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbCost"><span class="hs-identifier hs-var">sbCost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881211"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1580"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;metas:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881211"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1581"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;instantiation:&quot;</span></span><span>
</span><span id="line-1582"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881212"><span class="hs-identifier hs-type">metaId</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-type">prettyTCM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#getMetaInstantiation"><span class="hs-identifier hs-type">getMetaInstantiation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881212"><span class="hs-identifier hs-type">metaId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1583"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;used components:&quot;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.toList</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#sbComponentsUsed"><span class="hs-identifier hs-var">sbComponentsUsed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881211"><span class="hs-identifier hs-type">branch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1584"></span><span>      </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1585"></span><span>
</span><span id="line-1586"></span><span>
</span><span id="line-1587"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681881218"><span id="local-6989586621681881222"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Goal"><span class="hs-identifier hs-type">Goal</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1588"></span><span>  </span><span id="local-6989586621681881226"><span class="annot"><span class="annottext">pretty :: Goal -&gt; Doc
</span><a href="#local-6989586621681881226"><span class="hs-identifier hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span id="local-6989586621681881228"><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681881228"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(MetaId -&gt; Doc) -&gt; MetaId -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Goal -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#goalMeta"><span class="hs-identifier hs-var">goalMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Goal
</span><a href="#local-6989586621681881228"><span class="hs-identifier hs-var">goal</span></a></span><span>
</span><span id="line-1589"></span><span>
</span><span id="line-1590"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681881231"><span id="local-6989586621681881234"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchBranch"><span class="hs-identifier hs-type">SearchBranch</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1591"></span><span>  </span><span id="local-6989586621681881246"><span class="annot"><span class="annottext">pretty :: SearchBranch -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span id="local-6989586621681881247"><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881247"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Doc, Doc)] -&gt; Doc
</span><a href="Agda.Mimer.Mimer.html#keyValueList"><span class="hs-identifier hs-var">keyValueList</span></a></span><span>
</span><span id="line-1592"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;sbTCState&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;[...]&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1593"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;sbGoals&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Goal] -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">([Goal] -&gt; Doc) -&gt; [Goal] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; [Goal]
</span><a href="Agda.Mimer.Mimer.html#sbGoals"><span class="hs-identifier hs-var">sbGoals</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881247"><span class="hs-identifier hs-var">branch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1594"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;sbCost&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#sbCost"><span class="hs-identifier hs-var">sbCost</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881247"><span class="hs-identifier hs-var">branch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1595"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;sbComponentsUsed&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map Name VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Name VerboseLevel -&gt; Doc) -&gt; Map Name VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SearchBranch -&gt; Map Name VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#sbComponentsUsed"><span class="hs-identifier hs-var">sbComponentsUsed</span></a></span><span> </span><span class="annot"><span class="annottext">SearchBranch
</span><a href="#local-6989586621681881247"><span class="hs-identifier hs-var">branch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1596"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1597"></span><span>
</span><span id="line-1598"></span><span>
</span><span id="line-1599"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#BaseComponents"><span class="hs-identifier hs-type">BaseComponents</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1600"></span><span>  </span><span id="local-6989586621681881312"><span class="annot"><span class="annottext">prettyTCM :: forall (m :: * -&gt; *). MonadPretty m =&gt; BaseComponents -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var hs-var hs-var">prettyTCM</span></a></span></span><span> </span><span id="local-6989586621681881313"><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881313"><span class="hs-identifier hs-var">comps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1601"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881314"><span class="annot"><span class="annottext">thisFn :: m Doc
</span><a href="#local-6989586621681881314"><span class="hs-identifier hs-var hs-var">thisFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BaseComponents -&gt; Maybe Component
</span><a href="Agda.Mimer.Mimer.html#hintThisFn"><span class="hs-identifier hs-var">hintThisFn</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881313"><span class="hs-identifier hs-var">comps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1602"></span><span>          </span><span class="annot"><span class="annottext">Maybe Component
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;(nothing)&quot;</span></span><span>
</span><span id="line-1603"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681881315"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881315"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Component -&gt; m Doc
forall {m :: * -&gt; *}.
(Applicative m, IsString (m Doc)) =&gt;
Component -&gt; m Doc
</span><a href="#local-6989586621681881316"><span class="hs-identifier hs-var">prettyComp</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881315"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-1604"></span><span>    </span><span class="annot"><span class="annottext">[m Doc] -&gt; m Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;Base components:&quot;</span></span><span>
</span><span id="line-1605"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(m Doc -&gt; m Doc) -&gt; m Doc -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; m Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-1606"></span><span>           </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; [Component] -&gt; m Doc
</span><a href="#local-6989586621681881317"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;hintFns&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintFns"><span class="hs-identifier hs-var">hintFns</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881313"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1607"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; [Component] -&gt; m Doc
</span><a href="#local-6989586621681881317"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;hintDataTypes&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintDataTypes"><span class="hs-identifier hs-var">hintDataTypes</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881313"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1608"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; [Component] -&gt; m Doc
</span><a href="#local-6989586621681881317"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;hintRecordTypes&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintRecordTypes"><span class="hs-identifier hs-var">hintRecordTypes</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881313"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1609"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; [Component] -&gt; m Doc
</span><a href="#local-6989586621681881317"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;hintAxioms&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintAxioms"><span class="hs-identifier hs-var">hintAxioms</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881313"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1610"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; [Component] -&gt; m Doc
</span><a href="#local-6989586621681881317"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;hintLevel&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintLevel"><span class="hs-identifier hs-var">hintLevel</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881313"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1611"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; [Component] -&gt; m Doc
</span><a href="#local-6989586621681881317"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;hintProjections&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintProjections"><span class="hs-identifier hs-var">hintProjections</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881313"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1612"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;hintThisFn:&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><a href="#local-6989586621681881314"><span class="hs-identifier hs-var">thisFn</span></a></span><span>
</span><span id="line-1613"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Open Component -&gt; m Doc) -&gt; m Doc -&gt; [Open Component] -&gt; m Doc
forall {m :: * -&gt; *} {a}.
(Semigroup (m Doc), IsString (m Doc), Applicative m) =&gt;
(a -&gt; m Doc) -&gt; m Doc -&gt; [a] -&gt; m Doc
</span><a href="#local-6989586621681881318"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Open Component -&gt; m Doc
forall {m :: * -&gt; *}.
(Applicative m, IsString (m Doc)) =&gt;
Open Component -&gt; m Doc
</span><a href="#local-6989586621681881319"><span class="hs-identifier hs-var">prettyOpenComp</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;hintLetVars&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Open Component]
</span><a href="Agda.Mimer.Mimer.html#hintLetVars"><span class="hs-identifier hs-var">hintLetVars</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881313"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1614"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;hintRecVars: Open&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(Term, VerboseLevel)] -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NoSubst Term VerboseLevel -&gt; VerboseLevel)
-&gt; (Term, NoSubst Term VerboseLevel) -&gt; (Term, VerboseLevel)
forall b d a. (b -&gt; d) -&gt; (a, b) -&gt; (a, d)
</span><a href="Agda.Utils.Tuple.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a></span><span> </span><span class="annot"><span class="annottext">NoSubst Term VerboseLevel -&gt; VerboseLevel
forall t a. NoSubst t a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#unNoSubst"><span class="hs-identifier hs-var">unNoSubst</span></a></span><span> </span><span class="annot"><span class="annottext">((Term, NoSubst Term VerboseLevel) -&gt; (Term, VerboseLevel))
-&gt; [(Term, NoSubst Term VerboseLevel)] -&gt; [(Term, VerboseLevel)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Open [(Term, NoSubst Term VerboseLevel)]
-&gt; [(Term, NoSubst Term VerboseLevel)]
forall a. Open a -&gt; a
</span><a href="Agda.TypeChecking.Monad.Base.html#openThing"><span class="hs-identifier hs-var">openThing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; Open [(Term, NoSubst Term VerboseLevel)]
</span><a href="Agda.Mimer.Mimer.html#hintRecVars"><span class="hs-identifier hs-var">hintRecVars</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881313"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1615"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;hintSplitVars: Open&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Term] -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Open [Term] -&gt; [Term]
forall a. Open a -&gt; a
</span><a href="Agda.TypeChecking.Monad.Base.html#openThing"><span class="hs-identifier hs-var">openThing</span></a></span><span> </span><span class="annot"><span class="annottext">(Open [Term] -&gt; [Term]) -&gt; Open [Term] -&gt; [Term]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BaseComponents -&gt; Open [Term]
</span><a href="Agda.Mimer.Mimer.html#hintSplitVars"><span class="hs-identifier hs-var">hintSplitVars</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881313"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1616"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-1617"></span><span>         </span><span class="hs-special">]</span><span>
</span><span id="line-1618"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1619"></span><span>      </span><span id="local-6989586621681881316"><span class="annot"><span class="annottext">prettyComp :: Component -&gt; m Doc
</span><a href="#local-6989586621681881316"><span class="hs-identifier hs-var hs-var">prettyComp</span></a></span></span><span> </span><span id="local-6989586621681881332"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881332"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881332"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Type
</span><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881332"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1620"></span><span>      </span><span id="local-6989586621681881319"><span class="annot"><span class="annottext">prettyOpenComp :: Open Component -&gt; m Doc
</span><a href="#local-6989586621681881319"><span class="hs-identifier hs-var hs-var">prettyOpenComp</span></a></span></span><span> </span><span id="local-6989586621681881342"><span class="annot"><span class="annottext">Open Component
</span><a href="#local-6989586621681881342"><span class="hs-identifier hs-var">openComp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;Open&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc
forall (m :: * -&gt; *). Functor m =&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; m Doc
forall {m :: * -&gt; *}.
(Applicative m, IsString (m Doc)) =&gt;
Component -&gt; m Doc
</span><a href="#local-6989586621681881316"><span class="hs-identifier hs-var">prettyComp</span></a></span><span> </span><span class="annot"><span class="annottext">(Component -&gt; m Doc) -&gt; Component -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Open Component -&gt; Component
forall a. Open a -&gt; a
</span><a href="Agda.TypeChecking.Monad.Base.html#openThing"><span class="hs-identifier hs-var">openThing</span></a></span><span> </span><span class="annot"><span class="annottext">Open Component
</span><a href="#local-6989586621681881342"><span class="hs-identifier hs-var">openComp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1621"></span><span>      </span><span id="local-6989586621681881465"><span class="annot"><span class="annottext">prettyTCMComp :: Component -&gt; m Doc
</span><a href="#local-6989586621681881465"><span class="hs-identifier hs-var hs-var">prettyTCMComp</span></a></span></span><span> </span><span id="local-6989586621681881466"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881466"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Term -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881466"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Component -&gt; Type
</span><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881466"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1622"></span><span>      </span><span id="local-6989586621681881317"><span class="annot"><span class="annottext">f :: m Doc -&gt; [Component] -&gt; m Doc
</span><a href="#local-6989586621681881317"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Component -&gt; m Doc) -&gt; m Doc -&gt; [Component] -&gt; m Doc
forall {m :: * -&gt; *} {a}.
(Semigroup (m Doc), IsString (m Doc), Applicative m) =&gt;
(a -&gt; m Doc) -&gt; m Doc -&gt; [a] -&gt; m Doc
</span><a href="#local-6989586621681881318"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Component -&gt; m Doc
forall {m :: * -&gt; *}.
(MonadFresh NameId m, MonadInteractionPoints m,
 MonadStConcreteNames m, PureTCM m, IsString (m Doc), Null (m Doc),
 Semigroup (m Doc)) =&gt;
Component -&gt; m Doc
</span><a href="#local-6989586621681881465"><span class="hs-identifier hs-var">prettyTCMComp</span></a></span><span>
</span><span id="line-1623"></span><span>      </span><span id="local-6989586621681881318"><span class="annot"><span class="annottext">g :: (a -&gt; m Doc) -&gt; m Doc -&gt; [a] -&gt; m Doc
</span><a href="#local-6989586621681881318"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621681881572"><span class="annot"><span class="annottext">a -&gt; m Doc
</span><a href="#local-6989586621681881572"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681881573"><span class="annot"><span class="annottext">m Doc
</span><a href="#local-6989586621681881573"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><a href="#local-6989586621681881573"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;: []&quot;</span></span><span>
</span><span id="line-1624"></span><span>      </span><span class="annot"><a href="#local-6989586621681881318"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span id="local-6989586621681881574"><span class="annot"><span class="annottext">a -&gt; m Doc
</span><a href="#local-6989586621681881574"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681881575"><span class="annot"><span class="annottext">m Doc
</span><a href="#local-6989586621681881575"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681881576"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681881576"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m Doc
</span><a href="#local-6989586621681881575"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%24%2B%24"><span class="hs-operator hs-var">$+$</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[m Doc] -&gt; m Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="annot"><span class="annottext">([m Doc] -&gt; m Doc) -&gt; [m Doc] -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m Doc) -&gt; [a] -&gt; [m Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m Doc
</span><a href="#local-6989586621681881574"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681881576"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1625"></span><span>
</span><span id="line-1626"></span><span>
</span><span id="line-1627"></span><span class="hs-comment">-- -- TODO: Is it possible to derive the pretty instances?</span><span>
</span><span id="line-1628"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681881580"><span id="local-6989586621681881584"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#BaseComponents"><span class="hs-identifier hs-type">BaseComponents</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1629"></span><span>  </span><span id="local-6989586621681881600"><span class="annot"><span class="annottext">pretty :: BaseComponents -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span id="local-6989586621681881601"><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881601"><span class="hs-identifier hs-var">comps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#vcat"><span class="hs-identifier hs-var">P.vcat</span></a></span><span>
</span><span id="line-1630"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Component] -&gt; Doc
forall {a}. Pretty a =&gt; Doc -&gt; [a] -&gt; Doc
</span><a href="#local-6989586621681881603"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;hintFns&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintFns"><span class="hs-identifier hs-var">hintFns</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881601"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1631"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Component] -&gt; Doc
forall {a}. Pretty a =&gt; Doc -&gt; [a] -&gt; Doc
</span><a href="#local-6989586621681881603"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;hintDataTypes&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintDataTypes"><span class="hs-identifier hs-var">hintDataTypes</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881601"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1632"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Component] -&gt; Doc
forall {a}. Pretty a =&gt; Doc -&gt; [a] -&gt; Doc
</span><a href="#local-6989586621681881603"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;hintRecordTypes&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintRecordTypes"><span class="hs-identifier hs-var">hintRecordTypes</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881601"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1633"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Component] -&gt; Doc
forall {a}. Pretty a =&gt; Doc -&gt; [a] -&gt; Doc
</span><a href="#local-6989586621681881603"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;hintAxioms&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintAxioms"><span class="hs-identifier hs-var">hintAxioms</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881601"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1634"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Component] -&gt; Doc
forall {a}. Pretty a =&gt; Doc -&gt; [a] -&gt; Doc
</span><a href="#local-6989586621681881603"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;hintLevel&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintLevel"><span class="hs-identifier hs-var">hintLevel</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881601"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1635"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Component] -&gt; Doc
forall {a}. Pretty a =&gt; Doc -&gt; [a] -&gt; Doc
</span><a href="#local-6989586621681881603"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;hintProjections&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseComponents -&gt; [Component]
</span><a href="Agda.Mimer.Mimer.html#hintProjections"><span class="hs-identifier hs-var">hintProjections</span></a></span><span> </span><span class="annot"><span class="annottext">BaseComponents
</span><a href="#local-6989586621681881601"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1636"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-1637"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1638"></span><span>      </span><span id="local-6989586621681881603"><span class="annot"><span class="annottext">f :: Doc -&gt; [a] -&gt; Doc
</span><a href="#local-6989586621681881603"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681881611"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881611"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881611"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">P.&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;: []&quot;</span></span><span>
</span><span id="line-1639"></span><span>      </span><span class="annot"><a href="#local-6989586621681881603"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span id="local-6989586621681881612"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881612"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681881613"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681881613"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881612"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">P.&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">P.$$</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc -&gt; Doc
forall a. VerboseLevel -&gt; Doc a -&gt; Doc a
</span><span class="hs-identifier hs-var">P.nest</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681881613"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1640"></span><span>
</span><span id="line-1641"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681881618"><span id="local-6989586621681881622"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchOptions"><span class="hs-identifier hs-type">SearchOptions</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1642"></span><span>  </span><span id="local-6989586621681881639"><span class="annot"><span class="annottext">pretty :: SearchOptions -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span id="local-6989586621681881640"><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881640"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#vcat"><span class="hs-identifier hs-var">P.vcat</span></a></span><span>
</span><span id="line-1643"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;searchBaseComponents:&quot;</span></span><span>
</span><span id="line-1644"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc -&gt; Doc
forall a. VerboseLevel -&gt; Doc a -&gt; Doc a
</span><span class="hs-identifier hs-var">P.nest</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BaseComponents -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseComponents -&gt; Doc) -&gt; BaseComponents -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; BaseComponents
</span><a href="Agda.Mimer.Mimer.html#searchBaseComponents"><span class="hs-identifier hs-var">searchBaseComponents</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881640"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1645"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Doc, Doc)] -&gt; Doc
</span><a href="Agda.Mimer.Mimer.html#keyValueList"><span class="hs-identifier hs-var">keyValueList</span></a></span><span>
</span><span id="line-1646"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;searchHintMode&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HintMode -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(HintMode -&gt; Doc) -&gt; HintMode -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; HintMode
</span><a href="Agda.Mimer.Mimer.html#searchHintMode"><span class="hs-identifier hs-var">searchHintMode</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881640"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1647"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;searchTimeout&quot;</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Doc) -&gt; Integer -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; Integer
</span><a href="Agda.Mimer.Mimer.html#searchTimeout"><span class="hs-identifier hs-var">searchTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881640"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1648"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;searchTopMeta&quot;</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">MetaId -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(MetaId -&gt; Doc) -&gt; MetaId -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#searchTopMeta"><span class="hs-identifier hs-var">searchTopMeta</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881640"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1649"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;searchTopEnv&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;[...]&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1650"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-1651"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;searchCosts:&quot;</span></span><span>
</span><span id="line-1652"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc -&gt; Doc
forall a. VerboseLevel -&gt; Doc a -&gt; Doc a
</span><span class="hs-identifier hs-var">P.nest</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Costs -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(Costs -&gt; Doc) -&gt; Costs -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; Costs
</span><a href="Agda.Mimer.Mimer.html#searchCosts"><span class="hs-identifier hs-var">searchCosts</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881640"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1653"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1654"></span><span>
</span><span id="line-1655"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SearchOptions"><span class="hs-identifier hs-type">SearchOptions</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1656"></span><span>  </span><span id="local-6989586621681881685"><span class="annot"><span class="annottext">prettyTCM :: forall (m :: * -&gt; *). MonadPretty m =&gt; SearchOptions -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var hs-var hs-var">prettyTCM</span></a></span></span><span> </span><span id="local-6989586621681881686"><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881686"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; m Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-1657"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;searchBaseComponents:&quot;</span></span><span>
</span><span id="line-1658"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(m Doc -&gt; m Doc) -&gt; m Doc -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BaseComponents -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; BaseComponents -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseComponents -&gt; m Doc) -&gt; BaseComponents -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; BaseComponents
</span><a href="Agda.Mimer.Mimer.html#searchBaseComponents"><span class="hs-identifier hs-var">searchBaseComponents</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881686"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1659"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; m Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-1660"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;searchHintMode:&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HintMode -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SearchOptions -&gt; HintMode
</span><a href="Agda.Mimer.Mimer.html#searchHintMode"><span class="hs-identifier hs-var">searchHintMode</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881686"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1661"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;searchTimeout:&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SearchOptions -&gt; Integer
</span><a href="Agda.Mimer.Mimer.html#searchTimeout"><span class="hs-identifier hs-var">searchTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881686"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1662"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;searchTopMeta:&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; MetaId -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SearchOptions -&gt; MetaId
</span><a href="Agda.Mimer.Mimer.html#searchTopMeta"><span class="hs-identifier hs-var">searchTopMeta</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881686"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1663"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;searchTopEnv: [...]&quot;</span></span><span>
</span><span id="line-1664"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;searchTopCheckpoint:&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointId -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; CheckpointId -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SearchOptions -&gt; CheckpointId
</span><a href="Agda.Mimer.Mimer.html#searchTopCheckpoint"><span class="hs-identifier hs-var">searchTopCheckpoint</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881686"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1665"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;searchInteractionId:&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionId -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SearchOptions -&gt; InteractionId
</span><a href="Agda.Mimer.Mimer.html#searchInteractionId"><span class="hs-identifier hs-var">searchInteractionId</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881686"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1666"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;searchFnName:&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SearchOptions -&gt; Maybe QName
</span><a href="Agda.Mimer.Mimer.html#searchFnName"><span class="hs-identifier hs-var">searchFnName</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881686"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1667"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;searchStats: [...]&quot;</span></span><span>
</span><span id="line-1668"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-1669"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;searchCosts:&quot;</span></span><span>
</span><span id="line-1670"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(m Doc -&gt; m Doc) -&gt; m Doc -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(Costs -&gt; m Doc) -&gt; Costs -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SearchOptions -&gt; Costs
</span><a href="Agda.Mimer.Mimer.html#searchCosts"><span class="hs-identifier hs-var">searchCosts</span></a></span><span> </span><span class="annot"><span class="annottext">SearchOptions
</span><a href="#local-6989586621681881686"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1671"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1672"></span><span>
</span><span id="line-1673"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681881689"><span id="local-6989586621681881692"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1674"></span><span>  </span><span id="local-6989586621681881705"><span class="annot"><span class="annottext">pretty :: Component -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span id="local-6989586621681881706"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881706"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [(Doc, Doc)] -&gt; Doc
</span><a href="Agda.Mimer.Mimer.html#haskellRecord"><span class="hs-identifier hs-var">haskellRecord</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Component&quot;</span></span><span>
</span><span id="line-1675"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;compId&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Component -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compId"><span class="hs-identifier hs-var">compId</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881706"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1676"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;compTerm&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Doc) -&gt; Term -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Component -&gt; Term
</span><a href="Agda.Mimer.Mimer.html#compTerm"><span class="hs-identifier hs-var">compTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881706"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1677"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;compType&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Doc) -&gt; Type -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Component -&gt; Type
</span><a href="Agda.Mimer.Mimer.html#compType"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881706"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1678"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;compMetas&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MetaId] -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">([MetaId] -&gt; Doc) -&gt; [MetaId] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Component -&gt; [MetaId]
</span><a href="Agda.Mimer.Mimer.html#compMetas"><span class="hs-identifier hs-var">compMetas</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881706"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1679"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;compCost&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Component -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compCost"><span class="hs-identifier hs-var">compCost</span></a></span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621681881706"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1680"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1681"></span><span>
</span><span id="line-1682"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681881710"><span id="local-6989586621681881713"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Costs"><span class="hs-identifier hs-type">Costs</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1683"></span><span>  </span><span id="local-6989586621681881743"><span class="annot"><span class="annottext">pretty :: Costs -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span id="local-6989586621681881744"><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; [(ArgName, Doc)] -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#align"><span class="hs-identifier hs-var">P.align</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">[(ArgName, Doc)]
</span><a href="#local-6989586621681881746"><span class="hs-identifier hs-var">entries</span></a></span><span>
</span><span id="line-1684"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1685"></span><span>      </span><span id="local-6989586621681881746"><span class="annot"><span class="annottext">entries :: [(ArgName, Doc)]
</span><a href="#local-6989586621681881746"><span class="hs-identifier hs-var hs-var">entries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1686"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costLocal:&quot;</span></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costLocal"><span class="hs-identifier hs-var">costLocal</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1687"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costFn:&quot;</span></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costFn"><span class="hs-identifier hs-var">costFn</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1688"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costDataCon:&quot;</span></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costDataCon"><span class="hs-identifier hs-var">costDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1689"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costRecordCon:&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costRecordCon"><span class="hs-identifier hs-var">costRecordCon</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1690"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costSpeculateProj:&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costSpeculateProj"><span class="hs-identifier hs-var">costSpeculateProj</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1691"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costProj:&quot;</span></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costProj"><span class="hs-identifier hs-var">costProj</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1692"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costAxiom:&quot;</span></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costAxiom"><span class="hs-identifier hs-var">costAxiom</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1693"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costLet:&quot;</span></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costLet"><span class="hs-identifier hs-var">costLet</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1694"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costLevel:&quot;</span></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costLevel"><span class="hs-identifier hs-var">costLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1695"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costSet:&quot;</span></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costSet"><span class="hs-identifier hs-var">costSet</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1696"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costRecCall:&quot;</span></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costRecCall"><span class="hs-identifier hs-var">costRecCall</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1697"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costNewMeta:&quot;</span></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costNewMeta"><span class="hs-identifier hs-var">costNewMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1698"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costNewHiddenMeta:&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Doc) -&gt; VerboseLevel -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Costs -&gt; VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#costNewHiddenMeta"><span class="hs-identifier hs-var">costNewHiddenMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Costs
</span><a href="#local-6989586621681881744"><span class="hs-identifier hs-var">costs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1699"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;costCompReuse:&quot;</span></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;{function}&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1700"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-1701"></span><span>
</span><span id="line-1702"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1703"></span><span>  </span><span id="local-6989586621681881783"><span class="annot"><span class="annottext">prettyTCM :: forall (m :: * -&gt; *). MonadPretty m =&gt; Component -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var hs-var hs-var">prettyTCM</span></a></span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span class="hs-special">{</span><span id="local-6989586621681881784"><span id="local-6989586621681881785"><span id="local-6989586621681881786"><span id="local-6989586621681881787"><span id="local-6989586621681881788"><span id="local-6989586621681881789"><span id="local-6989586621681881790"><span id="local-6989586621681881791"><span class="annot"><span class="annottext">Bool
VerboseLevel
[MetaId]
Maybe Name
Type
Term
compId :: Component -&gt; VerboseLevel
compName :: Component -&gt; Maybe Name
compPars :: Component -&gt; VerboseLevel
compTerm :: Component -&gt; Term
compType :: Component -&gt; Type
compRec :: Component -&gt; Bool
compMetas :: Component -&gt; [MetaId]
compCost :: Component -&gt; VerboseLevel
compId :: VerboseLevel
compName :: Maybe Name
compPars :: VerboseLevel
compTerm :: Term
compType :: Type
compRec :: Bool
compMetas :: [MetaId]
compCost :: VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#compId"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc
forall (m :: * -&gt; *). Functor m =&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; VerboseLevel -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881784"><span class="hs-identifier hs-var">compId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; m Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-1704"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; m Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Term -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Term -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681881787"><span class="hs-identifier hs-var">compTerm</span></a></span><span>
</span><span id="line-1705"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681881788"><span class="hs-identifier hs-var">compType</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1706"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc
forall (m :: * -&gt; *). Functor m =&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="annot"><span class="annottext">(m Doc -&gt; m Doc) -&gt; m Doc -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[m Doc] -&gt; m Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-var">fsep</span></a></span><span> </span><span class="annot"><span class="annottext">([m Doc] -&gt; m Doc) -&gt; [m Doc] -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; [m Doc] -&gt; [m Doc]
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Semigroup (m Doc), Foldable t) =&gt;
m Doc -&gt; t (m Doc) -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#punctuate"><span class="hs-identifier hs-var">punctuate</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;,&quot;</span></span><span>
</span><span id="line-1707"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;cost:&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; VerboseLevel -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881791"><span class="hs-identifier hs-var">compCost</span></a></span><span>
</span><span id="line-1708"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;metas:&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[MetaId] -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; [MetaId] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621681881790"><span class="hs-identifier hs-var">compMetas</span></a></span><span>
</span><span id="line-1709"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-1710"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1711"></span><span>
</span><span id="line-1712"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerResult"><span class="hs-identifier hs-type">MimerResult</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1713"></span><span>  </span><span id="local-6989586621681881812"><span class="annot"><span class="annottext">prettyTCM :: forall (m :: * -&gt; *). MonadPretty m =&gt; MimerResult -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var hs-var hs-var">prettyTCM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1714"></span><span>    </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerExpr"><span class="hs-identifier hs-type">MimerExpr</span></a></span><span> </span><span id="local-6989586621681881813"><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681881813"><span class="hs-identifier hs-var">expr</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681881813"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1715"></span><span>    </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerClauses"><span class="hs-identifier hs-type">MimerClauses</span></a></span><span> </span><span id="local-6989586621681881814"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681881814"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681881815"><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621681881815"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;MimerClauses&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681881814"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;[..]&quot;</span></span><span> </span><span class="hs-comment">-- TODO: display the clauses</span><span>
</span><span id="line-1716"></span><span>    </span><span class="annot"><span class="annottext">MimerResult
</span><a href="Agda.Mimer.Mimer.html#MimerNoResult"><span class="hs-identifier hs-var">MimerNoResult</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;MimerNoResult&quot;</span></span><span>
</span><span id="line-1717"></span><span>    </span><span class="annot"><a href="Agda.Mimer.Mimer.html#MimerList"><span class="hs-identifier hs-type">MimerList</span></a></span><span> </span><span id="local-6989586621681881816"><span class="annot"><span class="annottext">[(VerboseLevel, ArgName)]
</span><a href="#local-6989586621681881816"><span class="hs-identifier hs-var">sols</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m Doc
</span><span class="hs-string">&quot;MimerList&quot;</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc -&gt; m Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(VerboseLevel, ArgName)] -&gt; m Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">[(VerboseLevel, ArgName)]
</span><a href="#local-6989586621681881816"><span class="hs-identifier hs-var">sols</span></a></span><span>
</span><span id="line-1718"></span><span>
</span><span id="line-1719"></span><span id="local-6989586621681877414"><span id="local-6989586621681877415"><span id="local-6989586621681877416"><span class="annot"><a href="Agda.Mimer.Mimer.html#concatMapM"><span class="hs-identifier hs-type">concatMapM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681877414"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681877415"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877414"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681877416"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681877415"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877414"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681877416"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-1720"></span><span id="concatMapM"><span class="annot"><span class="annottext">concatMapM :: forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m [b]) -&gt; [a] -&gt; m [b]
</span><a href="Agda.Mimer.Mimer.html#concatMapM"><span class="hs-identifier hs-var hs-var">concatMapM</span></a></span></span><span> </span><span id="local-6989586621681881824"><span class="annot"><span class="annottext">a -&gt; m [b]
</span><a href="#local-6989586621681881824"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([[b]] -&gt; [b]) -&gt; m [[b]] -&gt; m [b]
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[[b]] -&gt; [b]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">(m [[b]] -&gt; m [b]) -&gt; ([a] -&gt; m [[b]]) -&gt; [a] -&gt; m [b]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m [b]) -&gt; [a] -&gt; m [[b]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m [b]
</span><a href="#local-6989586621681881824"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1721"></span><span>
</span><span id="line-1722"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#reportSMDoc"><span class="hs-identifier hs-type">reportSMDoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Types.html#VerboseKey"><span class="hs-identifier hs-type">VerboseKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Types.html#VerboseLevel"><span class="hs-identifier hs-type">VerboseLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1723"></span><span id="reportSMDoc"><span class="annot"><span class="annottext">reportSMDoc :: ArgName
-&gt; VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#reportSMDoc"><span class="hs-identifier hs-var hs-var">reportSMDoc</span></a></span></span><span> </span><span id="local-6989586621681881826"><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681881826"><span class="hs-identifier hs-var">vk</span></a></span></span><span> </span><span id="local-6989586621681881827"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881827"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span id="local-6989586621681881828"><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><a href="#local-6989586621681881828"><span class="hs-identifier hs-var">md</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; TCMT IO Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681881826"><span class="hs-identifier hs-var">vk</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881827"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; (SearchOptions -&gt; TCMT IO Doc)
-&gt; SearchOptions
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc -&gt; SearchOptions -&gt; TCMT IO Doc
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><a href="#local-6989586621681881828"><span class="hs-identifier hs-var">md</span></a></span><span> </span><span class="annot"><span class="annottext">(SearchOptions -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; ReaderT SearchOptions (TCMT IO) SearchOptions
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) SearchOptions
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-1724"></span><span>
</span><span id="line-1725"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#mimerTrace"><span class="hs-identifier hs-type">mimerTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Types.html#VerboseLevel"><span class="hs-identifier hs-type">VerboseLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1726"></span><span id="mimerTrace"><span class="annot"><span class="annottext">mimerTrace :: VerboseLevel
-&gt; VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#mimerTrace"><span class="hs-identifier hs-var hs-var">mimerTrace</span></a></span></span><span> </span><span id="local-6989586621681881829"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881829"><span class="hs-identifier hs-var">ilvl</span></a></span></span><span> </span><span id="local-6989586621681881830"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881830"><span class="hs-identifier hs-var">vlvl</span></a></span></span><span> </span><span id="local-6989586621681881831"><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><a href="#local-6989586621681881831"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgName
-&gt; VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
</span><a href="Agda.Mimer.Mimer.html#reportSMDoc"><span class="hs-identifier hs-var">reportSMDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.trace&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881830"><span class="hs-identifier hs-var">vlvl</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Doc
 -&gt; ReaderT SearchOptions (TCMT IO) ())
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881829"><span class="hs-identifier hs-var">ilvl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReaderT SearchOptions (TCMT IO) Doc
 -&gt; ReaderT SearchOptions (TCMT IO) Doc)
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
-&gt; ReaderT SearchOptions (TCMT IO) Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT SearchOptions (TCMT IO) Doc
</span><a href="#local-6989586621681881831"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-1727"></span><span>
</span><span id="line-1728"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#haskellRecord"><span class="hs-identifier hs-type">haskellRecord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-1729"></span><span id="haskellRecord"><span class="annot"><span class="annottext">haskellRecord :: Doc -&gt; [(Doc, Doc)] -&gt; Doc
</span><a href="Agda.Mimer.Mimer.html#haskellRecord"><span class="hs-identifier hs-var hs-var">haskellRecord</span></a></span></span><span> </span><span id="local-6989586621681881832"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881832"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681881833"><span class="annot"><span class="annottext">[(Doc, Doc)]
</span><a href="#local-6989586621681881833"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#sep"><span class="hs-identifier hs-var">P.sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881832"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Doc -&gt; Doc
forall a. VerboseLevel -&gt; Doc a -&gt; Doc a
</span><span class="hs-identifier hs-var">P.nest</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#braces"><span class="hs-identifier hs-var">P.braces</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#sep"><span class="hs-identifier hs-var">P.sep</span></a></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Doc) -&gt; [Doc] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Doc] -&gt; [Doc]
forall (t :: * -&gt; *). Foldable t =&gt; Doc -&gt; t Doc -&gt; [Doc]
</span><a href="Agda.Syntax.Common.Pretty.html#punctuate"><span class="hs-identifier hs-var">P.punctuate</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; VerboseLevel -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; VerboseLevel -&gt; Doc a -&gt; Doc a
</span><span class="hs-identifier hs-var">P.hang</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881838"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">P.&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;=&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881840"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681881838"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881838"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881840"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881840"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Doc, Doc)]
</span><a href="#local-6989586621681881833"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1730"></span><span>
</span><span id="line-1731"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#keyValueList"><span class="hs-identifier hs-type">keyValueList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-1732"></span><span id="keyValueList"><span class="annot"><span class="annottext">keyValueList :: [(Doc, Doc)] -&gt; Doc
</span><a href="Agda.Mimer.Mimer.html#keyValueList"><span class="hs-identifier hs-var hs-var">keyValueList</span></a></span></span><span> </span><span id="local-6989586621681881841"><span class="annot"><span class="annottext">[(Doc, Doc)]
</span><a href="#local-6989586621681881841"><span class="hs-identifier hs-var">kvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#braces"><span class="hs-identifier hs-var">P.braces</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#sep"><span class="hs-identifier hs-var">P.sep</span></a></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Doc) -&gt; [Doc] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Doc] -&gt; [Doc]
forall (t :: * -&gt; *). Foldable t =&gt; Doc -&gt; t Doc -&gt; [Doc]
</span><a href="Agda.Syntax.Common.Pretty.html#punctuate"><span class="hs-identifier hs-var">P.punctuate</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; VerboseLevel -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; VerboseLevel -&gt; Doc a -&gt; Doc a
</span><span class="hs-identifier hs-var">P.hang</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881842"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">P.&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881843"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681881842"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881842"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681881843"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681881843"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Doc, Doc)]
</span><a href="#local-6989586621681881841"><span class="hs-identifier hs-var">kvs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1733"></span><span>
</span><span id="line-1734"></span><span id="local-6989586621681877135"><span class="annot"><a href="Agda.Mimer.Mimer.html#writeTime"><span class="hs-identifier hs-type">writeTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877135"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCErr"><span class="hs-identifier hs-type">TCErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877135"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877135"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#MonadDebug"><span class="hs-identifier hs-type">MonadDebug</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681877135"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#InteractionId"><span class="hs-identifier hs-type">InteractionId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.Time.html#CPUTime"><span class="hs-identifier hs-type">CPUTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681877135"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1735"></span><span id="writeTime"><span class="annot"><span class="annottext">writeTime :: forall (m :: * -&gt; *).
(ReadTCState m, MonadError TCErr m, MonadTCM m, MonadDebug m) =&gt;
InteractionId -&gt; Maybe CPUTime -&gt; m ()
</span><a href="Agda.Mimer.Mimer.html#writeTime"><span class="hs-identifier hs-var hs-var">writeTime</span></a></span></span><span> </span><span id="local-6989586621681881867"><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681881867"><span class="hs-identifier hs-var">ii</span></a></span></span><span> </span><span id="local-6989586621681881868"><span class="annot"><span class="annottext">Maybe CPUTime
</span><a href="#local-6989586621681881868"><span class="hs-identifier hs-var">mTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1736"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881869"><span class="annot"><span class="annottext">time :: ArgName
</span><a href="#local-6989586621681881869"><span class="hs-identifier hs-var hs-var hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe CPUTime
</span><a href="#local-6989586621681881868"><span class="hs-identifier hs-var">mTime</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1737"></span><span>        </span><span class="annot"><span class="annottext">Maybe CPUTime
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;n/a&quot;</span></span><span>
</span><span id="line-1738"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Time.html#CPUTime"><span class="hs-identifier hs-type">CPUTime</span></a></span><span> </span><span id="local-6989586621681881871"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681881871"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ArgName
forall a. Show a =&gt; a -&gt; ArgName
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681881871"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1739"></span><span>  </span><span id="local-6989586621681881872"><span class="annot"><a href="#local-6989586621681881872"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Range -&gt; SrcFile
</span><a href="Agda.Syntax.Position.html#rangeFile"><span class="hs-identifier hs-var">rangeFile</span></a></span><span> </span><span class="annot"><span class="annottext">(Range -&gt; SrcFile)
-&gt; (InteractionPoint -&gt; Range) -&gt; InteractionPoint -&gt; SrcFile
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">InteractionPoint -&gt; Range
</span><a href="Agda.TypeChecking.Monad.Base.html#ipRange"><span class="hs-identifier hs-var">ipRange</span></a></span><span> </span><span class="annot"><span class="annottext">(InteractionPoint -&gt; SrcFile) -&gt; m InteractionPoint -&gt; m SrcFile
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">InteractionId -&gt; m InteractionPoint
forall (m :: * -&gt; *).
(ReadTCState m, MonadError TCErr m, MonadTCEnv m) =&gt;
InteractionId -&gt; m InteractionPoint
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#lookupInteractionPoint"><span class="hs-identifier hs-var">lookupInteractionPoint</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681881867"><span class="hs-identifier hs-var">ii</span></a></span><span>
</span><span id="line-1740"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681881872"><span class="hs-identifier hs-type">file</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1741"></span><span>    </span><span class="annot"><span class="annottext">SrcFile
</span><span class="hs-identifier hs-var">SMaybe.Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1742"></span><span>      </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer.stats&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;No file found for interaction id&quot;</span></span><span>
</span><span id="line-1743"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">SMaybe.Just</span></span><span> </span><span id="local-6989586621681881876"><span class="annot"><span class="annottext">RangeFile
</span><a href="#local-6989586621681881876"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1744"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881877"><span class="annot"><span class="annottext">path :: ArgName
</span><a href="#local-6989586621681881877"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; ArgName
</span><a href="Agda.Utils.FileName.html#filePath"><span class="hs-identifier hs-var">filePath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RangeFile -&gt; AbsolutePath
</span><a href="Agda.Syntax.Position.html#rangeFilePath"><span class="hs-identifier hs-var">rangeFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">RangeFile
</span><a href="#local-6989586621681881876"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;.stats&quot;</span></span><span>
</span><span id="line-1745"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; IO ()
</span><span class="hs-identifier hs-var">appendFile</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681881877"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; ArgName
forall a. Show a =&gt; a -&gt; ArgName
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InteractionId -&gt; VerboseLevel
</span><a href="Agda.Syntax.Common.html#interactionId"><span class="hs-identifier hs-var">interactionId</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionId
</span><a href="#local-6989586621681881867"><span class="hs-identifier hs-var">ii</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681881869"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1746"></span><span>
</span><span id="line-1747"></span><span class="hs-comment">-- Hack to let you experiment with costs using verbosity flags.</span><span>
</span><span id="line-1748"></span><span class="annot"><a href="Agda.Mimer.Mimer.html#customCosts"><span class="hs-identifier hs-type">customCosts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Costs"><span class="hs-identifier hs-type">Costs</span></a></span><span>
</span><span id="line-1749"></span><span id="customCosts"><span class="annot"><span class="annottext">customCosts :: TCMT IO Costs
</span><a href="Agda.Mimer.Mimer.html#customCosts"><span class="hs-identifier hs-var hs-var">customCosts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1750"></span><span>  </span><span id="local-6989586621681881880"><span class="annot"><a href="#local-6989586621681881880"><span class="hs-identifier hs-var">costLocal</span></a></span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; TCM VerboseLevel
forall {m :: * -&gt; *}. MonadDebug m =&gt; ArgName -&gt; m VerboseLevel
</span><a href="#local-6989586621681881881"><span class="hs-identifier hs-var">cost</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;local&quot;</span></span><span>
</span><span id="line-1751"></span><span>  </span><span id="local-6989586621681881882"><span class="annot"><a href="#local-6989586621681881882"><span class="hs-identifier hs-var">costFn</span></a></span></span><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681881881"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;fn&quot;</span></span><span>
</span><span id="line-1752"></span><span>  </span><span id="local-6989586621681881883"><span class="annot"><a href="#local-6989586621681881883"><span class="hs-identifier hs-var">costDataCon</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681881881"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;dataCon&quot;</span></span><span>
</span><span id="line-1753"></span><span>  </span><span id="local-6989586621681881884"><span class="annot"><a href="#local-6989586621681881884"><span class="hs-identifier hs-var">costRecordCon</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681881881"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;recordCon&quot;</span></span><span>
</span><span id="line-1754"></span><span>  </span><span id="local-6989586621681881885"><span class="annot"><a href="#local-6989586621681881885"><span class="hs-identifier hs-var">costSpeculateProj</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681881881"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;speculateProj&quot;</span></span><span>
</span><span id="line-1755"></span><span>  </span><span id="local-6989586621681881886"><span class="annot"><a href="#local-6989586621681881886"><span class="hs-identifier hs-var">costProj</span></a></span></span><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681881881"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;proj&quot;</span></span><span>
</span><span id="line-1756"></span><span>  </span><span id="local-6989586621681881887"><span class="annot"><a href="#local-6989586621681881887"><span class="hs-identifier hs-var">costAxiom</span></a></span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681881881"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;axiom&quot;</span></span><span>
</span><span id="line-1757"></span><span>  </span><span id="local-6989586621681881888"><span class="annot"><a href="#local-6989586621681881888"><span class="hs-identifier hs-var">costLet</span></a></span></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681881881"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;let&quot;</span></span><span>
</span><span id="line-1758"></span><span>  </span><span id="local-6989586621681881889"><span class="annot"><a href="#local-6989586621681881889"><span class="hs-identifier hs-var">costLevel</span></a></span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681881881"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;level&quot;</span></span><span>
</span><span id="line-1759"></span><span>  </span><span id="local-6989586621681881890"><span class="annot"><a href="#local-6989586621681881890"><span class="hs-identifier hs-var">costSet</span></a></span></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681881881"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;set&quot;</span></span><span>
</span><span id="line-1760"></span><span>  </span><span id="local-6989586621681881891"><span class="annot"><a href="#local-6989586621681881891"><span class="hs-identifier hs-var">costRecCall</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681881881"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;recCall&quot;</span></span><span>
</span><span id="line-1761"></span><span>  </span><span id="local-6989586621681881892"><span class="annot"><a href="#local-6989586621681881892"><span class="hs-identifier hs-var">costNewMeta</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681881881"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;newMeta&quot;</span></span><span>
</span><span id="line-1762"></span><span>  </span><span id="local-6989586621681881893"><span class="annot"><a href="#local-6989586621681881893"><span class="hs-identifier hs-var">costNewHiddenMeta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681881881"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;newHiddenMeta&quot;</span></span><span>
</span><span id="line-1763"></span><span>  </span><span id="local-6989586621681881894"><span class="annot"><a href="#local-6989586621681881894"><span class="hs-identifier hs-var">compReuse</span></a></span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621681881881"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;compReuse&quot;</span></span><span>
</span><span id="line-1764"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681881895"><span class="annot"><a href="#local-6989586621681881895"><span class="hs-identifier hs-var hs-var">costCompReuse</span></a></span></span><span> </span><span id="local-6989586621681881896"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881896"><span class="hs-identifier hs-var">uses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881894"><span class="hs-identifier hs-var">compReuse</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681881896"><span class="hs-identifier hs-var">uses</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Integer -&gt; VerboseLevel
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-1765"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="Agda.Mimer.Mimer.html#Costs"><span class="hs-identifier hs-type">Costs</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Agda.Mimer.Mimer.html#costLocal"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-type hs-type hs-type hs-type hs-type hs-type hs-type hs-type hs-type hs-type hs-type hs-type hs-type hs-type">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1766"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1767"></span><span>    </span><span id="local-6989586621681881881"><span class="annot"><span class="annottext">cost :: ArgName -&gt; m VerboseLevel
</span><a href="#local-6989586621681881881"><span class="hs-identifier hs-var hs-var">cost</span></a></span></span><span> </span><span id="local-6989586621681881911"><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681881911"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; m VerboseLevel
forall {m :: * -&gt; *}. MonadDebug m =&gt; ArgName -&gt; m VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#getVerbosityLevel"><span class="hs-identifier hs-var">getVerbosityLevel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;mimer-cost.&quot;</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681881911"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1768"></span><span>
</span><span id="line-1769"></span><span id="local-6989586621681881913"><span class="annot"><a href="Agda.Mimer.Mimer.html#getVerbosityLevel"><span class="hs-identifier hs-type">getVerbosityLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#MonadDebug"><span class="hs-identifier hs-type">MonadDebug</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681881913"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Types.html#VerboseKey"><span class="hs-identifier hs-type">VerboseKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681881913"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Types.html#VerboseLevel"><span class="hs-identifier hs-type">VerboseLevel</span></a></span></span><span>
</span><span id="line-1770"></span><span id="getVerbosityLevel"><span class="annot"><span class="annottext">getVerbosityLevel :: forall {m :: * -&gt; *}. MonadDebug m =&gt; ArgName -&gt; m VerboseLevel
</span><a href="Agda.Mimer.Mimer.html#getVerbosityLevel"><span class="hs-identifier hs-var hs-var">getVerbosityLevel</span></a></span></span><span> </span><span id="local-6989586621681881928"><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681881928"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1771"></span><span>  </span><span id="local-6989586621681881929"><span class="annot"><a href="#local-6989586621681881929"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Verbosity
forall (m :: * -&gt; *). MonadDebug m =&gt; m Verbosity
</span><a href="Agda.TypeChecking.Monad.Debug.html#getVerbosity"><span class="hs-identifier hs-var">getVerbosity</span></a></span><span>
</span><span id="line-1772"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681881929"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1773"></span><span>    </span><span class="annot"><span class="annottext">Verbosity
</span><span class="hs-identifier hs-var">Strict.Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1774"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Strict.Just</span></span><span> </span><span id="local-6989586621681881931"><span class="annot"><span class="annottext">Trie VerboseKeyItem VerboseLevel
</span><a href="#local-6989586621681881931"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-1775"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Trie VerboseKeyItem VerboseLevel
</span><a href="#local-6989586621681881931"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Trie VerboseKeyItem VerboseLevel
-&gt; Trie VerboseKeyItem VerboseLevel -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[VerboseKeyItem]
-&gt; VerboseLevel -&gt; Trie VerboseKeyItem VerboseLevel
forall k v. [k] -&gt; v -&gt; Trie k v
</span><a href="Agda.Utils.Trie.html#singleton"><span class="hs-identifier hs-var">Trie.singleton</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1776"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; [VerboseLevel] -&gt; VerboseLevel
forall a. a -&gt; [a] -&gt; a
</span><a href="Agda.Utils.List.html#lastWithDefault"><span class="hs-identifier hs-var">lastWithDefault</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">([VerboseLevel] -&gt; VerboseLevel) -&gt; [VerboseLevel] -&gt; VerboseLevel
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[VerboseKeyItem]
-&gt; Trie VerboseKeyItem VerboseLevel -&gt; [VerboseLevel]
forall k v. Ord k =&gt; [k] -&gt; Trie k v -&gt; [v]
</span><a href="Agda.Utils.Trie.html#lookupPath"><span class="hs-identifier hs-var">Trie.lookupPath</span></a></span><span> </span><span class="annot"><span class="annottext">[VerboseKeyItem]
</span><a href="#local-6989586621681881934"><span class="hs-identifier hs-var">ks</span></a></span><span> </span><span class="annot"><span class="annottext">Trie VerboseKeyItem VerboseLevel
</span><a href="#local-6989586621681881931"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1777"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681881934"><span class="annot"><span class="annottext">ks :: [VerboseKeyItem]
</span><a href="#local-6989586621681881934"><span class="hs-identifier hs-var hs-var">ks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; [VerboseKeyItem]
</span><a href="Agda.Interaction.Options.Base.html#parseVerboseKey"><span class="hs-identifier hs-var">parseVerboseKey</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681881928"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1778"></span></pre></body></html>